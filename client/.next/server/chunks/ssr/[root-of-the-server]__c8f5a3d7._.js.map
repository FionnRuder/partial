{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/state/index.ts"],"sourcesContent":["import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\nexport interface initialStateTypes {\r\n  isSidebarCollapsed: boolean;\r\n  isDarkMode: boolean;\r\n}\r\n\r\nconst initialState: initialStateTypes = {\r\n  isSidebarCollapsed: false,\r\n  isDarkMode: false,\r\n};\r\n\r\nexport const globalSlice = createSlice({\r\n  name: \"global\",\r\n  initialState,\r\n  reducers: {\r\n    setIsSidebarCollapsed: (state, action: PayloadAction<boolean>) => {\r\n      state.isSidebarCollapsed = action.payload;\r\n    },\r\n    setIsDarkMode: (state, action: PayloadAction<boolean>) => {\r\n      state.isDarkMode = action.payload;\r\n    },\r\n  },\r\n});\r\n\r\nexport const { setIsSidebarCollapsed, setIsDarkMode } = globalSlice.actions;\r\nexport default globalSlice.reducer;\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAOA,MAAM,eAAkC;IACtC,oBAAoB;IACpB,YAAY;AACd;AAEO,MAAM,cAAc,IAAA,0MAAW,EAAC;IACrC,MAAM;IACN;IACA,UAAU;QACR,uBAAuB,CAAC,OAAO;YAC7B,MAAM,kBAAkB,GAAG,OAAO,OAAO;QAC3C;QACA,eAAe,CAAC,OAAO;YACrB,MAAM,UAAU,GAAG,OAAO,OAAO;QACnC;IACF;AACF;AAEO,MAAM,EAAE,qBAAqB,EAAE,aAAa,EAAE,GAAG,YAAY,OAAO;uCAC5D,YAAY,OAAO","debugId":null}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/state/api.ts"],"sourcesContent":["import { createApi, fetchBaseQuery } from \"@reduxjs/toolkit/query/react\";\n\n/* ===================\n   ENUMS (matches schema)\n=================== */\n\nexport enum Priority {\n  Urgent = \"Urgent\",\n  High = \"High\",\n  Medium = \"Medium\",\n  Low = \"Low\",\n  Backlog = \"Backlog\",\n}\n\nexport enum Status {\n  ToDo = \"ToDo\",\n  WorkInProgress = \"WorkInProgress\",\n  UnderReview = \"UnderReview\",\n  Completed = \"Completed\",\n}\n\nexport const StatusLabels: Record<Status, string> = {\n  [Status.ToDo]: \"To Do\",\n  [Status.WorkInProgress]: \"Work In Progress\",\n  [Status.UnderReview]: \"Under Review\",\n  [Status.Completed]: \"Completed\",\n};\n\n// DeliverableType and IssueType are now table-based models\n// Types are fetched from the API instead of using enums\nexport type DeliverableType = string; // Now a string type from API\nexport type IssueType = string; // Now a string type from API\n\n// Legacy type labels for display - maps type names to human-readable labels\n// Since types now come from the API with proper formatting, these labels are mainly for backward compatibility\n// If a type name is not found in the labels, the type name itself is used\nexport const DeliverableTypeLabels: Record<string, string> = {\n  // Legacy camelCase keys for backward compatibility\n  \"SystemSubsystemRequirementsSpecificationSRS\": \"System/Subsystem Requirements Specification (SRS)\",\n  \"InterfaceControlDocumentICD\": \"Interface Control Document (ICD)\",\n  \"PreliminaryDesignReviewPDRPackage\": \"Preliminary Design Review (PDR) Package\",\n  \"RiskFailureModeEffectsAnalysisFMEADFMEAReport\": \"Risk/Failure Mode & Effects Analysis (FMEA/DFMEA) Report\",\n  \"DevelopmentVerificationPlanVVMatrix\": \"Development & Verification Plan / V&V Matrix\",\n  \"EngineeringDrawingCADModel\": \"Engineering Drawing & CAD Model\",\n  \"BillofMaterialsBOM\": \"Bill of Materials (BOM)\",\n  \"StressStructuralAnalysisReport\": \"Stress/Structural Analysis Report\",\n  \"ThermalAnalysisReport\": \"Thermal Analysis Report\",\n  \"ElectricalSchematicsPCBLayouts\": \"Electrical Schematics / PCB Layouts\",\n  \"DesignforManufacturabilityDFMDesignforTestDFTReviewReport\": \"Design for Manufacturability (DFM) & Design for Test (DFT) Review Report\",\n  \"CriticalDesignReviewCDRPackage\": \"Critical Design Review (CDR) Package\",\n  \"WorkInstructionsAssemblyProcedures\": \"Work Instructions / Assembly Procedures\",\n  \"FirstArticleInspectionFAIReport\": \"First Article Inspection (FAI) Report\",\n  \"SupplierQualityRecordsCertificatesofConformanceCoC\": \"Supplier Quality Records / Certificates of Conformance (CoC)\",\n  \"TestPlansandProcedures\": \"Test Plans and Procedures\",\n  \"QualificationTestReport\": \"Qualification Test Report\",\n  \"AcceptanceTestProcedureATPReport\": \"Acceptance Test Procedure (ATP) & Report\",\n  \"CalibrationCertificates\": \"Calibration Certificates\",\n  \"NonConformanceCorrectiveActionReportNCRCAR\": \"Non-Conformance / Corrective Action Report (NCR/CAR)\",\n  \"RequirementsVerificationReport\": \"Requirements Verification Report\",\n  \"AsBuiltConfigurationEndItemDataPackage\": \"As-Built Configuration / End-Item Data Package\",\n  \"UserOperationsManual\": \"User / Operations Manual\",\n  \"MaintenanceRepairManualSparePartsList\": \"Maintenance & Repair Manual / Spare Parts List\",\n  \"CertificatesofCompliance\": \"Certificates of Compliance\",\n  \"LessonsLearnedPostProjectReport\": \"Lessons-Learned & Post-Project Report\",\n  \"Other\": \"Other\",\n}\n\nexport const IssueTypeLabels: Record<string, string> = {\n  // Legacy camelCase keys for backward compatibility\n  \"Defect\": \"Defect\",\n  \"Failure\": \"Failure\",\n  \"RequirementWaiver\": \"Requirement Waiver\",\n  \"NonConformanceReportNCR\": \"Non-Conformance Report (NCR)\",\n  \"ProcessManufacturingIssue\": \"Process / Manufacturing Issue\",\n  \"SupplyChainProcurementIssue\": \"Supply-Chain / Procurement Issue\",\n  \"IntegrationInterfaceIssue\": \"Integration / Interface Issue\",\n  \"TestVerificationAnomaly\": \"Test / Verification Anomaly\",\n  \"EnvironmentalReliabilityIssue\": \"Environmental / Reliability Issue\",\n  \"ConfigurationDocumentationControlIssue\": \"Configuration / Documentation Control Issue\",\n  \"SafetyRegulatoryIssue\": \"Safety / Regulatory Issue\",\n  \"ProgrammaticRiskItem\": \"Programmatic / Risk Item\",\n  \"ObsolescenceEndOfLifeIssue\": \"Obsolescence / End-of-Life Issue\",\n  \"Other\": \"Other\",\n}\n\nexport enum WorkItemType {\n  Task = \"Task\",\n  Deliverable = \"Deliverable\",\n  Issue = \"Issue\",\n}\n\n/* ===================\n   CORE INTERFACES\n=================== */\n\nexport interface DisciplineTeamToProgram {\n  id: number;\n  disciplineTeamId: number;\n  programId: number;\n  disciplineTeam: DisciplineTeam;\n}\n\nexport interface Program {\n  id: number;\n  organizationId: number;\n  name: string;\n  description?: string;\n  programManagerUserId?: string;\n  startDate: string;\n  endDate: string;\n\n  partNumbers?: Part[];\n  disciplineTeams?: DisciplineTeamToProgram[];\n  milestones?: Milestone[];\n  workItems?: WorkItem[];\n}\n\nexport interface User {\n  id: string;\n  organizationId: number;\n  username: string;\n  name: string;\n  emailNotificationsEnabled?: boolean;\n  emailWorkItemAssignment?: boolean;\n  emailWorkItemStatusChange?: boolean;\n  emailWorkItemComment?: boolean;\n  emailInvitation?: boolean;\n  emailApproachingDeadline?: boolean;\n  email: string;\n  phoneNumber: string;\n  role: string;\n  profilePictureUrl?: string;\n  disciplineTeamId?: number;\n\n  disciplineTeam?: DisciplineTeam;\n  authoredWorkItems?: WorkItem[];\n  assignedWorkItems?: WorkItem[];\n  partNumbers?: Part[];\n  attachments?: Attachment[];\n  comments?: Comment[];\n}\n\nexport interface Milestone {\n  id: number;\n  organizationId: number;\n  name: string;\n  description: string;\n  date: string;\n  programId: number;\n\n  program?: Program;\n  workItems?: WorkItem[];\n}\n\nexport enum PartState {\n  Released = \"Released\",\n  UnderReview = \"UnderReview\",\n  InWork = \"InWork\",\n  Implementation = \"Implementation\",\n}\n\nexport const PartStateLabels: Record<PartState, string> = {\n  [PartState.Released]: \"Released\",\n  [PartState.UnderReview]: \"Under Review\",\n  [PartState.InWork]: \"In Work\",\n  [PartState.Implementation]: \"Implementation\",\n};\n\nexport interface Part {\n  id: number;\n  organizationId: number;\n  code: string;\n  partName: string;\n  level: number;\n  state: PartState;\n  revisionLevel: string;\n  assignedUserId: string;\n  programId: number;\n  parentId?: number;\n\n  assignedUser?: User;\n  program?: Program;\n  parent?: Part;\n  children?: Part[];\n  workItemLinks?: WorkItemToPart[];\n}\n\nexport interface WorkItem {\n  id: number;\n  organizationId: number;\n  workItemType: WorkItemType;\n  title: string;\n  description: string;\n  status: Status;\n  priority: Priority;\n  tags?: string;\n  dateOpened: string;\n  dueDate: string;\n  estimatedCompletionDate: string;\n  actualCompletionDate?: string;\n  percentComplete: number;\n  inputStatus: string;\n  programId: number;\n  dueByMilestoneId: number;\n  authorUserId: string;\n  assignedUserId: string;\n\n  program: Program;\n  dueByMilestone: Milestone;\n  authorUser: User;\n  assigneeUser: User;\n  partNumbers?: WorkItemToPart[];\n  partIds?: number[];\n  attachments?: Attachment[];\n  comments?: Comment[];\n\n  issueDetail?: IssueDetail;\n  deliverableDetail?: DeliverableDetail;\n}\n\nexport interface IssueDetail {\n  id: number;\n  issueType: string | IssueTypeModel; // Type name (string) or full type object (when included)\n  issueTypeId?: number; // Type ID (for new API)\n  rootCause?: string;\n  correctiveAction?: string;\n}\n\nexport interface DeliverableDetail {\n  id: number;\n  deliverableType: string | DeliverableTypeModel; // Type name (string) or full type object (when included)\n  deliverableTypeId?: number; // Type ID (for new API)\n}\n\nexport interface WorkItemToPart {\n  id: number;\n  workItemId: number;\n  partId: number;\n  part?: Part;\n}\n\nexport interface Attachment {\n  id: number;\n  organizationId: number;\n  fileUrl: string;\n  fileName: string;\n  dateAttached: string;\n  uploadedByUserId: string;\n  workItemId?: number;\n  uploadedByUser?: User;\n}\n\nexport interface Comment {\n  id: number;\n  organizationId: number;\n  text: string;\n  dateCommented: string;\n  commenterUserId: string;\n  workItemId?: number;\n  commenterUser?: User;\n}\n\nexport interface StatusLog {\n  id: number;\n  organizationId: number;\n  status: string;\n  dateLogged: string;\n  engineerUserId: string;\n  workItemId: number;\n  engineerUser?: User;\n}\n\nexport interface DisciplineTeam {\n  id: number;\n  organizationId: number;\n  name: string;\n  description: string;\n  teamManagerUserId?: string;\n  teamManagerUsername?: string;\n  teamManagerName?: string;\n\n  users?: User[];\n  programs?: Program[];\n}\n\nexport interface SearchResults {\n  workItems?: WorkItem[];\n  programs?: Program[];\n  users?: User[];\n  milestones?: Milestone[];\n  parts?: Part[];\n}\n\nexport interface Invitation {\n  id: number;\n  organizationId: number;\n  token: string;\n  invitedEmail?: string;\n  role: string;\n  expiresAt: string;\n  used: boolean;\n  usedAt?: string;\n  usedByUserId?: string;\n  createdByUserId: string;\n  createdAt: string;\n  organization?: {\n    id: number;\n    name: string;\n  };\n  createdBy?: {\n    id: string;\n    name: string;\n    email: string;\n  };\n  usedBy?: {\n    id: string;\n    name: string;\n    email: string;\n  };\n}\n\nexport interface InvitationCreateInput {\n  invitedEmail?: string;\n  role: string;\n  expiresInDays?: number;\n}\n\nexport interface DeliverableTypeModel {\n  id: number;\n  organizationId: number;\n  name: string;\n  isSystem: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface IssueTypeModel {\n  id: number;\n  organizationId: number;\n  name: string;\n  isSystem: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface DeliverableTypeCreateInput {\n  name: string;\n}\n\nexport interface DeliverableTypeUpdateInput {\n  name: string;\n}\n\nexport interface IssueTypeCreateInput {\n  name: string;\n}\n\nexport interface IssueTypeUpdateInput {\n  name: string;\n}\n\nexport interface Feedback {\n  id: number;\n  organizationId: number;\n  type: \"bug\" | \"feature\" | \"improvement\";\n  title: string;\n  description: string;\n  status: \"open\" | \"in_progress\" | \"resolved\" | \"closed\";\n  priority: Priority;\n  submittedByUserId: string;\n  createdAt: string;\n  updatedAt: string;\n  resolvedAt: string | null;\n  resolvedByUserId: string | null;\n  adminNotes: string | null;\n  submittedBy: {\n    id: string;\n    name: string;\n    email: string;\n  };\n  resolvedBy: {\n    id: string;\n    name: string;\n    email: string;\n  } | null;\n}\n\nexport interface FeedbackCreateInput {\n  type: \"bug\" | \"feature\" | \"improvement\";\n  title: string;\n  description: string;\n  priority?: Priority;\n}\n\nexport interface FeedbackUpdateInput {\n  status?: \"open\" | \"in_progress\" | \"resolved\" | \"closed\";\n  priority?: Priority;\n  adminNotes?: string;\n}\n\nexport interface UnreadFeedbackCount {\n  count: number;\n}\n\nexport enum AuditAction {\n  CREATE = \"CREATE\",\n  UPDATE = \"UPDATE\",\n  DELETE = \"DELETE\",\n  VIEW = \"VIEW\",\n  LOGIN = \"LOGIN\",\n  LOGOUT = \"LOGOUT\",\n  EXPORT = \"EXPORT\",\n  IMPORT = \"IMPORT\",\n}\n\nexport interface AuditLog {\n  id: number;\n  organizationId: number;\n  userId: string;\n  action: AuditAction;\n  entityType: string;\n  entityId: number | null;\n  description: string;\n  changes: any | null;\n  metadata: any | null;\n  ipAddress: string | null;\n  userAgent: string | null;\n  requestId: string | null;\n  createdAt: string;\n  user: {\n    id: string;\n    name: string;\n    email: string;\n    username: string;\n  };\n}\n\nexport interface InvitationValidationResponse {\n  invitation: {\n    id: number;\n    invitedEmail?: string;\n    role: string;\n    expiresAt: string;\n    organization: {\n      id: number;\n      name: string;\n    };\n    createdBy: {\n      name: string;\n      email: string;\n    };\n    createdAt: string;\n  };\n}\n\nexport interface WorkItemCreateInput {\n  workItemType: WorkItemType;\n  title: string;\n  description?: string;\n  status: Status;\n  priority: Priority;\n  tags?: string;\n  dateOpened?: string;\n  dueDate: string;\n  estimatedCompletionDate: string;\n  actualCompletionDate?: string;\n  percentComplete?: number;\n  inputStatus?: string;\n  programId: number;\n  dueByMilestoneId: number;\n  authorUserId: string;\n  assignedUserId: string;\n  issueDetail?: {\n    issueType: IssueType;\n    rootCause?: string;\n    correctiveAction?: string;\n  };\n  deliverableDetail?: {\n    deliverableType: DeliverableType;\n  };\n  partIds?: number[];\n}\n\nexport interface WorkItemEditInput {\n  workItemType?: WorkItemType;\n  title?: string;\n  description?: string;\n  status?: Status;\n  priority?: Priority;\n  tags?: string;\n  dateOpened?: string;\n  dueDate?: string;\n  estimatedCompletionDate?: string;\n  actualCompletionDate?: string;\n  percentComplete?: number;\n  inputStatus?: string;\n  programId?: number;\n  dueByMilestoneId?: number;\n  authorUserId?: string;\n  assignedUserId?: string;\n  issueDetail?: {\n    issueType?: IssueType;\n    rootCause?: string;\n    correctiveAction?: string;\n  };\n  deliverableDetail?: {\n    deliverableType?: DeliverableType;\n  };\n  partIds?: number[];\n}\n\n\n/* ===================\n   API (RTK Query)\n=================== */\n\nexport const api = createApi({\n  baseQuery: async (args, api, extraOptions) => {\n    const baseQuery = fetchBaseQuery({\n      baseUrl: process.env.NEXT_PUBLIC_API_BASE_URL,\n      credentials: 'include', // Include session cookie with all requests\n      prepareHeaders: (headers) => {\n        if (typeof window !== \"undefined\") {\n          const storedUser = window.localStorage.getItem(\"authUser\");\n          if (storedUser) {\n            try {\n              const parsedUser = JSON.parse(storedUser);\n              if (parsedUser?.id) {\n                const userId = String(parsedUser.id);\n                headers.set(\"x-user-id\", userId);\n                console.log(\"Setting x-user-id header:\", userId, \"from user:\", parsedUser);\n              }\n            } catch (error) {\n              // Silently handle parse errors - Better Auth uses cookies, not localStorage\n            }\n          }\n          // Note: Better Auth uses cookies for session management, not localStorage\n          // If authUser is not in localStorage, the session cookie will be used by the server\n        }\n        return headers;\n      },\n    });\n\n    const result = await baseQuery(args, api, extraOptions);\n    \n    // Handle 401 errors - session expired or invalid\n    if (result.error && 'status' in result.error && result.error.status === 401) {\n      const errorData = result.error.data as any;\n      \n      // If server indicates login is required, redirect to login\n      if (errorData?.requiresLogin || errorData?.message?.includes('Session expired') || errorData?.message?.includes('Authentication required')) {\n        // Clear local storage\n        if (typeof window !== \"undefined\") {\n          localStorage.removeItem(\"authUser\");\n          localStorage.removeItem(\"isAuthenticated\");\n          \n          // Only redirect if we're not already on the onboarding/login page\n          const currentPath = window.location.pathname;\n          if (!currentPath.startsWith('/onboarding') && !currentPath.startsWith('/auth/')) {\n            console.log('Session expired, redirecting to login...');\n            window.location.href = '/onboarding';\n          }\n        }\n      }\n    }\n    \n    return result;\n  },\n      reducerPath: \"api\",\n      tagTypes: [\"WorkItems\", \"Milestones\", \"Parts\", \"Programs\", \"Teams\", \"Users\", \"Comments\", \"StatusLogs\", \"Attachments\", \"Invitations\", \"DeliverableTypes\", \"IssueTypes\", \"Feedback\", \"AuditLogs\"],\n  endpoints: (build) => ({\n    /* ---------- WORK ITEMS ---------- */\n    getWorkItems: build.query<WorkItem[], void>({\n        query: () => \"workItems\",\n        providesTags: (result) =>\n            result\n                ? [\n                        ...result.map(({ id }) => ({ type: \"WorkItems\" as const, id })),\n                        { type: \"WorkItems\", id: \"LIST\" },\n                    ]\n                : [{ type: \"WorkItems\", id: \"LIST\" }],\n    }),\n\n    getWorkItemById: build.query<WorkItem, number>({\n        query: (workItemId) => `workItems/${workItemId}`,\n        providesTags: (result, error, workItemId) => [{ type: \"WorkItems\", id: workItemId }],\n    }),\n\n    getWorkItemsByProgram: build.query<WorkItem[], { programId: number }>({\n        query: ({ programId }) => `workItems?programId=${programId}`,\n        providesTags: (result) =>\n            result\n                ? [\n                        ...result.map(({ id }) => ({ type: \"WorkItems\" as const, id })),\n                        { type: \"WorkItems\", id: \"LIST\" },\n                    ]\n                : [{ type: \"WorkItems\", id: \"LIST\" }],\n    }),\n\n    getWorkItemsByPart: build.query<WorkItem[], { partId: number; includeChildren?: boolean }>({\n        query: ({ partId, includeChildren }) => {\n            const params = new URLSearchParams({ partId: String(partId) });\n            if (includeChildren) {\n                params.append(\"includeChildren\", \"true\");\n            }\n            return `workItems?${params.toString()}`;\n        },\n        providesTags: (result) =>\n            result\n                ? [\n                        ...result.map(({ id }) => ({ type: \"WorkItems\" as const, id })),\n                        { type: \"WorkItems\", id: \"LIST\" },\n                    ]\n                : [{ type: \"WorkItems\", id: \"LIST\" }],\n    }),\n\n    getWorkItemsByUser: build.query<WorkItem[], string>({\n        query: (id) => `workItems/user/${id}`,\n        providesTags: (result) =>\n            result\n                ? [\n                        ...result.map(({ id }) => ({ type: \"WorkItems\" as const, id })),\n                        { type: \"WorkItems\", id: \"LIST\" },\n                    ]\n                : [{ type: \"WorkItems\", id: \"LIST\" }],\n    }),\n\n    createWorkItem: build.mutation<WorkItem, WorkItemCreateInput>({\n        query: (body) => ({\n            url: \"workItems\",\n            method: \"POST\",\n            body,\n        }),\n        invalidatesTags: [{ type: \"WorkItems\", id: \"LIST\" }],\n    }),\n\n    updateWorkItemStatus: build.mutation<\n        WorkItem,\n        { workItemId: number; status: string }\n    >({\n        query: ({ workItemId, status }) => ({\n            url: `workItems/${workItemId}/status`,\n            method: \"PATCH\",\n            body: { status },\n        }),\n        // Invalidate the item and the list, so dependent queries refetch\n        invalidatesTags: (result, error, { workItemId }) => [\n            { type: \"WorkItems\", id: workItemId },\n            { type: \"WorkItems\", id: \"LIST\" },\n        ],\n    }),\n\n    editWorkItem: build.mutation<WorkItem, { workItemId: number; updates: WorkItemEditInput }>({\n        query: ({ workItemId, updates }) => ({\n            url: `workItems/${workItemId}`,\n            method: \"PATCH\",\n            body: updates,\n        }),\n        invalidatesTags: (result, error, { workItemId }) => [\n            { type: \"WorkItems\", id: workItemId },\n            { type: \"WorkItems\", id: \"LIST\" },\n        ],\n    }),\n\n    deleteWorkItem: build.mutation<void, number>({\n        query: (workItemId) => ({\n            url: `workItems/${workItemId}`,\n            method: \"DELETE\",\n        }),\n        invalidatesTags: (result, error, workItemId) => [\n            { type: \"WorkItems\", id: workItemId },\n            { type: \"WorkItems\", id: \"LIST\" },\n        ],\n    }),\n\n    getCommentsByWorkItem: build.query<Comment[], number>({\n        query: (workItemId) => `workItems/${workItemId}/comments`,\n        providesTags: (result, error, workItemId) =>\n            result\n                ? [\n                        ...result.map(({ id }) => ({ type: \"Comments\" as const, id })),\n                        { type: \"Comments\", id: `LIST-${workItemId}` },\n                    ]\n                : [{ type: \"Comments\", id: `LIST-${workItemId}` }],\n    }),\n\n    createComment: build.mutation<\n        Comment,\n        { workItemId: number; text: string; commenterUserId: string }\n    >({\n        query: ({ workItemId, text, commenterUserId }) => ({\n            url: `workItems/${workItemId}/comments`,\n            method: \"POST\",\n            body: { text, commenterUserId },\n        }),\n        invalidatesTags: (result, error, { workItemId }) => [\n            { type: \"Comments\", id: `LIST-${workItemId}` },\n            { type: \"WorkItems\", id: workItemId },\n        ],\n    }),\n\n    updateComment: build.mutation<\n        Comment,\n        { workItemId: number; commentId: number; text: string; requesterUserId: string }\n    >({\n        query: ({ workItemId, commentId, text, requesterUserId }) => ({\n            url: `workItems/${workItemId}/comments/${commentId}`,\n            method: \"PATCH\",\n            body: { text, requesterUserId },\n        }),\n        invalidatesTags: (result, error, { workItemId, commentId }) => [\n            { type: \"Comments\", id: commentId },\n            { type: \"Comments\", id: `LIST-${workItemId}` },\n            { type: \"WorkItems\", id: workItemId },\n        ],\n    }),\n\n    deleteComment: build.mutation<\n        void,\n        { workItemId: number; commentId: number; requesterUserId: string }\n    >({\n        query: ({ workItemId, commentId, requesterUserId }) => ({\n            url: `workItems/${workItemId}/comments/${commentId}`,\n            method: \"DELETE\",\n            body: { requesterUserId },\n        }),\n        invalidatesTags: (result, error, { workItemId, commentId }) => [\n            { type: \"Comments\", id: commentId },\n            { type: \"Comments\", id: `LIST-${workItemId}` },\n            { type: \"WorkItems\", id: workItemId },\n        ],\n    }),\n\n    getStatusLogsByWorkItem: build.query<StatusLog[], number>({\n        query: (workItemId) => `workItems/${workItemId}/statusLogs`,\n        providesTags: (result, error, workItemId) =>\n            result\n                ? [\n                        ...result.map(({ id }) => ({ type: \"StatusLogs\" as const, id })),\n                        { type: \"StatusLogs\", id: `LIST-${workItemId}` },\n                    ]\n                : [{ type: \"StatusLogs\", id: `LIST-${workItemId}` }],\n    }),\n\n    createStatusLog: build.mutation<\n        StatusLog,\n        { workItemId: number; status: string; engineerUserId: string }\n    >({\n        query: ({ workItemId, status, engineerUserId }) => ({\n            url: `workItems/${workItemId}/statusLogs`,\n            method: \"POST\",\n            body: { status, engineerUserId },\n        }),\n        invalidatesTags: (result, error, { workItemId }) => [\n            { type: \"StatusLogs\", id: `LIST-${workItemId}` },\n            { type: \"WorkItems\", id: workItemId },\n        ],\n    }),\n\n    updateStatusLog: build.mutation<\n        StatusLog,\n        { workItemId: number; statusLogId: number; status: string; requesterUserId: string }\n    >({\n        query: ({ workItemId, statusLogId, status, requesterUserId }) => ({\n            url: `workItems/${workItemId}/statusLogs/${statusLogId}`,\n            method: \"PATCH\",\n            body: { status, requesterUserId },\n        }),\n        invalidatesTags: (result, error, { workItemId, statusLogId }) => [\n            { type: \"StatusLogs\", id: statusLogId },\n            { type: \"StatusLogs\", id: `LIST-${workItemId}` },\n            { type: \"WorkItems\", id: workItemId },\n        ],\n    }),\n\n    deleteStatusLog: build.mutation<\n        void,\n        { workItemId: number; statusLogId: number; requesterUserId: string }\n    >({\n        query: ({ workItemId, statusLogId, requesterUserId }) => ({\n            url: `workItems/${workItemId}/statusLogs/${statusLogId}`,\n            method: \"DELETE\",\n            body: { requesterUserId },\n        }),\n        invalidatesTags: (result, error, { workItemId, statusLogId }) => [\n            { type: \"StatusLogs\", id: statusLogId },\n            { type: \"StatusLogs\", id: `LIST-${workItemId}` },\n            { type: \"WorkItems\", id: workItemId },\n        ],\n    }),\n\n    getAttachmentsByWorkItem: build.query<Attachment[], number>({\n        query: (workItemId) => `workItems/${workItemId}/attachments`,\n        providesTags: (result, error, workItemId) =>\n            result\n                ? [\n                        ...result.map(({ id }) => ({ type: \"Attachments\" as const, id })),\n                        { type: \"Attachments\", id: `LIST-${workItemId}` },\n                    ]\n                : [{ type: \"Attachments\", id: `LIST-${workItemId}` }],\n    }),\n\n    createAttachment: build.mutation<\n        Attachment,\n        { workItemId: number; fileUrl: string; fileName: string; uploadedByUserId: string }\n    >({\n        query: ({ workItemId, fileUrl, fileName, uploadedByUserId }) => ({\n            url: `workItems/${workItemId}/attachments`,\n            method: \"POST\",\n            body: { fileUrl, fileName, uploadedByUserId },\n        }),\n        invalidatesTags: (result, error, { workItemId }) => [\n            { type: \"Attachments\", id: `LIST-${workItemId}` },\n            { type: \"WorkItems\", id: workItemId },\n        ],\n    }),\n\n    updateAttachment: build.mutation<\n        Attachment,\n        { workItemId: number; attachmentId: number; fileName: string; fileUrl: string; requesterUserId: string }\n    >({\n        query: ({ workItemId, attachmentId, fileName, fileUrl, requesterUserId }) => ({\n            url: `workItems/${workItemId}/attachments/${attachmentId}`,\n            method: \"PATCH\",\n            body: { fileName, fileUrl, requesterUserId },\n        }),\n        invalidatesTags: (result, error, { workItemId, attachmentId }) => [\n            { type: \"Attachments\", id: attachmentId },\n            { type: \"Attachments\", id: `LIST-${workItemId}` },\n            { type: \"WorkItems\", id: workItemId },\n        ],\n    }),\n\n    deleteAttachment: build.mutation<\n        void,\n        { workItemId: number; attachmentId: number; requesterUserId: string }\n    >({\n        query: ({ workItemId, attachmentId, requesterUserId }) => ({\n            url: `workItems/${workItemId}/attachments/${attachmentId}`,\n            method: \"DELETE\",\n            body: { requesterUserId },\n        }),\n        invalidatesTags: (result, error, { workItemId, attachmentId }) => [\n            { type: \"Attachments\", id: attachmentId },\n            { type: \"Attachments\", id: `LIST-${workItemId}` },\n            { type: \"WorkItems\", id: workItemId },\n        ],\n    }),\n\n\n    /* ---------- MILESTONES ---------- */\n    getMilestones: build.query<Milestone[], void>({\n      query: () => \"milestones\",\n      providesTags: [\"Milestones\"],\n    }),\n    getMilestonesByProgram: build.query<Milestone[], { programId: number }>({\n      query: ({ programId }) => `milestones?programId=${programId}`,\n      providesTags: [\"Milestones\"],\n    }),\n    createMilestone: build.mutation<Milestone, Partial<Milestone>>({\n      query: (body) => ({\n        url: \"milestones\",\n        method: \"POST\",\n        body,\n      }),\n      invalidatesTags: [\"Milestones\"],\n    }),\n    editMilestone: build.mutation<Milestone, { milestoneId: number; updates: Partial<Milestone> }>({\n      query: ({ milestoneId, updates }) => ({\n        url: `milestones/${milestoneId}`,\n        method: \"PATCH\",\n        body: updates,\n      }),\n      invalidatesTags: (result, error, { milestoneId }) => [\n        { type: \"Milestones\", id: milestoneId },\n        { type: \"Milestones\", id: \"LIST\" },\n      ],\n    }),\n\n    /* ---------- PARTS ---------- */\n    getParts: build.query<Part[], void>({\n      query: () => \"parts\",\n      providesTags: (result) =>\n        result\n          ? [\n              ...result.map(({ id }) => ({ type: \"Parts\" as const, id })),\n              { type: \"Parts\", id: \"LIST\" },\n            ]\n          : [{ type: \"Parts\", id: \"LIST\" }],\n    }),\n    getPartsByProgram: build.query<Part[], { programId: number }>({\n      query: ({ programId }) => `parts?programId=${programId}`,\n      providesTags: (result) =>\n        result\n          ? [\n              ...result.map(({ id }) => ({ type: \"Parts\" as const, id })),\n              { type: \"Parts\", id: \"LIST\" },\n            ]\n          : [{ type: \"Parts\", id: \"LIST\" }],\n    }),\n    getPartsByUser: build.query<Part[], string>({\n      query: (id) => `parts/user/${id}`,\n      providesTags: (result) =>\n        result\n          ? [\n              ...result.map(({ id }) => ({ type: \"Parts\" as const, id })),\n              { type: \"Parts\", id: \"LIST\" },\n            ]\n          : [{ type: \"Parts\", id: \"LIST\" }],\n    }),\n    createPart: build.mutation<Part, Partial<Part>>({\n      query: (body) => ({\n        url: \"parts\",\n        method: \"POST\",\n        body,\n      }),\n      invalidatesTags: [\"Parts\"],\n    }),\n    editPart: build.mutation<Part, { partId: number; updates: Partial<Part> }>({\n      query: ({ partId, updates }) => ({\n        url: `parts/${partId}`,\n        method: \"PATCH\",\n        body: updates,\n      }),\n      invalidatesTags: (result, error, { partId }) => [\n        { type: \"Parts\", id: partId },\n        { type: \"Parts\", id: \"LIST\" },\n      ],\n    }),\n    deletePart: build.mutation<void, number>({\n      query: (partId) => ({\n        url: `parts/${partId}`,\n        method: \"DELETE\",\n      }),\n      invalidatesTags: (result, error, partId) => [\n        { type: \"Parts\", id: partId },\n        { type: \"Parts\", id: \"LIST\" },\n      ],\n    }),\n\n    /* ---------- PROGRAMS ---------- */\n    getPrograms: build.query<Program[], void>({\n      query: () => \"programs\",\n      providesTags: [\"Programs\"],\n    }),\n    createProgram: build.mutation<Program, Partial<Program>>({\n      query: (body) => ({\n        url: \"programs\",\n        method: \"POST\",\n        body,\n      }),\n      invalidatesTags: [\"Programs\"],\n    }),\n    editProgram: build.mutation<Program, { programId: number; updates: Partial<Program> }>({\n      query: ({ programId, updates }) => ({\n        url: `programs/${programId}`,\n        method: \"PATCH\",\n        body: updates,\n      }),\n      invalidatesTags: (result, error, { programId }) => [\n        { type: \"Programs\", id: programId },\n        { type: \"Programs\", id: \"LIST\" },\n      ],\n    }),\n\n    /* ---------- TEAMS ---------- */\n    getTeams: build.query<DisciplineTeam[], void>({\n      query: () => \"teams\",\n      providesTags: [\"Teams\"],\n    }),\n    createTeam: build.mutation<DisciplineTeam, Partial<DisciplineTeam>>({\n      query: (body) => ({\n        url: \"teams\",\n        method: \"POST\",\n        body,\n      }),\n      invalidatesTags: [\"Teams\"],\n    }),\n    editTeam: build.mutation<DisciplineTeam, { teamId: number; updates: Partial<DisciplineTeam> }>({\n      query: ({ teamId, updates }) => ({\n        url: `teams/${teamId}`,\n        method: \"PATCH\",\n        body: updates,\n      }),\n      invalidatesTags: (result, error, { teamId }) => [\n        { type: \"Teams\", id: teamId },\n        { type: \"Teams\", id: \"LIST\" },\n      ],\n    }),\n\n    /* ---------- USERS ---------- */\n    getUsers: build.query<User[], void>({\n      query: () => \"users\",\n      providesTags: [\"Users\"],\n    }),\n\n    getUserById: build.query<User, string>({\n      query: (id) => `users/${id}`,\n      providesTags: (result, error, id) => [{ type: \"Users\", id }],\n    }),\n\n    createUser: build.mutation<User, Partial<User> & { cognitoId: string; username: string; name: string; email: string; phoneNumber: string; role: string }>({\n      query: (userData) => ({\n        url: \"users\",\n        method: \"POST\",\n        body: userData,\n      }),\n      invalidatesTags: [\"Users\"],\n    }),\n\n    updateUser: build.mutation<User, { id: string; data: Partial<User> }>({\n      query: ({ id, data }) => ({\n        url: `users/${id}`,\n        method: \"PUT\",\n        body: data,\n      }),\n      invalidatesTags: (result, error, { id }) => [\n        { type: \"Users\", id },\n        \"Users\",\n      ],\n    }),\n\n    getEmailPreferences: build.query<{\n      id: string;\n      emailNotificationsEnabled: boolean;\n      emailWorkItemAssignment: boolean;\n      emailWorkItemStatusChange: boolean;\n      emailWorkItemComment: boolean;\n      emailInvitation: boolean;\n      emailApproachingDeadline: boolean;\n    }, string>({\n      query: (id) => `users/${id}/email-preferences`,\n      providesTags: (result, error, id) => [{ type: \"Users\", id }],\n    }),\n\n    updateEmailPreferences: build.mutation<{\n      id: string;\n      emailNotificationsEnabled: boolean;\n      emailWorkItemAssignment: boolean;\n      emailWorkItemStatusChange: boolean;\n      emailWorkItemComment: boolean;\n      emailInvitation: boolean;\n      emailApproachingDeadline: boolean;\n    }, {\n      id: string;\n      preferences: {\n        emailNotificationsEnabled?: boolean;\n        emailWorkItemAssignment?: boolean;\n        emailWorkItemStatusChange?: boolean;\n        emailWorkItemComment?: boolean;\n        emailInvitation?: boolean;\n        emailApproachingDeadline?: boolean;\n      };\n    }>({\n      query: ({ id, preferences }) => ({\n        url: `users/${id}/email-preferences`,\n        method: \"PUT\",\n        body: preferences,\n      }),\n      invalidatesTags: (result, error, { id }) => [\n        { type: \"Users\", id },\n        \"Users\",\n      ],\n    }),\n\n    /* ---------- SEARCH ---------- */\n    search: build.query<SearchResults, string>({\n      query: (query) => `search?query=${query}`,\n    }),\n\n    /* ---------- INVITATIONS ---------- */\n    getInvitations: build.query<Invitation[], void>({\n      query: () => \"invitations\",\n      providesTags: [\"Invitations\"],\n    }),\n    validateInvitation: build.query<InvitationValidationResponse, string>({\n      query: (token) => `invitations/validate/${token}`,\n      // Don't cache this - always fetch fresh\n    }),\n    createInvitation: build.mutation<{ invitation: Invitation; invitationUrl: string }, InvitationCreateInput>({\n      query: (body) => ({\n        url: \"invitations\",\n        method: \"POST\",\n        body,\n      }),\n      invalidatesTags: [\"Invitations\"],\n    }),\n    revokeInvitation: build.mutation<void, number>({\n      query: (invitationId) => ({\n        url: `invitations/${invitationId}`,\n        method: \"DELETE\",\n      }),\n      invalidatesTags: [\"Invitations\"],\n    }),\n\n    /* ---------- DELIVERABLE TYPES ---------- */\n    getDeliverableTypes: build.query<DeliverableTypeModel[], void>({\n      query: () => \"deliverableTypes\",\n      providesTags: [\"DeliverableTypes\"],\n    }),\n    createDeliverableType: build.mutation<DeliverableTypeModel, DeliverableTypeCreateInput>({\n      query: (body) => ({\n        url: \"deliverableTypes\",\n        method: \"POST\",\n        body,\n      }),\n      invalidatesTags: [\"DeliverableTypes\"],\n    }),\n    updateDeliverableType: build.mutation<DeliverableTypeModel, { typeId: number; updates: DeliverableTypeUpdateInput }>({\n      query: ({ typeId, updates }) => ({\n        url: `deliverableTypes/${typeId}`,\n        method: \"PATCH\",\n        body: updates,\n      }),\n      invalidatesTags: [\"DeliverableTypes\"],\n    }),\n    deleteDeliverableType: build.mutation<void, number>({\n      query: (typeId) => ({\n        url: `deliverableTypes/${typeId}`,\n        method: \"DELETE\",\n      }),\n      invalidatesTags: [\"DeliverableTypes\"],\n    }),\n\n    /* ---------- ISSUE TYPES ---------- */\n    getIssueTypes: build.query<IssueTypeModel[], void>({\n      query: () => \"issueTypes\",\n      providesTags: [\"IssueTypes\"],\n    }),\n    createIssueType: build.mutation<IssueTypeModel, IssueTypeCreateInput>({\n      query: (body) => ({\n        url: \"issueTypes\",\n        method: \"POST\",\n        body,\n      }),\n      invalidatesTags: [\"IssueTypes\"],\n    }),\n    updateIssueType: build.mutation<IssueTypeModel, { typeId: number; updates: IssueTypeUpdateInput }>({\n      query: ({ typeId, updates }) => ({\n        url: `issueTypes/${typeId}`,\n        method: \"PATCH\",\n        body: updates,\n      }),\n      invalidatesTags: [\"IssueTypes\"],\n    }),\n    deleteIssueType: build.mutation<void, number>({\n      query: (typeId) => ({\n        url: `issueTypes/${typeId}`,\n        method: \"DELETE\",\n      }),\n      invalidatesTags: [\"IssueTypes\"],\n    }),\n\n    /* ---------- FEEDBACK ---------- */\n    getUnreadFeedbackCount: build.query<UnreadFeedbackCount, void>({\n      query: () => \"feedback/unread-count\",\n      providesTags: [\"Feedback\"],\n    }),\n    getFeedback: build.query<Feedback[], { status?: string; type?: string; priority?: string } | void>({\n      query: (params) => {\n        const searchParams = new URLSearchParams();\n        if (params?.status) searchParams.append(\"status\", params.status);\n        if (params?.type) searchParams.append(\"type\", params.type);\n        if (params?.priority) searchParams.append(\"priority\", params.priority);\n        const queryString = searchParams.toString();\n        return `feedback${queryString ? `?${queryString}` : \"\"}`;\n      },\n      providesTags: [\"Feedback\"],\n    }),\n    getFeedbackById: build.query<Feedback, number>({\n      query: (id) => `feedback/${id}`,\n      providesTags: (result, error, id) => [{ type: \"Feedback\", id }],\n    }),\n    getMyFeedback: build.query<Feedback[], void>({\n      query: () => \"feedback/my\",\n      providesTags: [\"Feedback\"],\n    }),\n    createFeedback: build.mutation<Feedback, FeedbackCreateInput>({\n      query: (body) => ({\n        url: \"feedback\",\n        method: \"POST\",\n        body,\n      }),\n      invalidatesTags: [\"Feedback\"],\n    }),\n    updateFeedback: build.mutation<Feedback, { id: number; data: FeedbackUpdateInput }>({\n      query: ({ id, data }) => ({\n        url: `feedback/${id}`,\n        method: \"PATCH\",\n        body: data,\n      }),\n      invalidatesTags: (result, error, { id }) => [\n        { type: \"Feedback\", id },\n        \"Feedback\",\n      ],\n    }),\n\n    /* ---------- AUDIT LOGS ---------- */\n    getAuditLogs: build.query<\n      {\n        auditLogs: AuditLog[];\n        pagination: {\n          page: number;\n          limit: number;\n          total: number;\n          totalPages: number;\n        };\n      },\n      {\n        page?: number;\n        limit?: number;\n        action?: string;\n        entityType?: string;\n        entityId?: number;\n        userId?: string;\n        startDate?: string;\n        endDate?: string;\n        search?: string;\n      }\n    >({\n      query: (params) => {\n        const queryParams = new URLSearchParams();\n        if (params.page) queryParams.append(\"page\", String(params.page));\n        if (params.limit) queryParams.append(\"limit\", String(params.limit));\n        if (params.action) queryParams.append(\"action\", params.action);\n        if (params.entityType) queryParams.append(\"entityType\", params.entityType);\n        if (params.entityId) queryParams.append(\"entityId\", String(params.entityId));\n        if (params.userId) queryParams.append(\"userId\", String(params.userId));\n        if (params.startDate) queryParams.append(\"startDate\", params.startDate);\n        if (params.endDate) queryParams.append(\"endDate\", params.endDate);\n        if (params.search) queryParams.append(\"search\", params.search);\n        return `auditLogs?${queryParams.toString()}`;\n      },\n      providesTags: [\"AuditLogs\"],\n    }),\n\n    getAuditLogById: build.query<AuditLog, number>({\n      query: (id) => `auditLogs/${id}`,\n      providesTags: (result, error, id) => [{ type: \"AuditLogs\", id }],\n    }),\n\n    getEntityAuditLogs: build.query<\n      AuditLog[],\n      { entityType: string; entityId: number }\n    >({\n      query: ({ entityType, entityId }) =>\n        `auditLogs/entity/${entityType}/${entityId}`,\n      providesTags: [\"AuditLogs\"],\n    }),\n\n    getAuditLogStats: build.query<\n      {\n        totalLogs: number;\n        actionsCount: Array<{ action: string; count: number }>;\n        entityTypesCount: Array<{ entityType: string; count: number }>;\n        topUsers: Array<{\n          id: string;\n          count: number;\n          user: { id: string; name: string; email: string; username: string } | null;\n        }>;\n      },\n      { startDate?: string; endDate?: string }\n    >({\n      query: (params) => {\n        const queryParams = new URLSearchParams();\n        if (params.startDate) queryParams.append(\"startDate\", params.startDate);\n        if (params.endDate) queryParams.append(\"endDate\", params.endDate);\n        return `auditLogs/stats?${queryParams.toString()}`;\n      },\n      providesTags: [\"AuditLogs\"],\n    }),\n  }),\n});\n\n/* ===================\n   HOOK EXPORTS\n=================== */\nexport const {\n  useGetWorkItemsQuery,\n  useGetWorkItemByIdQuery,\n  useGetWorkItemsByProgramQuery,\n  useGetWorkItemsByPartQuery,\n  useGetWorkItemsByUserQuery,\n  useCreateWorkItemMutation,\n  useUpdateWorkItemStatusMutation,\n  useEditWorkItemMutation,\n  useDeleteWorkItemMutation,\n  useGetCommentsByWorkItemQuery,\n  useCreateCommentMutation,\n  useUpdateCommentMutation,\n  useDeleteCommentMutation,\n  useGetStatusLogsByWorkItemQuery,\n  useCreateStatusLogMutation,\n  useUpdateStatusLogMutation,\n  useDeleteStatusLogMutation,\n  useGetAttachmentsByWorkItemQuery,\n  useCreateAttachmentMutation,\n  useUpdateAttachmentMutation,\n  useDeleteAttachmentMutation,\n\n  useGetMilestonesQuery,\n  useGetMilestonesByProgramQuery,\n  useCreateMilestoneMutation,\n  useEditMilestoneMutation,\n\n  useGetPartsQuery,\n  useGetPartsByProgramQuery,\n  useGetPartsByUserQuery,\n  useCreatePartMutation,\n  useEditPartMutation,\n  useDeletePartMutation,\n\n  useGetProgramsQuery,\n  useCreateProgramMutation,\n  useEditProgramMutation,\n\n  useGetTeamsQuery,\n  useCreateTeamMutation,\n  useEditTeamMutation,\n\n  useGetUsersQuery,\n  useGetUserByIdQuery,\n  useCreateUserMutation,\n  useUpdateUserMutation,\n  useGetEmailPreferencesQuery,\n  useUpdateEmailPreferencesMutation,\n\n  useSearchQuery,\n\n  useGetInvitationsQuery,\n  useValidateInvitationQuery,\n  useCreateInvitationMutation,\n  useRevokeInvitationMutation,\n\n  useGetDeliverableTypesQuery,\n  useCreateDeliverableTypeMutation,\n  useUpdateDeliverableTypeMutation,\n  useDeleteDeliverableTypeMutation,\n\n  useGetIssueTypesQuery,\n  useCreateIssueTypeMutation,\n  useUpdateIssueTypeMutation,\n  useDeleteIssueTypeMutation,\n\n  useGetUnreadFeedbackCountQuery,\n  useGetFeedbackQuery,\n  useGetFeedbackByIdQuery,\n  useGetMyFeedbackQuery,\n  useCreateFeedbackMutation,\n  useUpdateFeedbackMutation,\n\n  useGetAuditLogsQuery,\n  useGetAuditLogByIdQuery,\n  useGetEntityAuditLogsQuery,\n  useGetAuditLogStatsQuery,\n} = api;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1245, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/app/redux.tsx"],"sourcesContent":["import { useRef, useEffect, useState } from \"react\";\r\nimport { combineReducers, configureStore } from \"@reduxjs/toolkit\";\r\nimport {\r\n  TypedUseSelectorHook,\r\n  useDispatch,\r\n  useSelector,\r\n  Provider,\r\n} from \"react-redux\";\r\nimport globalReducer from \"@/state\";\r\nimport { api } from \"@/state/api\";\r\nimport { setupListeners } from \"@reduxjs/toolkit/query\";\r\n\r\nimport {\r\n  persistStore,\r\n  persistReducer,\r\n  FLUSH,\r\n  REHYDRATE,\r\n  PAUSE,\r\n  PERSIST,\r\n  PURGE,\r\n  REGISTER,\r\n} from \"redux-persist\";\r\nimport { PersistGate } from \"redux-persist/integration/react\";\r\nimport createWebStorage from \"redux-persist/lib/storage/createWebStorage\";\r\n\r\n/* REDUX PERSISTENCE */\r\nconst createNoopStorage = () => {\r\n  return {\r\n    getItem(_key: any) {\r\n      return Promise.resolve(null);\r\n    },\r\n    setItem(_key: any, value: any) {\r\n      return Promise.resolve(value);\r\n    },\r\n    removeItem(_key: any) {\r\n      return Promise.resolve();\r\n    },\r\n  };\r\n};\r\n\r\nconst storage =\r\n  typeof window === \"undefined\"\r\n    ? createNoopStorage()\r\n    : createWebStorage(\"local\");\r\n\r\nconst persistConfig = {\r\n  key: \"root\",\r\n  storage,\r\n  whitelist: [\"global\"],\r\n};\r\nconst rootReducer = combineReducers({\r\n  global: globalReducer,\r\n  [api.reducerPath]: api.reducer,\r\n});\r\nconst persistedReducer = persistReducer(persistConfig, rootReducer);\r\n\r\n/* REDUX STORE */\r\nexport const makeStore = () => {\r\n  return configureStore({\r\n    reducer: persistedReducer,\r\n    middleware: (getDefault) =>\r\n      getDefault({\r\n        serializableCheck: {\r\n          ignoredActions: [FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER],\r\n        },\r\n      }).concat(api.middleware),\r\n  });\r\n};\r\n\r\n/* REDUX TYPES */\r\nexport type AppStore = ReturnType<typeof makeStore>;\r\nexport type RootState = ReturnType<AppStore[\"getState\"]>;\r\nexport type AppDispatch = AppStore[\"dispatch\"];\r\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\r\n\r\n/* PROVIDER */\r\nexport default function StoreProvider({\r\n  children,\r\n}: {\r\n  children: React.ReactNode;\r\n}) {\r\n  const storeRef = useRef<AppStore | null>(null);\r\n  const [persistor, setPersistor] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n    if (!storeRef.current) {\r\n      storeRef.current = makeStore();\r\n      setupListeners(storeRef.current.dispatch);\r\n    }\r\n    \r\n    // Create persistor after store is created\r\n    if (storeRef.current && !persistor) {\r\n      setPersistor(persistStore(storeRef.current));\r\n    }\r\n  }, [persistor]);\r\n\r\n  if (!storeRef.current || !persistor) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <Provider store={storeRef.current}>\r\n      <PersistGate loading={null} persistor={persistor}>\r\n        {children}\r\n      </PersistGate>\r\n    </Provider>\r\n  );\r\n}"],"names":[],"mappings":";;;;;;;;;;;AAAA;AACA;AAAA;AACA;AAMA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAUA;AACA;;;;;;;;;;;AAEA,qBAAqB,GACrB,MAAM,oBAAoB;IACxB,OAAO;QACL,SAAQ,IAAS;YACf,OAAO,QAAQ,OAAO,CAAC;QACzB;QACA,SAAQ,IAAS,EAAE,KAAU;YAC3B,OAAO,QAAQ,OAAO,CAAC;QACzB;QACA,YAAW,IAAS;YAClB,OAAO,QAAQ,OAAO;QACxB;IACF;AACF;AAEA,MAAM,UACJ,uCACI,sBACA;AAEN,MAAM,gBAAgB;IACpB,KAAK;IACL;IACA,WAAW;QAAC;KAAS;AACvB;AACA,MAAM,cAAc,IAAA,0JAAe,EAAC;IAClC,QAAQ,gIAAa;IACrB,CAAC,0HAAG,CAAC,WAAW,CAAC,EAAE,0HAAG,CAAC,OAAO;AAChC;AACA,MAAM,mBAAmB,IAAA,uNAAc,EAAC,eAAe;AAGhD,MAAM,YAAY;IACvB,OAAO,IAAA,6MAAc,EAAC;QACpB,SAAS;QACT,YAAY,CAAC,aACX,WAAW;gBACT,mBAAmB;oBACjB,gBAAgB;wBAAC,4JAAK;wBAAE,gKAAS;wBAAE,4JAAK;wBAAE,8JAAO;wBAAE,4JAAK;wBAAE,+JAAQ;qBAAC;gBACrE;YACF,GAAG,MAAM,CAAC,0HAAG,CAAC,UAAU;IAC5B;AACF;AAMO,MAAM,iBAAiB,IAAM,IAAA,wKAAW;AACxC,MAAM,iBAAkD,wKAAW;AAG3D,SAAS,cAAc,EACpC,QAAQ,EAGT;IACC,MAAM,WAAW,IAAA,+MAAM,EAAkB;IACzC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAM;IAEhD,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,SAAS,OAAO,EAAE;YACrB,SAAS,OAAO,GAAG;YACnB,IAAA,kMAAc,EAAC,SAAS,OAAO,CAAC,QAAQ;QAC1C;QAEA,0CAA0C;QAC1C,IAAI,SAAS,OAAO,IAAI,CAAC,WAAW;YAClC,aAAa,IAAA,iNAAY,EAAC,SAAS,OAAO;QAC5C;IACF,GAAG;QAAC;KAAU;IAEd,IAAI,CAAC,SAAS,OAAO,IAAI,CAAC,WAAW;QACnC,qBAAO,8OAAC;sBAAI;;;;;;IACd;IAEA,qBACE,8OAAC,qKAAQ;QAAC,OAAO,SAAS,OAAO;kBAC/B,cAAA,8OAAC,6KAAW;YAAC,SAAS;YAAM,WAAW;sBACpC;;;;;;;;;;;AAIT","debugId":null}},
    {"offset": {"line": 1369, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/lib/better-auth-client.ts"],"sourcesContent":["import { createAuthClient } from \"better-auth/react\";\r\n\r\nexport const authClient = createAuthClient({\r\n  baseURL: process.env.NEXT_PUBLIC_API_BASE_URL || \"http://localhost:8000\",\r\n  basePath: \"/api/auth\",\r\n});\r\n\r\nexport const { signIn, signUp, signOut, useSession } = authClient;\r\n\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAEO,MAAM,aAAa,IAAA,uMAAgB,EAAC;IACzC,SAAS,6DAAwC;IACjD,UAAU;AACZ;AAEO,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE,GAAG","debugId":null}},
    {"offset": {"line": 1392, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/lib/betterAuthService.ts"],"sourcesContent":["// Better Auth service implementation\nimport { authClient } from \"./better-auth-client\";\nimport { AuthUser, AuthService, SignUpData, SignInData, AuthTokens } from \"./auth\";\n\nexport class BetterAuthService implements AuthService {\n  private listeners: Array<(user: AuthUser | null) => void> = [];\n  private currentUser: AuthUser | null = null;\n\n  constructor() {\n    // Initialize from Better Auth session\n    this.initializeFromSession();\n  }\n\n  private async initializeFromSession() {\n    try {\n      const session = await authClient.getSession();\n      if (session?.data?.user) {\n        // Fetch full user data from backend\n        await this.fetchUserFromBackend(session.data.user.id);\n      }\n    } catch (error) {\n      console.debug(\"No Better Auth session found\");\n    }\n  }\n\n  private async fetchUserFromBackend(betterAuthUserId: string): Promise<AuthUser | null> {\n    const apiBaseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || \"http://localhost:8000\";\n    \n    try {\n      const response = await fetch(`${apiBaseUrl}/users/${betterAuthUserId}`, {\n        method: \"GET\",\n        credentials: \"include\", // Include session cookie\n      });\n\n      if (response.ok) {\n        const userData = await response.json();\n        const user: AuthUser = {\n          id: userData.id,\n          organizationId: userData.organizationId,\n          username: userData.username,\n          name: userData.name,\n          email: userData.email,\n          phoneNumber: userData.phoneNumber,\n          role: userData.role,\n          profilePictureUrl: userData.profilePictureUrl || undefined,\n          disciplineTeamId: userData.disciplineTeamId || undefined,\n          organizationName: userData.organization?.name || undefined,\n        };\n        this.currentUser = user;\n        this.notifyListeners();\n        return user;\n      }\n    } catch (error) {\n      console.error(\"Failed to fetch user from backend:\", error);\n    }\n    \n    return null;\n  }\n\n  private notifyListeners() {\n    this.listeners.forEach(callback => callback(this.currentUser));\n  }\n\n  async signUp(data: SignUpData): Promise<AuthUser> {\n    // Step 1: Sign up with Better Auth\n    // Note: phoneNumber is NOT passed here - Better Auth rejects additional fields that aren't properly configured\n    // The phoneNumber will be set in the onboarding flow via the /onboarding/signup endpoint\n    // The database hook will set phoneNumber to an empty string initially\n    const { data: signUpData, error: signUpError } = await authClient.signUp.email({\n      email: data.email,\n      password: data.password,\n      name: data.name,\n    });\n\n    if (signUpError) {\n      // Log the full error for debugging\n      console.error(\"Better Auth sign-up error (full):\", JSON.stringify(signUpError, null, 2));\n      console.error(\"Better Auth sign-up error message:\", signUpError.message);\n      console.error(\"Better Auth sign-up error code:\", signUpError.code);\n      console.error(\"Better Auth sign-up error status:\", signUpError.status);\n      throw new Error(signUpError.message || signUpError.code || \"Failed to sign up\");\n    }\n\n    if (!signUpData?.user) {\n      throw new Error(\"Sign up succeeded but no user data returned\");\n    }\n\n    // Step 2: Create user in database via onboarding endpoint\n    // NOTE: If invitationToken is provided, the backend will update the user to join the invitation organization\n    // If not provided, it will create a new organization\n    // The onboarding page will handle the actual user creation with the invitation token\n    // So we don't call the onboarding endpoint here - let the onboarding flow handle it\n    // This prevents duplicate user creation\n    \n    // Just return the Better Auth user - the onboarding flow will handle database creation\n    const user: AuthUser = {\n      id: signUpData.user.id,\n      organizationId: 0, // Will be set by onboarding endpoint\n      username: signUpData.user.name?.split(' ')[0] || signUpData.user.email.split('@')[0],\n      name: signUpData.user.name || '',\n      email: signUpData.user.email,\n      phoneNumber: data.phoneNumber,\n      role: data.role,\n    };\n    \n    this.currentUser = user;\n    this.notifyListeners();\n    return user;\n  }\n\n  async signIn(data: SignInData): Promise<AuthUser> {\n    // Sign in with Better Auth\n    const { data: signInData, error: signInError } = await authClient.signIn.email({\n      email: data.email,\n      password: data.password,\n    });\n\n    if (signInError) {\n      throw new Error(signInError.message || \"Failed to sign in\");\n    }\n\n    if (!signInData?.user) {\n      throw new Error(\"Sign in succeeded but no user data returned\");\n    }\n\n    // Fetch full user data from backend\n    const user = await this.fetchUserFromBackend(signInData.user.id);\n    \n    if (!user) {\n      // User authenticated but not in database - needs onboarding\n      throw new Error(\"User authenticated but not found in database. Please complete onboarding.\");\n    }\n\n    return user;\n  }\n\n  async signOut(): Promise<void> {\n    // Sign out from Better Auth\n    await authClient.signOut();\n    \n    // Clear local state\n    this.currentUser = null;\n    this.notifyListeners();\n  }\n\n  async refreshTokens(): Promise<AuthTokens> {\n    // Better Auth handles token refresh automatically\n    // This is a placeholder for the interface\n    throw new Error(\"Token refresh is handled automatically by Better Auth\");\n  }\n\n  async getCurrentUser(): Promise<AuthUser | null> {\n    // Get session from Better Auth\n    const { data: session, error } = await authClient.getSession();\n\n    if (error || !session?.user) {\n      this.currentUser = null;\n      this.notifyListeners();\n      return null;\n    }\n\n    // If we have a cached user with the same ID, return it\n    if (this.currentUser && this.currentUser.id === session.user.id) {\n      return this.currentUser;\n    }\n\n    // Fetch full user data from backend\n    const user = await this.fetchUserFromBackend(session.user.id);\n    return user;\n  }\n\n  async updateUserProfile(updates: Partial<AuthUser>): Promise<AuthUser> {\n    if (!this.currentUser) {\n      throw new Error(\"No authenticated user\");\n    }\n\n    const apiBaseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || \"http://localhost:8000\";\n\n    try {\n      const response = await fetch(`${apiBaseUrl}/users/${this.currentUser.id}`, {\n        method: \"PUT\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        credentials: \"include\",\n        body: JSON.stringify(updates),\n      });\n\n      if (response.ok) {\n        const updatedUser = await response.json();\n        const user: AuthUser = {\n          id: updatedUser.id,\n          organizationId: updatedUser.organizationId,\n          username: updatedUser.username,\n          name: updatedUser.name,\n          email: updatedUser.email,\n          phoneNumber: updatedUser.phoneNumber,\n          role: updatedUser.role,\n          profilePictureUrl: updatedUser.profilePictureUrl || undefined,\n          disciplineTeamId: updatedUser.disciplineTeamId || undefined,\n          organizationName: updatedUser.organization?.name || undefined,\n        };\n        this.currentUser = user;\n        this.notifyListeners();\n        return user;\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || \"Failed to update user profile\");\n      }\n    } catch (error) {\n      console.error(\"Failed to update user profile:\", error);\n      throw new Error(\n        error instanceof Error\n          ? error.message\n          : \"Unable to update profile. Please check your connection and try again.\"\n      );\n    }\n  }\n\n  async changePassword(oldPassword: string, newPassword: string): Promise<void> {\n    // Better Auth handles password changes\n    // This would need to be implemented using Better Auth's password change endpoint\n    throw new Error(\"Password change not yet implemented with Better Auth\");\n  }\n\n  async resetPassword(email: string): Promise<void> {\n    // Better Auth handles password reset\n    throw new Error(\"Password reset not yet implemented with Better Auth\");\n  }\n\n  async confirmPasswordReset(email: string, code: string, newPassword: string): Promise<void> {\n    // Better Auth handles password reset confirmation\n    throw new Error(\"Password reset confirmation not yet implemented with Better Auth\");\n  }\n\n  getTokens(): AuthTokens | null {\n    // Better Auth handles tokens internally via cookies\n    // This is a placeholder for the interface\n    return null;\n  }\n\n  isAuthenticated(): boolean {\n    return this.currentUser !== null;\n  }\n\n  onAuthStateChange(callback: (user: AuthUser | null) => void): () => void {\n    this.listeners.push(callback);\n\n    // Return unsubscribe function\n    return () => {\n      const index = this.listeners.indexOf(callback);\n      if (index > -1) {\n        this.listeners.splice(index, 1);\n      }\n    };\n  }\n}\n\n"],"names":[],"mappings":"AAAA,qCAAqC;;;;;AACrC;;AAGO,MAAM;IACH,YAAoD,EAAE,CAAC;IACvD,cAA+B,KAAK;IAE5C,aAAc;QACZ,sCAAsC;QACtC,IAAI,CAAC,qBAAqB;IAC5B;IAEA,MAAc,wBAAwB;QACpC,IAAI;YACF,MAAM,UAAU,MAAM,oJAAU,CAAC,UAAU;YAC3C,IAAI,SAAS,MAAM,MAAM;gBACvB,oCAAoC;gBACpC,MAAM,IAAI,CAAC,oBAAoB,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,EAAE;YACtD;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC;QAChB;IACF;IAEA,MAAc,qBAAqB,gBAAwB,EAA4B;QACrF,MAAM,aAAa,6DAAwC;QAE3D,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,WAAW,OAAO,EAAE,kBAAkB,EAAE;gBACtE,QAAQ;gBACR,aAAa;YACf;YAEA,IAAI,SAAS,EAAE,EAAE;gBACf,MAAM,WAAW,MAAM,SAAS,IAAI;gBACpC,MAAM,OAAiB;oBACrB,IAAI,SAAS,EAAE;oBACf,gBAAgB,SAAS,cAAc;oBACvC,UAAU,SAAS,QAAQ;oBAC3B,MAAM,SAAS,IAAI;oBACnB,OAAO,SAAS,KAAK;oBACrB,aAAa,SAAS,WAAW;oBACjC,MAAM,SAAS,IAAI;oBACnB,mBAAmB,SAAS,iBAAiB,IAAI;oBACjD,kBAAkB,SAAS,gBAAgB,IAAI;oBAC/C,kBAAkB,SAAS,YAAY,EAAE,QAAQ;gBACnD;gBACA,IAAI,CAAC,WAAW,GAAG;gBACnB,IAAI,CAAC,eAAe;gBACpB,OAAO;YACT;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sCAAsC;QACtD;QAEA,OAAO;IACT;IAEQ,kBAAkB;QACxB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAA,WAAY,SAAS,IAAI,CAAC,WAAW;IAC9D;IAEA,MAAM,OAAO,IAAgB,EAAqB;QAChD,mCAAmC;QACnC,+GAA+G;QAC/G,yFAAyF;QACzF,sEAAsE;QACtE,MAAM,EAAE,MAAM,UAAU,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,oJAAU,CAAC,MAAM,CAAC,KAAK,CAAC;YAC7E,OAAO,KAAK,KAAK;YACjB,UAAU,KAAK,QAAQ;YACvB,MAAM,KAAK,IAAI;QACjB;QAEA,IAAI,aAAa;YACf,mCAAmC;YACnC,QAAQ,KAAK,CAAC,qCAAqC,KAAK,SAAS,CAAC,aAAa,MAAM;YACrF,QAAQ,KAAK,CAAC,sCAAsC,YAAY,OAAO;YACvE,QAAQ,KAAK,CAAC,mCAAmC,YAAY,IAAI;YACjE,QAAQ,KAAK,CAAC,qCAAqC,YAAY,MAAM;YACrE,MAAM,IAAI,MAAM,YAAY,OAAO,IAAI,YAAY,IAAI,IAAI;QAC7D;QAEA,IAAI,CAAC,YAAY,MAAM;YACrB,MAAM,IAAI,MAAM;QAClB;QAEA,0DAA0D;QAC1D,6GAA6G;QAC7G,qDAAqD;QACrD,qFAAqF;QACrF,oFAAoF;QACpF,wCAAwC;QAExC,uFAAuF;QACvF,MAAM,OAAiB;YACrB,IAAI,WAAW,IAAI,CAAC,EAAE;YACtB,gBAAgB;YAChB,UAAU,WAAW,IAAI,CAAC,IAAI,EAAE,MAAM,IAAI,CAAC,EAAE,IAAI,WAAW,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;YACpF,MAAM,WAAW,IAAI,CAAC,IAAI,IAAI;YAC9B,OAAO,WAAW,IAAI,CAAC,KAAK;YAC5B,aAAa,KAAK,WAAW;YAC7B,MAAM,KAAK,IAAI;QACjB;QAEA,IAAI,CAAC,WAAW,GAAG;QACnB,IAAI,CAAC,eAAe;QACpB,OAAO;IACT;IAEA,MAAM,OAAO,IAAgB,EAAqB;QAChD,2BAA2B;QAC3B,MAAM,EAAE,MAAM,UAAU,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,oJAAU,CAAC,MAAM,CAAC,KAAK,CAAC;YAC7E,OAAO,KAAK,KAAK;YACjB,UAAU,KAAK,QAAQ;QACzB;QAEA,IAAI,aAAa;YACf,MAAM,IAAI,MAAM,YAAY,OAAO,IAAI;QACzC;QAEA,IAAI,CAAC,YAAY,MAAM;YACrB,MAAM,IAAI,MAAM;QAClB;QAEA,oCAAoC;QACpC,MAAM,OAAO,MAAM,IAAI,CAAC,oBAAoB,CAAC,WAAW,IAAI,CAAC,EAAE;QAE/D,IAAI,CAAC,MAAM;YACT,4DAA4D;YAC5D,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO;IACT;IAEA,MAAM,UAAyB;QAC7B,4BAA4B;QAC5B,MAAM,oJAAU,CAAC,OAAO;QAExB,oBAAoB;QACpB,IAAI,CAAC,WAAW,GAAG;QACnB,IAAI,CAAC,eAAe;IACtB;IAEA,MAAM,gBAAqC;QACzC,kDAAkD;QAClD,0CAA0C;QAC1C,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,iBAA2C;QAC/C,+BAA+B;QAC/B,MAAM,EAAE,MAAM,OAAO,EAAE,KAAK,EAAE,GAAG,MAAM,oJAAU,CAAC,UAAU;QAE5D,IAAI,SAAS,CAAC,SAAS,MAAM;YAC3B,IAAI,CAAC,WAAW,GAAG;YACnB,IAAI,CAAC,eAAe;YACpB,OAAO;QACT;QAEA,uDAAuD;QACvD,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,EAAE,KAAK,QAAQ,IAAI,CAAC,EAAE,EAAE;YAC/D,OAAO,IAAI,CAAC,WAAW;QACzB;QAEA,oCAAoC;QACpC,MAAM,OAAO,MAAM,IAAI,CAAC,oBAAoB,CAAC,QAAQ,IAAI,CAAC,EAAE;QAC5D,OAAO;IACT;IAEA,MAAM,kBAAkB,OAA0B,EAAqB;QACrE,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,aAAa,6DAAwC;QAE3D,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,WAAW,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,EAAE;gBACzE,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,aAAa;gBACb,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,IAAI,SAAS,EAAE,EAAE;gBACf,MAAM,cAAc,MAAM,SAAS,IAAI;gBACvC,MAAM,OAAiB;oBACrB,IAAI,YAAY,EAAE;oBAClB,gBAAgB,YAAY,cAAc;oBAC1C,UAAU,YAAY,QAAQ;oBAC9B,MAAM,YAAY,IAAI;oBACtB,OAAO,YAAY,KAAK;oBACxB,aAAa,YAAY,WAAW;oBACpC,MAAM,YAAY,IAAI;oBACtB,mBAAmB,YAAY,iBAAiB,IAAI;oBACpD,kBAAkB,YAAY,gBAAgB,IAAI;oBAClD,kBAAkB,YAAY,YAAY,EAAE,QAAQ;gBACtD;gBACA,IAAI,CAAC,WAAW,GAAG;gBACnB,IAAI,CAAC,eAAe;gBACpB,OAAO;YACT,OAAO;gBACL,MAAM,YAAY,MAAM,SAAS,IAAI;gBACrC,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI;YACvC;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,kCAAkC;YAChD,MAAM,IAAI,MACR,iBAAiB,QACb,MAAM,OAAO,GACb;QAER;IACF;IAEA,MAAM,eAAe,WAAmB,EAAE,WAAmB,EAAiB;QAC5E,uCAAuC;QACvC,iFAAiF;QACjF,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,cAAc,KAAa,EAAiB;QAChD,qCAAqC;QACrC,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,qBAAqB,KAAa,EAAE,IAAY,EAAE,WAAmB,EAAiB;QAC1F,kDAAkD;QAClD,MAAM,IAAI,MAAM;IAClB;IAEA,YAA+B;QAC7B,oDAAoD;QACpD,0CAA0C;QAC1C,OAAO;IACT;IAEA,kBAA2B;QACzB,OAAO,IAAI,CAAC,WAAW,KAAK;IAC9B;IAEA,kBAAkB,QAAyC,EAAc;QACvE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;QAEpB,8BAA8B;QAC9B,OAAO;YACL,MAAM,QAAQ,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC;YACrC,IAAI,QAAQ,CAAC,GAAG;gBACd,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO;YAC/B;QACF;IACF;AACF","debugId":null}},
    {"offset": {"line": 1615, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/lib/auth.ts"],"sourcesContent":["// Authentication service abstraction layer\n// This will allow easy switching between mock auth and Cognito\nimport { BetterAuthService } from \"./betterAuthService\";\n\nexport interface AuthUser {\n  id: string; // Better Auth user ID (string)\n  organizationId: number;\n  username: string;\n  name: string;\n  email: string;\n  phoneNumber: string;\n  role: string;\n  profilePictureUrl?: string;\n  disciplineTeamId?: number;\n  organizationName?: string;\n}\n\nexport interface AuthTokens {\n  accessToken: string;\n  refreshToken: string;\n  idToken: string;\n}\n\nexport interface SignUpData {\n  email: string;\n  password: string;\n  name: string;\n  phoneNumber: string;\n  role: string;\n  invitationToken?: string; // Optional invitation token\n}\n\nexport interface SignInData {\n  email: string;\n  password: string;\n}\n\nexport interface AuthService {\n  // Authentication methods\n  signUp(data: SignUpData): Promise<AuthUser>;\n  signIn(data: SignInData): Promise<AuthUser>;\n  signOut(): Promise<void>;\n  refreshTokens(): Promise<AuthTokens>;\n  \n  // User management\n  getCurrentUser(): Promise<AuthUser | null>;\n  updateUserProfile(updates: Partial<AuthUser>): Promise<AuthUser>;\n  changePassword(oldPassword: string, newPassword: string): Promise<void>;\n  resetPassword(email: string): Promise<void>;\n  confirmPasswordReset(email: string, code: string, newPassword: string): Promise<void>;\n  \n  // Token management\n  getTokens(): AuthTokens | null;\n  isAuthenticated(): boolean;\n  \n  // Event listeners\n  onAuthStateChange(callback: (user: AuthUser | null) => void): () => void;\n}\n\n// Mock authentication service (current implementation)\nexport class MockAuthService implements AuthService {\n  private currentUser: AuthUser | null = null;\n  private listeners: Array<(user: AuthUser | null) => void> = [];\n\n  constructor() {\n    // Initialize from localStorage if available\n    this.loadFromStorage();\n  }\n\n  private loadFromStorage() {\n    if (typeof window !== 'undefined') {\n      const stored = localStorage.getItem('authUser');\n      if (stored) {\n        try {\n          const parsed: AuthUser = JSON.parse(stored);\n          this.currentUser = {\n            ...parsed,\n            organizationId: parsed?.organizationId ?? 1,\n          };\n        } catch (error) {\n          console.warn('Failed to parse stored auth user', error);\n          this.currentUser = null;\n        }\n      }\n    }\n  }\n\n  private saveToStorage() {\n    if (typeof window !== 'undefined') {\n      if (this.currentUser) {\n        localStorage.setItem('authUser', JSON.stringify(this.currentUser));\n        localStorage.setItem('isAuthenticated', 'true');\n      } else {\n        localStorage.removeItem('authUser');\n        localStorage.removeItem('isAuthenticated');\n      }\n    }\n  }\n\n  private notifyListeners() {\n    this.listeners.forEach(callback => callback(this.currentUser));\n  }\n\n  async signUp(data: SignUpData): Promise<AuthUser> {\n    // NOTE: With Cognito integration, signup flow has changed:\n    // 1. User must first sign up in Cognito (via Cognito hosted UI or API)\n    // 2. After Cognito authentication, user is redirected to /auth/callback\n    // 3. Callback checks if user exists in DB, if not redirects to /onboarding\n    // 4. Onboarding page calls /onboarding/signup with session cookie (cognitoId comes from session)\n    \n    // For mock auth service, we'll still try to call the endpoint\n    // but the backend will reject it if there's no Cognito session\n    const username = data.email.split('@')[0];\n    const apiBaseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:8000';\n    \n    let user: AuthUser | null = null;\n    \n    try {\n      const headers: HeadersInit = {\n        'Content-Type': 'application/json',\n      };\n\n      // Use onboarding endpoint which creates both organization and user\n      // NOTE: This will fail without a Cognito session - user should authenticate first\n      const response = await fetch(`${apiBaseUrl}/onboarding/signup`, {\n        method: 'POST',\n        headers,\n        credentials: 'include', // Include session cookie\n        body: JSON.stringify({\n          // cognitoId is now retrieved from session on server side\n          username,\n          name: data.name,\n          email: data.email,\n          phoneNumber: data.phoneNumber,\n          role: data.role,\n          // organizationName is optional - backend will use default name if not provided\n        }),\n      });\n\n      if (response.ok) {\n        // User and organization created in database successfully\n        const result = await response.json();\n        console.log('Onboarding response:', result);\n        \n        // Ensure userId is present - Prisma returns userId as the primary key\n        if (!result.user?.id) {\n          console.error('User object missing id:', result.user);\n          throw new Error('User creation response missing userId');\n        }\n        \n        user = {\n          id: result.user.id,\n          organizationId: result.organization.id,\n          username: result.user.username,\n          name: result.user.name,\n          email: result.user.email,\n          phoneNumber: result.user.phoneNumber,\n          role: result.user.role,\n          profilePictureUrl: result.user.profilePictureUrl || undefined,\n          disciplineTeamId: result.user.disciplineTeamId || undefined,\n          organizationName: result.organization.name || undefined,\n        };\n        console.log('User and organization created in database:', user);\n      } else {\n        // If user already exists or database error\n        const errorData = await response.json();\n        console.error('Failed to save user to database:', errorData);\n        \n        // If user already exists (409), use that user data\n        if (response.status === 409 && errorData.user) {\n          user = {\n            id: errorData.user.id,\n            organizationId: errorData.user.organizationId,\n            username: errorData.user.username,\n            name: errorData.user.name,\n            email: errorData.user.email,\n            phoneNumber: errorData.user.phoneNumber,\n            role: errorData.user.role,\n            profilePictureUrl: errorData.user.profilePictureUrl || undefined,\n            disciplineTeamId: errorData.user.disciplineTeamId || undefined,\n          };\n          console.log('Using existing user from error response:', user);\n        } else {\n          // For other errors, throw so the UI can handle it\n          throw new Error(errorData.message || 'Failed to create user account');\n        }\n      }\n    } catch (error) {\n      // If API call fails (e.g., server not running), throw error\n      console.error('Onboarding API call failed:', error);\n      throw new Error(\n        error instanceof Error \n          ? error.message \n          : 'Unable to create account. Please check your connection and try again.'\n      );\n    }\n\n    // Verify user was created successfully\n    if (!user) {\n      throw new Error('User creation failed: no user object returned');\n    }\n\n    // Verify user has required fields before saving\n    if (!user.id || !user.organizationId) {\n      console.error('User object missing required fields:', user);\n      throw new Error('User creation failed: missing userId or organizationId');\n    }\n    \n    this.currentUser = user;\n    this.saveToStorage();\n    console.log('User saved to localStorage:', this.currentUser);\n    this.notifyListeners();\n    \n    return user;\n  }\n\n  async signIn(data: SignInData): Promise<AuthUser> {\n    // Simulate API call delay\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    \n    // Check if user exists in localStorage\n    if (typeof window !== 'undefined') {\n      const storedUser = localStorage.getItem('authUser');\n      if (storedUser) {\n        const existingUser = JSON.parse(storedUser);\n        // Verify email matches\n        if (existingUser.email === data.email) {\n          const normalizedUser: AuthUser = {\n            ...existingUser,\n            organizationId: existingUser?.organizationId ?? 1,\n          };\n          this.currentUser = normalizedUser;\n          this.saveToStorage();\n          this.notifyListeners();\n          return normalizedUser;\n        }\n      }\n    }\n    \n    // If no existing user found, throw error (user should sign up first)\n    throw new Error('User not found. Please sign up first.');\n  }\n\n  async signOut(): Promise<void> {\n    // Clear local storage first\n    this.currentUser = null;\n    this.saveToStorage();\n    this.notifyListeners();\n    \n    // Redirect to server logout endpoint\n    // The server will clear the session and redirect to Cognito logout,\n    // which will then redirect back to the frontend\n    const apiBaseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:8000';\n    window.location.href = `${apiBaseUrl}/auth/logout`;\n  }\n\n  async refreshTokens(): Promise<AuthTokens> {\n    // Mock implementation\n    return {\n      accessToken: 'mock-access-token',\n      refreshToken: 'mock-refresh-token',\n      idToken: 'mock-id-token',\n    };\n  }\n\n  async getCurrentUser(): Promise<AuthUser | null> {\n    // Always check for Cognito session on server to get fresh data (including organization name)\n    const apiBaseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:8000';\n    try {\n      // Add timeout to prevent hanging requests\n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), 5000); // 5 second timeout\n\n      const response = await fetch(`${apiBaseUrl}/auth/me`, {\n        method: 'GET',\n        credentials: 'include', // Include session cookie\n        signal: controller.signal,\n      });\n\n      clearTimeout(timeoutId);\n\n      if (response.ok) {\n        const data = await response.json();\n        \n        // If user has Cognito session and exists in database, use that\n        if (data.isAuthenticated && data.userExistsInDb && data.user) {\n          const user: AuthUser = {\n            id: data.user.id,\n            organizationId: data.user.organizationId,\n            username: data.user.username,\n            name: data.user.name,\n            email: data.user.email,\n            phoneNumber: data.user.phoneNumber,\n            role: data.user.role,\n            profilePictureUrl: data.user.profilePictureUrl || undefined,\n            disciplineTeamId: data.user.disciplineTeamId || undefined,\n            organizationName: data.organization?.name || undefined,\n          };\n          this.currentUser = user;\n          this.saveToStorage();\n          this.notifyListeners();\n          return user;\n        }\n        \n        // If user has Cognito session but not in DB, return null (they need onboarding)\n        // The onboarding page will handle this case\n        if (data.isAuthenticated && !data.userExistsInDb) {\n          return null; // User needs to complete onboarding\n        }\n      }\n    } catch (error) {\n      // Only log if it's not a network error (backend might not be running)\n      if (error instanceof Error) {\n        if (error.name === 'AbortError') {\n          // Request timed out - backend might be slow or unavailable\n          console.debug('Auth check request timed out - backend may be unavailable');\n        } else if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {\n          // Network error - backend is likely not running\n          console.debug('Backend server appears to be unavailable');\n        } else {\n          // Other error - log it\n          console.error('Failed to check Cognito session:', error);\n        }\n      } else {\n        console.error('Failed to check Cognito session:', error);\n      }\n      \n      // If we have a cached user and the server is unavailable, return the cached user\n      if (this.currentUser) {\n        return this.currentUser;\n      }\n    }\n\n    // If no server response and no cached user, return null\n    return this.currentUser || null;\n  }\n\n  async updateUserProfile(updates: Partial<AuthUser>): Promise<AuthUser> {\n    if (!this.currentUser) {\n      throw new Error('No authenticated user');\n    }\n\n    const baseUser = this.currentUser;\n    // Try to update user in database\n    const apiBaseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:3001';\n    \n    try {\n      const response = await fetch(`${apiBaseUrl}/users/${this.currentUser.id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'x-user-id': String(this.currentUser.id),\n        },\n        body: JSON.stringify(updates),\n      });\n\n      if (response.ok) {\n        // User updated in database successfully\n        const updatedUser = await response.json();\n        const mergedUser: AuthUser = {\n          ...baseUser,\n          ...updatedUser,\n          id: baseUser.id,\n          organizationId: updatedUser?.organizationId ?? baseUser.organizationId,\n        };\n        this.currentUser = mergedUser;\n        console.log('User updated in database:', updatedUser);\n      } else {\n        // If database update fails, still update local storage\n        console.warn('Failed to update user in database, using local storage only');\n        const mergedUser: AuthUser = {\n          ...baseUser,\n          ...updates,\n          id: baseUser.id,\n          organizationId: baseUser.organizationId,\n        };\n        this.currentUser = mergedUser;\n      }\n    } catch (error) {\n      // If API call fails, use local storage\n      console.warn('Database API not available, using local storage only:', error);\n      const mergedUser: AuthUser = {\n        ...baseUser,\n        ...updates,\n        id: baseUser.id,\n        organizationId: baseUser.organizationId,\n      };\n      this.currentUser = mergedUser;\n    }\n\n    this.saveToStorage();\n    this.notifyListeners();\n    \n    const finalUser = this.currentUser;\n    if (!finalUser) {\n      throw new Error('Failed to update user profile');\n    }\n    return finalUser;\n  }\n\n  async changePassword(oldPassword: string, newPassword: string): Promise<void> {\n    // Mock implementation\n    await new Promise(resolve => setTimeout(resolve, 1000));\n  }\n\n  async resetPassword(email: string): Promise<void> {\n    // Mock implementation\n    await new Promise(resolve => setTimeout(resolve, 1000));\n  }\n\n  async confirmPasswordReset(email: string, code: string, newPassword: string): Promise<void> {\n    // Mock implementation\n    await new Promise(resolve => setTimeout(resolve, 1000));\n  }\n\n  getTokens(): AuthTokens | null {\n    return {\n      accessToken: 'mock-access-token',\n      refreshToken: 'mock-refresh-token',\n      idToken: 'mock-id-token',\n    };\n  }\n\n  isAuthenticated(): boolean {\n    return this.currentUser !== null;\n  }\n\n  onAuthStateChange(callback: (user: AuthUser | null) => void): () => void {\n    this.listeners.push(callback);\n    \n    // Return unsubscribe function\n    return () => {\n      const index = this.listeners.indexOf(callback);\n      if (index > -1) {\n        this.listeners.splice(index, 1);\n      }\n    };\n  }\n}\n\n// Factory function to create auth service\nexport function createAuthService(): AuthService {\n  // Use Better Auth service\n  return new BetterAuthService();\n}\n\n// Singleton instance - create synchronously for backward compatibility\nexport const authService: AuthService = new BetterAuthService();\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2129, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/contexts/AuthContext.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useContext, useEffect, useState, ReactNode } from 'react';\nimport { AuthUser, authService } from '@/lib/auth';\nimport * as Sentry from \"@sentry/nextjs\";\n\n// Authentication context\ninterface AuthContextType {\n  user: AuthUser | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n  signUp: (data: { email: string; password: string; name: string; phoneNumber: string; role: string }) => Promise<AuthUser>;\n  signIn: (data: { email: string; password: string }) => Promise<AuthUser>;\n  signOut: () => Promise<void>;\n  updateProfile: (updates: Partial<AuthUser>) => Promise<AuthUser>;\n  refreshTokens: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\n// Authentication provider component\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport function AuthProvider({ children }: AuthProviderProps) {\n  const [user, setUser] = useState<AuthUser | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const sanitizeProfilePictureUrl = (value?: string | null) => {\n    if (!value) return undefined;\n    const trimmed = value.trim();\n    if (!trimmed) return undefined;\n    const lower = trimmed.toLowerCase();\n    if (lower.startsWith('http://') || lower.startsWith('https://')) {\n      return undefined;\n    }\n    return trimmed.startsWith('/') ? trimmed : `/${trimmed}`;\n  };\n\n  const sanitizeUser = (current: AuthUser | null): AuthUser | null => {\n    if (!current) return null;\n    const sanitizedProfilePictureUrl = sanitizeProfilePictureUrl(current.profilePictureUrl);\n    return {\n      ...current,\n      profilePictureUrl: sanitizedProfilePictureUrl,\n    };\n  };\n\n  useEffect(() => {\n    // Initialize auth state\n    const initializeAuth = async () => {\n      try {\n        // Only run on client side\n        if (typeof window === 'undefined') {\n          setIsLoading(false);\n          return;\n        }\n        const currentUser = await authService.getCurrentUser();\n        const sanitizedUser = sanitizeUser(currentUser);\n        setUser(sanitizedUser);\n        \n        // Set Sentry user context\n        if (sanitizedUser) {\n          Sentry.setUser({\n            id: sanitizedUser.id.toString(),\n            email: sanitizedUser.email,\n          });\n        }\n      } catch (error) {\n        console.error('Failed to initialize auth:', error);\n        setUser(null);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    initializeAuth();\n\n    // Listen for auth state changes\n    const unsubscribe = authService.onAuthStateChange((user) => {\n      setUser(sanitizeUser(user));\n      setIsLoading(false);\n    });\n\n    return unsubscribe;\n  }, []);\n\n  const signUp = async (data: { email: string; password: string; name: string; phoneNumber: string; role: string }) => {\n    setIsLoading(true);\n    try {\n      const newUser = await authService.signUp(data);\n      const sanitized = sanitizeUser(newUser);\n      setUser(sanitized);\n      \n      // Set Sentry user context\n      if (sanitized) {\n        Sentry.setUser({\n          id: sanitized.id.toString(),\n          email: sanitized.email,\n        });\n      }\n      \n      return sanitized as AuthUser;\n    } catch (error) {\n      setUser(null);\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const signIn = async (data: { email: string; password: string }) => {\n    setIsLoading(true);\n    try {\n      const signedInUser = await authService.signIn(data);\n      const sanitized = sanitizeUser(signedInUser);\n      setUser(sanitized);\n      return sanitized as AuthUser;\n    } catch (error) {\n      setUser(null);\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const signOut = async () => {\n    setIsLoading(true);\n    try {\n      await authService.signOut();\n      setUser(null);\n      \n      // Clear Sentry user context\n      Sentry.setUser(null);\n    } catch (error) {\n      console.error('Sign out error:', error);\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const updateProfile = async (updates: Partial<AuthUser>) => {\n    if (!user) {\n      throw new Error('No authenticated user');\n    }\n\n    try {\n      const mergedUpdates = {\n        ...updates,\n        profilePictureUrl: sanitizeProfilePictureUrl(updates.profilePictureUrl ?? undefined),\n      };\n      const updatedUser = await authService.updateUserProfile(mergedUpdates);\n      const sanitized = sanitizeUser(updatedUser);\n      setUser(sanitized);\n      return sanitized as AuthUser;\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  const refreshTokens = async () => {\n    try {\n      await authService.refreshTokens();\n    } catch (error) {\n      console.error('Token refresh error:', error);\n      // If refresh fails, sign out the user\n      await signOut();\n      throw error;\n    }\n  };\n\n  const value: AuthContextType = {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n    signUp,\n    signIn,\n    signOut,\n    updateProfile,\n    refreshTokens,\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\n// Hook to use authentication context\nexport function useAuth(): AuthContextType {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n\n// Hook for authentication state\nexport function useAuthState() {\n  const { user, isLoading, isAuthenticated } = useAuth();\n  return { user, isLoading, isAuthenticated };\n}\n\n// Hook for authentication actions\nexport function useAuthActions() {\n  const { signUp, signIn, signOut, updateProfile, refreshTokens } = useAuth();\n  return { signUp, signIn, signOut, updateProfile, refreshTokens };\n}\n\n// Higher-order component for protected routes\ninterface ProtectedRouteProps {\n  children: ReactNode;\n  fallback?: ReactNode;\n  requireRole?: string;\n}\n\nexport function ProtectedRoute({ children, fallback, requireRole }: ProtectedRouteProps) {\n  const { user, isLoading, isAuthenticated } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return fallback || (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">\n            Authentication Required\n          </h2>\n          <p className=\"text-gray-600 dark:text-gray-400\">\n            Please sign in to access this page.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (requireRole && user?.role !== requireRole) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">\n            Access Denied\n          </h2>\n          <p className=\"text-gray-600 dark:text-gray-400\">\n            You don't have permission to access this page.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return <>{children}</>;\n}\n\n// Hook for role-based access control\nexport function useRoleAccess() {\n  const { user } = useAuth();\n\n  const hasRole = (role: string) => {\n    return user?.role === role;\n  };\n\n  const isEngineer = () => {\n    return user?.role === 'Engineer' || user?.role === 'Design Engineer' || user?.role === 'Electrical Eng' || user?.role === 'Mechanical Eng' || user?.role === 'Test Engineer';\n  };\n\n  const isProgramManager = () => {\n    return user?.role === 'Program Manager' || user?.role === 'Project Manager';\n  };\n\n  const canAccessProgramManagement = () => {\n    return isProgramManager();\n  };\n\n  const canManageWorkItems = () => {\n    return isEngineer() || isProgramManager();\n  };\n\n  return {\n    hasRole,\n    isEngineer,\n    isProgramManager,\n    canAccessProgramManagement,\n    canManageWorkItems,\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2441, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/components/Header/index.tsx"],"sourcesContent":["import React from 'react';\r\n\r\ntype Props = {\r\n    name: string;\r\n    buttonComponent?: any;\r\n    isSmallText?: boolean;\r\n};\r\n\r\nconst Header = ({ name, buttonComponent, isSmallText = false }: Props) => {\r\n  return (\r\n    <div className=\"mb-5 flex w-full items-center justify-between\">\r\n        <h1 className={`${isSmallText ? \"text-lg\" : \"text-2xl\"} font-semibold dark:text-white`}>\r\n            {name}\r\n        </h1>\r\n        {buttonComponent}\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default Header;"],"names":[],"mappings":";;;;;;AAQA,MAAM,SAAS,CAAC,EAAE,IAAI,EAAE,eAAe,EAAE,cAAc,KAAK,EAAS;IACnE,qBACE,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAG,WAAW,GAAG,cAAc,YAAY,WAAW,8BAA8B,CAAC;0BACjF;;;;;;YAEJ;;;;;;;AAGT;uCAEe","debugId":null}},
    {"offset": {"line": 2472, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/components/Modal/index.tsx"],"sourcesContent":["import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Header from '../Header';\r\nimport { X } from 'lucide-react';\r\n\r\ntype Props = {\r\n    children: React.ReactNode;\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    name: string;\r\n};\r\n\r\nconst Modal = ({\r\n    children,\r\n    isOpen,\r\n    onClose,\r\n    name\r\n}: Props) => {\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        ReactDOM.createPortal(\r\n            <div className=\"fixed inset-0 z-50 flex h-full w-full items-center justify-center overflow-y-auto bg-gray-600 bg-opacity-50 p-4\">\r\n                <div className=\"w-full max-w-2xl rounded-lg bg-white p-4 shadow-lg dark:bg-dark-secondary max-h-[85vh] overflow-y-auto\">\r\n                    <Header\r\n                        name={name}\r\n                        buttonComponent={\r\n                            <button\r\n                                className=\"flex h-7 w-7 items-center justify-center rounded-full bg-blue-primary text-white hover:bg-blue-600\"\r\n                                onClick={onClose}\r\n                            >\r\n                                <X size={18} />\r\n                            </button>\r\n                        }\r\n                        isSmallText\r\n                    />\r\n                    {children}\r\n                </div>\r\n            </div>,\r\n            document.body,\r\n        )\r\n    )\r\n};\r\n\r\nexport default Modal;"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;;;AASA,MAAM,QAAQ,CAAC,EACX,QAAQ,EACR,MAAM,EACN,OAAO,EACP,IAAI,EACA;IACJ,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACI,uNAAQ,CAAC,YAAY,eACjB,8OAAC;QAAI,WAAU;kBACX,cAAA,8OAAC;YAAI,WAAU;;8BACX,8OAAC,gJAAM;oBACH,MAAM;oBACN,+BACI,8OAAC;wBACG,WAAU;wBACV,SAAS;kCAET,cAAA,8OAAC,iMAAC;4BAAC,MAAM;;;;;;;;;;;oBAGjB,WAAW;;;;;;gBAEd;;;;;;;;;;;kDAGT,SAAS,IAAI;AAGzB;uCAEe","debugId":null}},
    {"offset": {"line": 2532, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/components/ModalFeedback/index.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState } from 'react';\r\nimport Modal from '../Modal';\r\nimport { useCreateFeedbackMutation, Priority } from '@/state/api';\r\n\r\ntype Props = {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n};\r\n\r\nconst ModalFeedback = ({ isOpen, onClose }: Props) => {\r\n    const [createFeedback, { isLoading }] = useCreateFeedbackMutation();\r\n    const [formData, setFormData] = useState({\r\n        type: 'bug' as 'bug' | 'feature' | 'improvement',\r\n        title: '',\r\n        description: '',\r\n        priority: Priority.Medium as Priority,\r\n    });\r\n    const [submitStatus, setSubmitStatus] = useState<'idle' | 'success' | 'error'>('idle');\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        \r\n        if (!formData.title.trim() || !formData.description.trim()) {\r\n            setSubmitStatus('error');\r\n            setTimeout(() => setSubmitStatus('idle'), 3000);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            await createFeedback({\r\n                type: formData.type,\r\n                title: formData.title.trim(),\r\n                description: formData.description.trim(),\r\n                priority: formData.priority,\r\n            }).unwrap();\r\n\r\n            setSubmitStatus('success');\r\n            // Reset form\r\n            setFormData({\r\n                type: 'bug',\r\n                title: '',\r\n                description: '',\r\n                priority: Priority.Medium,\r\n            });\r\n            \r\n            // Close modal after 2 seconds\r\n            setTimeout(() => {\r\n                onClose();\r\n                setSubmitStatus('idle');\r\n            }, 2000);\r\n        } catch (error) {\r\n            console.error('Failed to submit feedback:', error);\r\n            setSubmitStatus('error');\r\n            setTimeout(() => setSubmitStatus('idle'), 3000);\r\n        }\r\n    };\r\n\r\n    const handleClose = () => {\r\n        if (!isLoading) {\r\n            setFormData({\r\n                type: 'bug',\r\n                title: '',\r\n                description: '',\r\n                priority: Priority.Medium,\r\n            });\r\n            setSubmitStatus('idle');\r\n            onClose();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={handleClose} name=\"Submit Feedback\">\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                {/* Feedback Type */}\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                        Type\r\n                    </label>\r\n                    <select\r\n                        value={formData.type}\r\n                        onChange={(e) => setFormData({ ...formData, type: e.target.value as 'bug' | 'feature' | 'improvement' })}\r\n                        className=\"w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                        required\r\n                    >\r\n                        <option value=\"bug\"> Bug Report</option>\r\n                        <option value=\"feature\"> Feature Request</option>\r\n                        <option value=\"improvement\"> Improvement Suggestion</option>\r\n                    </select>\r\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                        {formData.type === 'bug' && 'Report a bug or issue you encountered'}\r\n                        {formData.type === 'feature' && 'Suggest a new feature you\\'d like to see'}\r\n                        {formData.type === 'improvement' && 'Suggest an improvement to existing functionality'}\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Priority */}\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                        Priority\r\n                    </label>\r\n                    <select\r\n                        value={formData.priority}\r\n                        onChange={(e) => setFormData({ ...formData, priority: e.target.value as Priority })}\r\n                        className=\"w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                        required\r\n                    >\r\n                        <option value={Priority.Urgent}> Urgent</option>\r\n                        <option value={Priority.High}> High</option>\r\n                        <option value={Priority.Medium}> Medium</option>\r\n                        <option value={Priority.Low}> Low</option>\r\n                        <option value={Priority.Backlog}> Backlog</option>\r\n                    </select>\r\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                        How important is this feedback to you?\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Title */}\r\n                <div>\r\n                    <label htmlFor=\"title\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                        Title <span className=\"text-red-500\">*</span>\r\n                    </label>\r\n                    <input\r\n                        id=\"title\"\r\n                        type=\"text\"\r\n                        value={formData.title}\r\n                        onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n                        className=\"w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                        placeholder=\"Brief summary of your feedback\"\r\n                        required\r\n                        maxLength={200}\r\n                    />\r\n                </div>\r\n\r\n                {/* Description */}\r\n                <div>\r\n                    <label htmlFor=\"description\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                        Description <span className=\"text-red-500\">*</span>\r\n                    </label>\r\n                    <textarea\r\n                        id=\"description\"\r\n                        value={formData.description}\r\n                        onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                        className=\"w-full border border-gray-300 rounded-md shadow-sm p-2 dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                        placeholder=\"Provide detailed information about your feedback...\"\r\n                        rows={6}\r\n                        required\r\n                        maxLength={2000}\r\n                    />\r\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                        {formData.description.length}/2000 characters\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Status Messages */}\r\n                {submitStatus === 'success' && (\r\n                    <div className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md p-4\">\r\n                        <div className=\"text-sm text-green-600 dark:text-green-400\">\r\n                             Feedback submitted successfully! Thank you for your input.\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {submitStatus === 'error' && (\r\n                    <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4\">\r\n                        <div className=\"text-sm text-red-600 dark:text-red-400\">\r\n                            Failed to submit feedback. Please try again.\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Submit Button */}\r\n                <div className=\"flex justify-end gap-3 pt-4\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={handleClose}\r\n                        disabled={isLoading}\r\n                        className=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 dark:text-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                    >\r\n                        Cancel\r\n                    </button>\r\n                    <button\r\n                        type=\"submit\"\r\n                        disabled={isLoading || !formData.title.trim() || !formData.description.trim()}\r\n                        className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                    >\r\n                        {isLoading ? (\r\n                            <div className=\"flex items-center\">\r\n                                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                                Submitting...\r\n                            </div>\r\n                        ) : (\r\n                            'Submit Feedback'\r\n                        )}\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default ModalFeedback;\r\n\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2945, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/components/Navbar/index.tsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { Menu, Moon, Search, Settings, Sun, LogOut, MessageSquare } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport Image from \"next/image\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useAppDispatch, useAppSelector } from \"@/app/redux\";\r\nimport { setIsDarkMode, setIsSidebarCollapsed } from \"@/state\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport ModalFeedback from \"@/components/ModalFeedback\";\r\n\r\n\r\nconst Navbar = () => {\r\n    const dispatch = useAppDispatch();\r\n    const router = useRouter();\r\n    const { signOut, user } = useAuth();\r\n    const isSidebarCollapsed = useAppSelector(\r\n        (state) => state.global.isSidebarCollapsed,\r\n    );\r\n    const isDarkMode = useAppSelector((state) => state.global.isDarkMode);\r\n    const [isFeedbackModalOpen, setIsFeedbackModalOpen] = useState(false);\r\n    const [searchTerm, setSearchTerm] = useState(\"\");\r\n\r\n    // Get user initials from username or name\r\n    const getUserInitials = () => {\r\n        if (user?.name) {\r\n            const names = user.name.split(' ');\r\n            if (names.length >= 2) {\r\n                return (names[0][0] + names[names.length - 1][0]).toUpperCase();\r\n            }\r\n            return user.name.substring(0, 2).toUpperCase();\r\n        }\r\n        if (user?.username) {\r\n            return user.username.substring(0, 2).toUpperCase();\r\n        }\r\n        return '?';\r\n    };\r\n\r\n    const sanitizeProfilePictureUrl = (value?: string | null) => {\r\n        if (!value) return \"\";\r\n        const trimmed = value.trim();\r\n        if (!trimmed) return \"\";\r\n        const lower = trimmed.toLowerCase();\r\n        if (lower.startsWith(\"http://\") || lower.startsWith(\"https://\")) {\r\n            return \"\";\r\n        }\r\n        return trimmed.startsWith(\"/\") ? trimmed : `/${trimmed}`;\r\n    };\r\n\r\n    const safeProfilePictureUrl = sanitizeProfilePictureUrl(user?.profilePictureUrl);\r\n\r\n    const handleLogout = async () => {\r\n        try {\r\n            // signOut() will redirect to server logout endpoint\r\n            // which handles session clearing and Cognito logout\r\n            await signOut();\r\n            // Don't call router.push here - signOut() handles the redirect\r\n        } catch (error) {\r\n            console.error('Logout error:', error);\r\n            // On error, still try to redirect to onboarding\r\n            router.push(\"/onboarding\");\r\n        }\r\n    };\r\n\r\n    const handleSearchSubmit = (e: React.FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n        if (searchTerm.trim()) {\r\n            router.push(`/search?q=${encodeURIComponent(searchTerm.trim())}`);\r\n        } else {\r\n            router.push(\"/search\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex items-center justify-between bg-white px-4 py-3 dark:bg-black\">\r\n            {/* Search Bar */}\r\n            <div className=\"flex items-center gap-8\">\r\n                {!isSidebarCollapsed ? null : (\r\n                <button\r\n                    onClick={() => dispatch(setIsSidebarCollapsed(!isSidebarCollapsed))}\r\n                >\r\n                    <Menu className=\"h-8 w-8 dark:text-white\" />\r\n                </button>\r\n                )}\r\n                <form onSubmit={handleSearchSubmit} className=\"relative flex h-min w-[200px]\">\r\n                    <Search className=\"absolute left-[4px] top-1/2 mr-2 h-5 w-5 -translate-y-1/2 transform cursor-pointer dark:text-white\" />\r\n                    <input\r\n                        className=\"w-full rounded border-none bg-gray-100 p-2 pl-8 placeholder-gray-500 focus:border-transparent focus:outline-none dark:bg-gray-700 dark:text-white dark:placeholder-white\"\r\n                        type=\"search\"\r\n                        placeholder=\"Search...\"\r\n                        value={searchTerm}\r\n                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                    />\r\n                </form>\r\n            </div>\r\n\r\n            {/* Icons */}\r\n            <div className=\"flex items-center\">\r\n                <button\r\n                    onClick={() => setIsFeedbackModalOpen(true)}\r\n                    className={\r\n                        isDarkMode\r\n                            ? `h-min w-min rounded p-2 dark:hover:bg-gray-700`\r\n                            : `h-min w-min rounded p-2 hover:bg-gray-100`\r\n                    }\r\n                    title=\"Submit Feedback\"\r\n                >\r\n                    <MessageSquare className=\"h-6 w-6 cursor-pointer dark:text-white\" />\r\n                </button>\r\n                <button\r\n                    onClick={() => dispatch(setIsDarkMode(!isDarkMode))}\r\n                    className={\r\n                        isDarkMode\r\n                            ? `rounded p-2 dark:hover:bg-gray-700`\r\n                            : `rounded p-2 hover:bg-gray-100`\r\n                    }\r\n                    title={isDarkMode ? \"Toggle Light Mode\" : \"Toggle Dark Mode\"}\r\n                >\r\n                    {isDarkMode ? (\r\n                        <Sun className=\"h-6 w-6 cursor-pointer dark:text-white\" />\r\n                    ) : (\r\n                        <Moon className=\"h-6 w-6 cursor-pointer dark:text-white\" />\r\n                    )}\r\n                </button>\r\n                <Link\r\n                    href=\"/settings\"\r\n                    className={\r\n                        isDarkMode\r\n                            ? `h-min w-min rounded p-2 dark:hover:bg-gray-700`\r\n                            : `h-min w-min rounded p-2 hover:bg-gray-100`\r\n                    }\r\n                    title=\"Settings\"\r\n                >\r\n                    <Settings className=\"h-6 w-6 cursor-pointer dark:text-white\" />\r\n                </Link>\r\n                \r\n                <div className=\"ml-2 mr-4 hidden min-h-[2em] w-[0.1rem] bg-gray-200 md:inline-block\"></div>\r\n                \r\n                {/* User Profile Picture/Initials */}\r\n                {user?.id && (\r\n                    <Link\r\n                        href={`/users/${user.id}`}\r\n                        className={\r\n                            isDarkMode\r\n                                ? `h-min w-min rounded-full dark:hover:bg-gray-700`\r\n                                : `h-min w-min rounded-full hover:bg-gray-100`\r\n                        }\r\n                        title=\"View Profile\"\r\n                    >\r\n                        {safeProfilePictureUrl ? (\r\n                            <div className=\"h-8 w-8 rounded-full overflow-hidden border-2 border-gray-200 dark:border-gray-600\">\r\n                                <Image\r\n                                    src={safeProfilePictureUrl ? `/images/${safeProfilePictureUrl}` : '/placeholder.png'}\r\n                                    alt={user.name || user.username}\r\n                                    width={32}\r\n                                    height={32}\r\n                                    className=\"h-full w-full object-cover\"\r\n                                />\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"flex h-8 w-8 items-center justify-center rounded-full bg-gray-300 text-sm font-medium text-gray-600 dark:bg-gray-700 dark:text-gray-300\">\r\n                                {getUserInitials()}\r\n                            </div>\r\n                        )}\r\n                    </Link>\r\n                )}\r\n                \r\n                <button\r\n                    onClick={handleLogout}\r\n                    className={\r\n                        isDarkMode\r\n                            ? `ml-2 h-min w-min rounded p-2 dark:hover:bg-gray-700`\r\n                            : `ml-2 h-min w-min rounded p-2 hover:bg-gray-100`\r\n                    }\r\n                    title=\"Logout\"\r\n                >\r\n                    <LogOut className=\"h-6 w-6 cursor-pointer dark:text-white\" />\r\n                </button>\r\n            </div>\r\n            \r\n            {/* Feedback Modal */}\r\n            <ModalFeedback \r\n                isOpen={isFeedbackModalOpen} \r\n                onClose={() => setIsFeedbackModalOpen(false)} \r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Navbar;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3222, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/components/Sidebar/index.tsx"],"sourcesContent":["\"use client\";\n\nimport { useAppDispatch, useAppSelector } from '@/app/redux';\nimport { setIsSidebarCollapsed } from '@/state';\nimport {\n    useGetProgramsQuery,\n    useGetPartsByUserQuery,\n    useGetUnreadFeedbackCountQuery\n} from '@/state/api';\nimport { useAuth } from '@/contexts/AuthContext';\nimport {\n    AlertTriangle,\n    Bolt,\n    Briefcase,\n    CheckSquare,\n    ChevronDown,\n    ChevronUp,\n    FileText,\n    Home,\n    LockIcon,\n    LucideIcon,\n    Mail,\n    MessageSquare,\n    Search,\n    Settings,\n    TreePine,\n    User,\n    Users,\n    X,\n} from 'lucide-react';\nimport Image from 'next/image';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nconst Sidebar = () => {\n    const [showPrograms, setShowPrograms] = useState(true);\n    const [showWorkItems, setShowWorkItems] = useState(true);\n    const [expandedPrograms, setExpandedPrograms] = useState<Record<number, boolean>>({});\n\n    const { data: programs } = useGetProgramsQuery();\n\n    const { user } = useAuth();\n    const userId = user?.id;\n    const { data: userParts } = useGetPartsByUserQuery(userId || \"\", { skip: !userId });\n\n    //  Group parts by programId for easy display\n    const partsByProgram = useMemo(() => {\n        if (!userParts) return {};\n        return userParts.reduce<Record<number, typeof userParts>>((acc, part) => {\n            (acc[part.programId] ||= []).push(part);\n            return acc;\n        }, {});\n    }, [userParts]);\n\n    //  Filter programs to only show those where the user has parts or belongs via discipline team\n    const filteredPrograms = useMemo(() => {\n        if (!programs) return [];\n\n        const programIdsFromParts = new Set(\n            (userParts ?? []).map((part) => part.programId)\n        );\n\n        if (programIdsFromParts.size > 0) {\n            return programs.filter((program) => programIdsFromParts.has(program.id));\n        }\n\n        if (!user?.disciplineTeamId) return [];\n\n        return programs.filter((program) =>\n            program.disciplineTeams?.some(\n                (dtp) => dtp.disciplineTeamId === user.disciplineTeamId\n            )\n        );\n    }, [programs, userParts, user?.disciplineTeamId]);\n\n    const pathname = usePathname();\n    const dispatch = useAppDispatch();\n    const isSidebarCollapsed = useAppSelector(\n        (state) => state.global.isSidebarCollapsed,\n    );\n\n    /* =========================\n        Restore expanded programs from localStorage\n    ========================== */\n    useEffect(() => {\n        const stored = localStorage.getItem(\"expandedPrograms\");\n        if (stored) {\n            setExpandedPrograms(JSON.parse(stored));\n        }\n    }, []);\n\n    /* =========================\n        Auto-expand the program for the active part\n    ========================== */\n    useEffect(() => {\n        if (userParts && pathname.startsWith(\"/parts/\")) {\n            const partId = Number(pathname.split(\"/parts/\")[1]);\n            const activePart = userParts.find((p) => p.id === partId);\n            if (activePart) {\n                setExpandedPrograms((prev) => {\n                    const updated = { ...prev, [activePart.programId]: true };\n                    localStorage.setItem(\"expandedPrograms\", JSON.stringify(updated));\n                    return updated;\n                });\n            }\n        }\n    }, [pathname, userParts]);\n\n    const sidebarClassNames = `fixed flex flex-col h-[100%] justify-between shadow-xl\n        transition-all duration-300 h-full z-40 dark:bg-black overflow-y-auto bg-white\n        ${isSidebarCollapsed ? \"w-0 hidden\" : \"w-64\"}\n    `;\n\n    return (\n        <div className={sidebarClassNames}>\n            <div className=\"flex h-[100%] w-full flex-col justify-start\">\n                {/* TOP LOGO */}\n                <div className=\"z-50 flex min-h-[56px] w-64 items-center justify-between bg-white px-6 pt-3 dark:bg-black\">\n                    <div className=\"text-xl font-bold text-gray-800 dark:text-white\">\n                        PARTIAL\n                    </div>\n                    {!isSidebarCollapsed && (\n                        <button\n                            className=\"py-3\"\n                            onClick={() =>\n                                dispatch(setIsSidebarCollapsed(!isSidebarCollapsed))\n                            }\n                        >\n                            <X className=\"h-6 w-6 text-gray-800 hover:text-gray-500 dark:text-white\" />\n                        </button>\n                    )}\n                </div>\n\n                {/* TEAM HEADER */}\n                <div className=\"flex items-center gap-5 border-y-[1.5px] border-gray-200 px-8 py-4 dark:border-gray-700\">\n                    <Image src=\"/logo1.png\" alt=\"Logo\" width={40} height={40} />\n                    <div>\n                        <h3 className=\"text-md font-bold tracking-wide dark:text-gray-200\">\n                            {user?.organizationName || \"Organization\"}\n                        </h3>\n                        <div className=\"mt-1 flex items-start gap-2\">\n                            <LockIcon className=\"mt-[0.1rem] h-3 w-3 text-gray-500 dark:text-gray-400\" />\n                            <p className=\"text-xs text-gray-500\">Private</p>\n                        </div>\n                    </div>\n                </div>\n\n                {/* NAVBAR LINKS */}\n                <nav className=\"z-10 w-full\">\n                    <SidebarLink icon={Home} label=\"Home\" href=\"/\" />\n                    <SidebarLink icon={Search} label=\"Search\" href=\"/search\" />\n                    <SidebarLink icon={Briefcase} label=\"Programs\" href=\"/programs\" />\n                    <SidebarLink icon={TreePine} label=\"Part Hierarchy\" href=\"/part-hierarchy\" />\n                    <SidebarLink icon={User} label=\"Users\" href=\"/users\" />\n                    <SidebarLink icon={Users} label=\"Teams\" href=\"/teams\" />\n                    {/* Show Invitations link only for roles that can create invitations */}\n                    {user?.role && ['Admin', 'Manager', 'Program Manager'].includes(user.role) && (\n                        <SidebarLink icon={Mail} label=\"Invitations\" href=\"/invitations\" />\n                    )}\n                    {/* Show Feedback link only for admins */}\n                    {user?.role === 'Admin' && (\n                        <FeedbackLinkWithBadge />\n                    )}\n                    <SidebarLink icon={Settings} label=\"Settings\" href=\"/settings\" />\n                </nav>\n\n                {/* ===== My Programs top-level toggle ===== */}\n                {filteredPrograms.length > 0 && (\n                    <>\n                        <button\n                            onClick={() => setShowPrograms((p) => !p)}\n                            className=\"flex w-full items-center justify-between px-8 py-3 text-gray-500\"\n                        >\n                            <span>My Parts</span>\n                            {showPrograms ? (\n                                <ChevronUp className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\n                            ) : (\n                                <ChevronDown className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\n                            )}\n                        </button>\n\n                        {/* ===== Collapsible list of programs ===== */}\n                        {showPrograms &&\n                            filteredPrograms?.map((program) => {\n                                const isOpen = expandedPrograms[program.id] ?? false;\n                                return (\n                                    <div key={program.id}>\n                                        {/* Program toggle */}\n                                        <button\n                                            onClick={() => {\n                                                setExpandedPrograms((prev) => {\n                                                    const newState = {\n                                                        ...prev,\n                                                        [program.id]: !isOpen,\n                                                    };\n                                                    localStorage.setItem(\n                                                        \"expandedPrograms\",\n                                                        JSON.stringify(newState)\n                                                    );\n                                                    return newState;\n                                                });\n                                            }}\n                                            className=\"flex w-full items-center justify-between px-8 py-3 text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-700\"\n                                        >\n                                            <span className=\"flex items-center gap-3\">\n                                                <Briefcase className=\"h-5 w-5 text-gray-700 dark:text-gray-200\" />\n                                                {program.name}\n                                            </span>\n                                            {isOpen ? (\n                                                <ChevronUp className=\"h-5 w-5 text-gray-700 dark:text-gray-200\" />\n                                            ) : (\n                                                <ChevronDown className=\"h-5 w-5 text-gray-700 dark:text-gray-200\" />\n                                            )}\n                                        </button>\n\n                                        {/* Users part codes for this program */}\n                                        {isOpen &&\n                                            partsByProgram[program.id]?.map((part) => (\n                                                <SidebarLink\n                                                    key={part.id}\n                                                    icon={Bolt}\n                                                    label={`${part.partName} (${part.code})`}\n                                                    href={`/parts/${part.id}`}\n                                                />\n                                            ))}\n                                    </div>\n                                );\n                            })}\n                    </>\n                )}\n\n                {/* WORK ITEMS LINKS */}\n                <button\n                    onClick={() => setShowWorkItems((prev) => !prev)}\n                    className=\"flex w-full items-center justify-between px-8 py-3 text-gray-500\"\n                >\n                    <span>Work Items</span>\n                    {showWorkItems ? (\n                        <ChevronUp className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\n                    ) : (\n                        <ChevronDown className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\n                    )}\n                </button>\n                {showWorkItems && (\n                    <>\n                        <SidebarLink icon={FileText} label=\"Deliverables\" href=\"/work-items/deliverables\" />\n                        <SidebarLink icon={AlertTriangle} label=\"Issues\" href=\"/work-items/issues\" />\n                        <SidebarLink icon={CheckSquare} label=\"Tasks\" href=\"/work-items/tasks\" />\n                    </>\n                )}\n\n            </div>\n        </div>\n    );\n};\n\ninterface SidebarLinkProps {\n    href: string;\n    icon: LucideIcon;\n    label: string;\n}\n\nconst SidebarLink = ({ href, icon: Icon, label }: SidebarLinkProps) => {\n    const pathname = usePathname();\n    const isActive =\n        pathname === href || (pathname === \"/\" && href === \"/dashboard\");\n\n    return (\n        <Link href={href} className=\"w-full\">\n            <div\n                className={`relative flex cursor-pointer items-center gap-3 transition-colors hover:bg-gray-100 dark:bg-black dark:hover:bg-gray-700 ${\n                    isActive ? \"bg-gray-100 text-white dark:bg-gray-600\" : \"\"\n                } justify-start px-8 py-3`}\n            >\n                {isActive && (\n                    <div className=\"absolute left-0 top-0 h-[100%] w-[5px] bg-blue-200\" />\n                )}\n                <Icon className=\"h-6 w-6 text-gray-800 dark:text-gray-100\" />\n                <span className={`font-medium text-gray-800 dark:text-gray-100`}>\n                    {label}\n                </span>\n            </div>\n        </Link>\n    );\n};\n\nconst FeedbackLinkWithBadge = () => {\n    const pathname = usePathname();\n    const isActive = pathname === \"/feedback\";\n    const { data: countData } = useGetUnreadFeedbackCountQuery(undefined, {\n        pollingInterval: 30000, // Poll every 30 seconds for updates\n    });\n    const unreadCount = countData?.count || 0;\n\n    return (\n        <Link href=\"/feedback\" className=\"w-full\">\n            <div\n                className={`relative flex cursor-pointer items-center gap-3 transition-colors hover:bg-gray-100 dark:bg-black dark:hover:bg-gray-700 ${\n                    isActive ? \"bg-gray-100 text-white dark:bg-gray-600\" : \"\"\n                } justify-start px-8 py-3`}\n            >\n                {isActive && (\n                    <div className=\"absolute left-0 top-0 h-[100%] w-[5px] bg-blue-200\" />\n                )}\n                <MessageSquare className=\"h-6 w-6 text-gray-800 dark:text-gray-100\" />\n                <span className={`font-medium text-gray-800 dark:text-gray-100 flex-1`}>\n                    Feedback\n                </span>\n                {unreadCount > 0 && (\n                    <span className=\"flex items-center justify-center min-w-[20px] h-5 px-1.5 rounded-full text-xs font-semibold bg-red-500 text-white\">\n                        {unreadCount > 99 ? '99+' : unreadCount}\n                    </span>\n                )}\n            </div>\n        </Link>\n    );\n};\n\nexport default Sidebar;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3798, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/lib/errorHandler.ts"],"sourcesContent":["/**\n * Global error handling utilities with Sentry integration\n */\n\nimport * as Sentry from \"@sentry/nextjs\";\n\nexport interface ErrorContext {\n  component?: string;\n  action?: string;\n  userId?: string | number;\n  additionalInfo?: Record<string, any>;\n}\n\n/**\n * Logs errors to console in development and Sentry in production\n */\nexport const logError = (\n  error: Error | unknown,\n  context?: ErrorContext\n): void => {\n  const errorMessage = error instanceof Error ? error.message : String(error);\n  const errorStack = error instanceof Error ? error.stack : undefined;\n\n  // In development, log to console\n  if (process.env.NODE_ENV === \"development\") {\n    console.error(\"Error logged:\", {\n      message: errorMessage,\n      stack: errorStack,\n      context,\n      timestamp: new Date().toISOString(),\n    });\n  }\n\n  // Send to Sentry with context\n  if (error instanceof Error) {\n    Sentry.withScope((scope) => {\n      if (context) {\n        if (context.component) {\n          scope.setTag(\"component\", context.component);\n        }\n        if (context.action) {\n          scope.setTag(\"action\", context.action);\n        }\n        if (context.userId) {\n          scope.setUser({ id: context.userId.toString() });\n        }\n        if (context.additionalInfo) {\n          scope.setContext(\"additionalInfo\", context.additionalInfo);\n        }\n      }\n      Sentry.captureException(error);\n    });\n  } else {\n    Sentry.captureMessage(String(error), \"error\");\n  }\n};\n\n/**\n * Creates a user-friendly error message from an error\n */\nexport const getUserFriendlyErrorMessage = (\n  error: Error | unknown,\n  defaultMessage: string = \"An unexpected error occurred\"\n): string => {\n  if (!(error instanceof Error)) {\n    return defaultMessage;\n  }\n\n  const errorMessage = error.message.toLowerCase();\n\n  // Network errors\n  if (\n    errorMessage.includes(\"network\") ||\n    errorMessage.includes(\"fetch\") ||\n    errorMessage.includes(\"connection\")\n  ) {\n    return \"Unable to connect to the server. Please check your internet connection and try again.\";\n  }\n\n  // Authentication errors\n  if (\n    errorMessage.includes(\"unauthorized\") ||\n    errorMessage.includes(\"authentication\") ||\n    errorMessage.includes(\"session expired\")\n  ) {\n    return \"Your session has expired. Please log in again.\";\n  }\n\n  // Permission errors\n  if (\n    errorMessage.includes(\"forbidden\") ||\n    errorMessage.includes(\"permission\") ||\n    errorMessage.includes(\"access denied\")\n  ) {\n    return \"You don't have permission to perform this action.\";\n  }\n\n  // Not found errors\n  if (\n    errorMessage.includes(\"not found\") ||\n    errorMessage.includes(\"404\")\n  ) {\n    return \"The requested resource was not found.\";\n  }\n\n  // Validation errors\n  if (\n    errorMessage.includes(\"validation\") ||\n    errorMessage.includes(\"invalid\") ||\n    errorMessage.includes(\"required\")\n  ) {\n    return \"Please check your input and try again.\";\n  }\n\n  // Server errors\n  if (\n    errorMessage.includes(\"500\") ||\n    errorMessage.includes(\"internal server error\")\n  ) {\n    return \"A server error occurred. Please try again later.\";\n  }\n\n  // Rate limiting\n  if (\n    errorMessage.includes(\"rate limit\") ||\n    errorMessage.includes(\"too many requests\")\n  ) {\n    return \"Too many requests. Please wait a moment and try again.\";\n  }\n\n  // Return the original message if it's user-friendly, otherwise return default\n  if (error.message && error.message.length < 100) {\n    return error.message;\n  }\n\n  return defaultMessage;\n};\n\n/**\n * Handles API errors and extracts user-friendly messages\n */\nexport const handleApiError = (\n  error: any,\n  defaultMessage: string = \"An error occurred\"\n): string => {\n  // Check for API error response structure\n  if (error?.data?.message) {\n    return getUserFriendlyErrorMessage(\n      new Error(error.data.message),\n      defaultMessage\n    );\n  }\n\n  if (error?.message) {\n    return getUserFriendlyErrorMessage(error, defaultMessage);\n  }\n\n  return defaultMessage;\n};\n\n/**\n * Wraps an async function with error handling\n */\nexport const withErrorHandling = <T extends (...args: any[]) => Promise<any>>(\n  fn: T,\n  context?: ErrorContext\n): T => {\n  return (async (...args: Parameters<T>) => {\n    try {\n      return await fn(...args);\n    } catch (error) {\n      logError(error, context);\n      throw error;\n    }\n  }) as T;\n};\n\n/**\n * Creates a safe error handler for event handlers\n */\nexport const createErrorHandler = (context?: ErrorContext) => {\n  return (error: Error | unknown) => {\n    logError(error, context);\n    const message = getUserFriendlyErrorMessage(error);\n    // You could also show a toast notification here\n    // showToast.error(message);\n    return message;\n  };\n};\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3923, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/components/ErrorBoundary/RouteErrorBoundary.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { ErrorBoundary } from \"react-error-boundary\";\r\nimport { useRouter, usePathname } from \"next/navigation\";\r\nimport { AlertTriangle, RefreshCw, Home } from \"lucide-react\";\r\nimport { logError } from \"@/lib/errorHandler\";\r\n\r\ninterface ErrorFallbackProps {\r\n  error: Error;\r\n  resetErrorBoundary: () => void;\r\n}\r\n\r\nconst RouteErrorFallback: React.FC<ErrorFallbackProps> = ({\r\n  error,\r\n  resetErrorBoundary,\r\n}) => {\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n  const isDevelopment = process.env.NODE_ENV === \"development\";\r\n\r\n  const handleGoHome = () => {\r\n    router.push(\"/home\");\r\n    resetErrorBoundary();\r\n  };\r\n\r\n  const handleReload = () => {\r\n    window.location.reload();\r\n  };\r\n\r\n  // Log error\r\n  React.useEffect(() => {\r\n    logError(error, {\r\n      component: \"RouteErrorBoundary\",\r\n      action: \"render\",\r\n      additionalInfo: { pathname },\r\n    });\r\n  }, [error, pathname]);\r\n\r\n  return (\r\n    <div className=\"min-h-[60vh] flex items-center justify-center p-4\">\r\n      <div className=\"max-w-xl w-full bg-white dark:bg-dark-secondary rounded-lg shadow-lg p-6\">\r\n        <div className=\"flex items-center mb-4\">\r\n          <AlertTriangle className=\"h-6 w-6 text-red-500 mr-2\" />\r\n          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">\r\n            Page Error\r\n          </h2>\r\n        </div>\r\n\r\n        <p className=\"text-gray-600 dark:text-gray-300 mb-4\">\r\n          This page encountered an error. You can try refreshing or return to the\r\n          home page.\r\n        </p>\r\n\r\n        {isDevelopment && (\r\n          <div className=\"mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded border border-red-200 dark:border-red-800\">\r\n            <p className=\"text-xs text-red-700 dark:text-red-300 font-mono\">\r\n              {error.message}\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"flex flex-col sm:flex-row gap-2\">\r\n          <button\r\n            onClick={resetErrorBoundary}\r\n            className=\"flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm\"\r\n          >\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            Try Again\r\n          </button>\r\n          <button\r\n            onClick={handleGoHome}\r\n            className=\"flex items-center justify-center px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors text-sm\"\r\n          >\r\n            <Home className=\"h-4 w-4 mr-2\" />\r\n            Go Home\r\n          </button>\r\n          <button\r\n            onClick={handleReload}\r\n            className=\"flex items-center justify-center px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors text-sm\"\r\n          >\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            Reload\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\ninterface RouteErrorBoundaryProps {\r\n  children: React.ReactNode;\r\n  fallback?: React.ComponentType<ErrorFallbackProps>;\r\n}\r\n\r\n/**\r\n * Error boundary for route-level errors\r\n * Uses react-error-boundary for better control and reset capabilities\r\n */\r\nexport const RouteErrorBoundary: React.FC<RouteErrorBoundaryProps> = ({\r\n  children,\r\n  fallback: Fallback = RouteErrorFallback,\r\n}) => {\r\n  const pathname = usePathname();\r\n\r\n  return (\r\n    <ErrorBoundary\r\n      FallbackComponent={Fallback}\r\n      onError={(error, errorInfo) => {\r\n        logError(error, {\r\n          component: \"RouteErrorBoundary\",\r\n          action: \"onError\",\r\n          additionalInfo: {\r\n            pathname,\r\n            componentStack: errorInfo.componentStack,\r\n          },\r\n        });\r\n      }}\r\n      resetKeys={[pathname]} // Reset when route changes\r\n      onReset={() => {\r\n        // Optional: scroll to top on reset\r\n        window.scrollTo(0, 0);\r\n      }}\r\n    >\r\n      {children}\r\n    </ErrorBoundary>\r\n  );\r\n};\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AACA;AANA;;;;;;;AAaA,MAAM,qBAAmD,CAAC,EACxD,KAAK,EACL,kBAAkB,EACnB;IACC,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,WAAW,IAAA,iJAAW;IAC5B,MAAM,gBAAgB,oDAAyB;IAE/C,MAAM,eAAe;QACnB,OAAO,IAAI,CAAC;QACZ;IACF;IAEA,MAAM,eAAe;QACnB,OAAO,QAAQ,CAAC,MAAM;IACxB;IAEA,YAAY;IACZ,gNAAK,CAAC,SAAS,CAAC;QACd,IAAA,sIAAQ,EAAC,OAAO;YACd,WAAW;YACX,QAAQ;YACR,gBAAgB;gBAAE;YAAS;QAC7B;IACF,GAAG;QAAC;QAAO;KAAS;IAEpB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,yOAAa;4BAAC,WAAU;;;;;;sCACzB,8OAAC;4BAAG,WAAU;sCAAsD;;;;;;;;;;;;8BAKtE,8OAAC;oBAAE,WAAU;8BAAwC;;;;;;gBAKpD,+BACC,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAE,WAAU;kCACV,MAAM,OAAO;;;;;;;;;;;8BAKpB,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BACC,SAAS;4BACT,WAAU;;8CAEV,8OAAC,6NAAS;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;sCAGxC,8OAAC;4BACC,SAAS;4BACT,WAAU;;8CAEV,8OAAC,2MAAI;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;sCAGnC,8OAAC;4BACC,SAAS;4BACT,WAAU;;8CAEV,8OAAC,6NAAS;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;;;;;;;;;;;;;;;;;;AAOlD;AAWO,MAAM,qBAAwD,CAAC,EACpE,QAAQ,EACR,UAAU,WAAW,kBAAkB,EACxC;IACC,MAAM,WAAW,IAAA,iJAAW;IAE5B,qBACE,8OAAC,iMAAa;QACZ,mBAAmB;QACnB,SAAS,CAAC,OAAO;YACf,IAAA,sIAAQ,EAAC,OAAO;gBACd,WAAW;gBACX,QAAQ;gBACR,gBAAgB;oBACd;oBACA,gBAAgB,UAAU,cAAc;gBAC1C;YACF;QACF;QACA,WAAW;YAAC;SAAS;QACrB,SAAS;YACP,mCAAmC;YACnC,OAAO,QAAQ,CAAC,GAAG;QACrB;kBAEC;;;;;;AAGP","debugId":null}},
    {"offset": {"line": 4125, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/app/dashboardWrapper.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { usePathname, useRouter } from \"next/navigation\";\r\nimport Navbar from \"@/components/Navbar\";\r\nimport Sidebar from \"@/components/Sidebar\";\r\nimport StoreProvider, { useAppSelector } from \"./redux\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { RouteErrorBoundary } from \"@/components/ErrorBoundary/RouteErrorBoundary\";\r\n\r\nconst DashboardLayout = ({ children }: { children: React.ReactNode }) => {\r\n  const isSidebarCollapsed = useAppSelector(\r\n    (state) => state.global.isSidebarCollapsed,\r\n  );\r\n  const isDarkMode = useAppSelector((state) => state.global.isDarkMode);\r\n\r\n  useEffect(() => {\r\n    if (isDarkMode) {\r\n      document.documentElement.classList.add(\"dark\");\r\n    } else {\r\n      document.documentElement.classList.remove(\"dark\");\r\n    }\r\n  });\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen w-full bg-gray-50 text-gray-900\">\r\n      <Sidebar />\r\n      <main\r\n        className={`flex w-full flex-col bg-gray-50 dark:bg-dark-bg ${\r\n          isSidebarCollapsed ? \"\" : \"md:pl-64\"\r\n        }`}\r\n      >\r\n        <Navbar />\r\n        {children}\r\n      </main>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst DashboardWrapper = ({ children }: { children: React.ReactNode }) => {\r\n  const pathname = usePathname();\r\n  const { isAuthenticated, isLoading } = useAuth();\r\n  const [isOnboarding, setIsOnboarding] = useState(false);\r\n  const router = useRouter();\r\n\r\n  // All hooks must be called unconditionally (Rules of Hooks)\r\n  useEffect(() => {\r\n    // Check if current path is onboarding or auth routes\r\n    setIsOnboarding(pathname === \"/onboarding\" || pathname.startsWith(\"/auth/\"));\r\n  }, [pathname]);\r\n\r\n  // Public routes that don't require authentication\r\n  const publicRoutes = [\"/onboarding\", \"/auth/login\", \"/debug-sentry\"];\r\n  const isPublicRoute = publicRoutes.includes(pathname) || pathname.startsWith(\"/auth/\");\r\n\r\n  // Redirect unauthenticated users to onboarding (except for public routes)\r\n  useEffect(() => {\r\n    if (!isLoading && !isAuthenticated && !isPublicRoute) {\r\n      router.push(\"/onboarding\");\r\n    }\r\n  }, [isAuthenticated, isLoading, pathname, router, isPublicRoute]);\r\n\r\n  // Show loading spinner while checking authentication\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // If not authenticated and not on a public route, show loading while redirecting\r\n  if (!isAuthenticated && !isPublicRoute) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <StoreProvider>\r\n      <RouteErrorBoundary>\r\n        {isOnboarding || isPublicRoute ? (\r\n          // For onboarding and auth routes, render without dashboard layout\r\n          <div className=\"min-h-screen\">\r\n            {children}\r\n          </div>\r\n        ) : (\r\n          // For all other pages, use dashboard layout (only if authenticated)\r\n          isAuthenticated ? (\r\n            <DashboardLayout>{children}</DashboardLayout>\r\n          ) : (\r\n            // Fallback: show loading while redirecting\r\n            <div className=\"min-h-screen flex items-center justify-center\">\r\n              <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\r\n            </div>\r\n          )\r\n        )}\r\n      </RouteErrorBoundary>\r\n    </StoreProvider>\r\n  );\r\n};\r\n\r\nexport default DashboardWrapper;"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;AAUA,MAAM,kBAAkB,CAAC,EAAE,QAAQ,EAAiC;IAClE,MAAM,qBAAqB,IAAA,sIAAc,EACvC,CAAC,QAAU,MAAM,MAAM,CAAC,kBAAkB;IAE5C,MAAM,aAAa,IAAA,sIAAc,EAAC,CAAC,QAAU,MAAM,MAAM,CAAC,UAAU;IAEpE,IAAA,kNAAS,EAAC;QACR,IAAI,YAAY;YACd,SAAS,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC;QACzC,OAAO;YACL,SAAS,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC;QAC5C;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,iJAAO;;;;;0BACR,8OAAC;gBACC,WAAW,CAAC,gDAAgD,EAC1D,qBAAqB,KAAK,YAC1B;;kCAEF,8OAAC,gJAAM;;;;;oBACN;;;;;;;;;;;;;AAIT;AAEA,MAAM,mBAAmB,CAAC,EAAE,QAAQ,EAAiC;IACnE,MAAM,WAAW,IAAA,iJAAW;IAC5B,MAAM,EAAE,eAAe,EAAE,SAAS,EAAE,GAAG,IAAA,0IAAO;IAC9C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,SAAS,IAAA,+IAAS;IAExB,4DAA4D;IAC5D,IAAA,kNAAS,EAAC;QACR,qDAAqD;QACrD,gBAAgB,aAAa,iBAAiB,SAAS,UAAU,CAAC;IACpE,GAAG;QAAC;KAAS;IAEb,kDAAkD;IAClD,MAAM,eAAe;QAAC;QAAe;QAAe;KAAgB;IACpE,MAAM,gBAAgB,aAAa,QAAQ,CAAC,aAAa,SAAS,UAAU,CAAC;IAE7E,0EAA0E;IAC1E,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,aAAa,CAAC,mBAAmB,CAAC,eAAe;YACpD,OAAO,IAAI,CAAC;QACd;IACF,GAAG;QAAC;QAAiB;QAAW;QAAU;QAAQ;KAAc;IAEhE,qDAAqD;IACrD,IAAI,WAAW;QACb,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;;;;;;;;;;IAGrB;IAEA,iFAAiF;IACjF,IAAI,CAAC,mBAAmB,CAAC,eAAe;QACtC,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;;;;;;;;;;IAGrB;IAEA,qBACE,8OAAC,+HAAa;kBACZ,cAAA,8OAAC,+KAAkB;sBAChB,gBAAgB,gBACf,kEAAkE;0BAClE,8OAAC;gBAAI,WAAU;0BACZ;;;;;2DAGH,oEAAoE;YACpE,gCACE,8OAAC;0BAAiB;;;;;2DAElB,2CAA2C;0BAC3C,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;;;;;;;;;;;;;;;;;;;;AAO7B;uCAEe","debugId":null}},
    {"offset": {"line": 4299, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/components/ErrorBoundary/index.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { Component, ErrorInfo, ReactNode } from \"react\";\nimport { AlertTriangle, RefreshCw, Home, X } from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport * as Sentry from \"@sentry/nextjs\";\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\n  resetKeys?: Array<string | number>;\n  resetOnPropsChange?: boolean;\n}\n\ninterface State {\n  hasError: boolean;\n  error: Error | null;\n  errorInfo: ErrorInfo | null;\n}\n\nclass ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      hasError: false,\n      error: null,\n      errorInfo: null,\n    };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return {\n      hasError: true,\n      error,\n      errorInfo: null,\n    };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    // Log error to console in development\n    if (process.env.NODE_ENV === \"development\") {\n      console.error(\"ErrorBoundary caught an error:\", error, errorInfo);\n    }\n\n    // Send to Sentry with component stack\n    Sentry.withScope((scope) => {\n      scope.setContext(\"reactErrorBoundary\", {\n        componentStack: errorInfo.componentStack,\n      });\n      scope.setTag(\"errorBoundary\", \"true\");\n      Sentry.captureException(error);\n    });\n\n    // Call custom error handler if provided\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo);\n    }\n\n    // Update state with error info\n    this.setState({\n      error,\n      errorInfo,\n    });\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    // Reset error boundary when resetKeys change\n    if (this.props.resetKeys && this.props.resetOnPropsChange) {\n      const hasResetKeyChanged = this.props.resetKeys.some(\n        (key, index) => key !== prevProps.resetKeys?.[index]\n      );\n      if (hasResetKeyChanged && this.state.hasError) {\n        this.resetErrorBoundary();\n      }\n    }\n  }\n\n  resetErrorBoundary = () => {\n    this.setState({\n      hasError: false,\n      error: null,\n      errorInfo: null,\n    });\n  };\n\n  render() {\n    if (this.state.hasError) {\n      // Use custom fallback if provided\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      // Default error UI\n      return (\n        <ErrorFallback\n          error={this.state.error}\n          errorInfo={this.state.errorInfo}\n          onReset={this.resetErrorBoundary}\n        />\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\ninterface ErrorFallbackProps {\n  error: Error | null;\n  errorInfo: ErrorInfo | null;\n  onReset: () => void;\n}\n\nconst ErrorFallback: React.FC<ErrorFallbackProps> = ({\n  error,\n  errorInfo,\n  onReset,\n}) => {\n  const router = useRouter();\n  const isDevelopment = process.env.NODE_ENV === \"development\";\n\n  const handleGoHome = () => {\n    router.push(\"/home\");\n    onReset();\n  };\n\n  const handleReload = () => {\n    window.location.reload();\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-black p-4\">\n      <div className=\"max-w-2xl w-full bg-white dark:bg-dark-secondary rounded-lg shadow-lg p-8\">\n        <div className=\"flex items-center mb-4\">\n          <AlertTriangle className=\"h-8 w-8 text-red-500 mr-3\" />\n          <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n            Something went wrong\n          </h1>\n        </div>\n\n        <p className=\"text-gray-600 dark:text-gray-300 mb-6\">\n          We're sorry, but something unexpected happened. Don't worry, your data\n          is safe. You can try refreshing the page or return to the home page.\n        </p>\n\n        {isDevelopment && error && (\n          <div className=\"mb-6 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <h3 className=\"text-sm font-semibold text-red-800 dark:text-red-200\">\n                Error Details (Development Only)\n              </h3>\n            </div>\n            <pre className=\"text-xs text-red-700 dark:text-red-300 overflow-auto max-h-48\">\n              {error.toString()}\n              {errorInfo?.componentStack && (\n                <>\n                  {\"\\n\\nComponent Stack:\"}\n                  {errorInfo.componentStack}\n                </>\n              )}\n            </pre>\n          </div>\n        )}\n\n        <div className=\"flex flex-col sm:flex-row gap-3\">\n          <button\n            onClick={onReset}\n            className=\"flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n          >\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Try Again\n          </button>\n          <button\n            onClick={handleGoHome}\n            className=\"flex items-center justify-center px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors\"\n          >\n            <Home className=\"h-4 w-4 mr-2\" />\n            Go to Home\n          </button>\n          <button\n            onClick={handleReload}\n            className=\"flex items-center justify-center px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors\"\n          >\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Reload Page\n          </button>\n        </div>\n\n        {!isDevelopment && (\n          <p className=\"mt-6 text-sm text-gray-500 dark:text-gray-400 text-center\">\n            If this problem persists, please contact support with the error code:{\" \"}\n            <code className=\"bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded\">\n              {error?.name || \"UNKNOWN\"}\n            </code>\n          </p>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default ErrorBoundary;\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4577, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/lib/toast.ts"],"sourcesContent":["import toast from \"react-hot-toast\";\r\nimport { getUserFriendlyErrorMessage, handleApiError, logError } from \"./errorHandler\";\r\n\r\n/**\r\n * Toast notification utilities for consistent messaging across the app\r\n */\r\n\r\nexport const showToast = {\r\n  /**\r\n   * Show a success toast notification\r\n   */\r\n  success: (message: string, duration: number = 4000) => {\r\n    toast.success(message, { duration });\r\n  },\r\n\r\n  /**\r\n   * Show an error toast notification\r\n   */\r\n  error: (message: string, duration: number = 5000) => {\r\n    toast.error(message, { duration });\r\n  },\r\n\r\n  /**\r\n   * Show a warning toast notification\r\n   */\r\n  warning: (message: string, duration: number = 4000) => {\r\n    toast(message, {\r\n      icon: \"\",\r\n      duration,\r\n      style: {\r\n        background: \"#fbbf24\",\r\n        color: \"#fff\",\r\n      },\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Show an info toast notification\r\n   */\r\n  info: (message: string, duration: number = 4000) => {\r\n    toast(message, {\r\n      icon: \"\",\r\n      duration,\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Show a loading toast notification\r\n   * Returns a function to update the toast (success/error)\r\n   */\r\n  loading: (message: string) => {\r\n    return toast.loading(message);\r\n  },\r\n\r\n  /**\r\n   * Dismiss a specific toast\r\n   */\r\n  dismiss: (toastId: string) => {\r\n    toast.dismiss(toastId);\r\n  },\r\n\r\n  /**\r\n   * Dismiss all toasts\r\n   */\r\n  dismissAll: () => {\r\n    toast.dismiss();\r\n  },\r\n};\r\n\r\n/**\r\n * Helper to show error from API response with user-friendly messages\r\n */\r\nexport const showApiError = (error: any, defaultMessage: string = \"An error occurred\") => {\r\n  // Log the error for debugging\r\n  logError(error, {\r\n    component: \"showApiError\",\r\n    action: \"display_error\",\r\n  });\r\n\r\n  // Get user-friendly error message\r\n  const message = handleApiError(error, defaultMessage);\r\n  showToast.error(message);\r\n};\r\n\r\n/**\r\n * Helper to show success message after API operation\r\n */\r\nexport const showApiSuccess = (message: string) => {\r\n  showToast.success(message);\r\n};\r\n\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAMO,MAAM,YAAY;IACvB;;GAEC,GACD,SAAS,CAAC,SAAiB,WAAmB,IAAI;QAChD,kKAAK,CAAC,OAAO,CAAC,SAAS;YAAE;QAAS;IACpC;IAEA;;GAEC,GACD,OAAO,CAAC,SAAiB,WAAmB,IAAI;QAC9C,kKAAK,CAAC,KAAK,CAAC,SAAS;YAAE;QAAS;IAClC;IAEA;;GAEC,GACD,SAAS,CAAC,SAAiB,WAAmB,IAAI;QAChD,IAAA,kKAAK,EAAC,SAAS;YACb,MAAM;YACN;YACA,OAAO;gBACL,YAAY;gBACZ,OAAO;YACT;QACF;IACF;IAEA;;GAEC,GACD,MAAM,CAAC,SAAiB,WAAmB,IAAI;QAC7C,IAAA,kKAAK,EAAC,SAAS;YACb,MAAM;YACN;QACF;IACF;IAEA;;;GAGC,GACD,SAAS,CAAC;QACR,OAAO,kKAAK,CAAC,OAAO,CAAC;IACvB;IAEA;;GAEC,GACD,SAAS,CAAC;QACR,kKAAK,CAAC,OAAO,CAAC;IAChB;IAEA;;GAEC,GACD,YAAY;QACV,kKAAK,CAAC,OAAO;IACf;AACF;AAKO,MAAM,eAAe,CAAC,OAAY,iBAAyB,mBAAmB;IACnF,8BAA8B;IAC9B,IAAA,sIAAQ,EAAC,OAAO;QACd,WAAW;QACX,QAAQ;IACV;IAEA,kCAAkC;IAClC,MAAM,UAAU,IAAA,4IAAc,EAAC,OAAO;IACtC,UAAU,KAAK,CAAC;AAClB;AAKO,MAAM,iBAAiB,CAAC;IAC7B,UAAU,OAAO,CAAC;AACpB","debugId":null}},
    {"offset": {"line": 4658, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/lib/globalErrorHandler.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport { logError } from \"./errorHandler\";\r\nimport { showToast } from \"./toast\";\r\n\r\n/**\r\n * Sets up global error handlers for unhandled errors and promise rejections\r\n * Should be called once in the app initialization\r\n */\r\nexport const setupGlobalErrorHandlers = () => {\r\n  // Handle unhandled JavaScript errors\r\n  if (typeof window !== \"undefined\") {\r\n    const originalErrorHandler = window.onerror;\r\n    window.onerror = (\r\n      message: string | Event,\r\n      source?: string,\r\n      lineno?: number,\r\n      colno?: number,\r\n      error?: Error\r\n    ) => {\r\n      // Call original handler if it exists\r\n      if (originalErrorHandler) {\r\n        originalErrorHandler(message, source, lineno, colno, error);\r\n      }\r\n\r\n      // Log the error\r\n      const errorObj = error || new Error(String(message));\r\n      logError(errorObj, {\r\n        component: \"GlobalErrorHandler\",\r\n        action: \"window.onerror\",\r\n        additionalInfo: {\r\n          source,\r\n          lineno,\r\n          colno,\r\n          message: String(message),\r\n        },\r\n      });\r\n\r\n      // Show user-friendly error message (only for unexpected errors)\r\n      if (error && !error.message.includes(\"Script error\")) {\r\n        showToast.error(\r\n          \"An unexpected error occurred. Please refresh the page if the problem persists.\"\r\n        );\r\n      }\r\n\r\n      // Return false to prevent default browser error handling\r\n      return false;\r\n    };\r\n\r\n    // Handle unhandled promise rejections\r\n    const originalUnhandledRejection = window.onunhandledrejection;\r\n    window.onunhandledrejection = (event: PromiseRejectionEvent) => {\r\n      // Call original handler if it exists\r\n      if (originalUnhandledRejection) {\r\n        originalUnhandledRejection(event);\r\n      }\r\n\r\n      // Log the error\r\n      const error =\r\n        event.reason instanceof Error\r\n          ? event.reason\r\n          : new Error(String(event.reason));\r\n      logError(error, {\r\n        component: \"GlobalErrorHandler\",\r\n        action: \"unhandledrejection\",\r\n        additionalInfo: {\r\n          reason: event.reason,\r\n        },\r\n      });\r\n\r\n      // Show user-friendly error message\r\n      showToast.error(\r\n        \"An operation failed unexpectedly. Please try again or refresh the page.\"\r\n      );\r\n\r\n      // Prevent default browser error handling\r\n      event.preventDefault();\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Removes global error handlers (useful for cleanup in tests)\r\n */\r\nexport const removeGlobalErrorHandlers = () => {\r\n  if (typeof window !== \"undefined\") {\r\n    window.onerror = null;\r\n    window.onunhandledrejection = null;\r\n  }\r\n};\r\n\r\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AAHA;;;AASO,MAAM,2BAA2B;IACtC,qCAAqC;IACrC;;AAoEF;AAKO,MAAM,4BAA4B;IACvC;;AAIF","debugId":null}},
    {"offset": {"line": 4682, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/components/ErrorBoundary/GlobalErrorHandler.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport { setupGlobalErrorHandlers, removeGlobalErrorHandlers } from \"@/lib/globalErrorHandler\";\r\n\r\n/**\r\n * Component that sets up global error handlers on mount\r\n * Should be placed high in the component tree (e.g., in root layout)\r\n */\r\nexport const GlobalErrorHandlerSetup = () => {\r\n  useEffect(() => {\r\n    // Setup global error handlers\r\n    setupGlobalErrorHandlers();\r\n\r\n    // Cleanup on unmount\r\n    return () => {\r\n      removeGlobalErrorHandlers();\r\n    };\r\n  }, []);\r\n\r\n  // This component doesn't render anything\r\n  return null;\r\n};\r\n\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AASO,MAAM,0BAA0B;IACrC,IAAA,kNAAS,EAAC;QACR,8BAA8B;QAC9B,IAAA,4JAAwB;QAExB,qBAAqB;QACrB,OAAO;YACL,IAAA,6JAAyB;QAC3B;IACF,GAAG,EAAE;IAEL,yCAAyC;IACzC,OAAO;AACT","debugId":null}}]
}