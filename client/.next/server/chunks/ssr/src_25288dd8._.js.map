{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/lib/passwordValidation.ts"],"sourcesContent":["/**\r\n * Password validation utility\r\n * Extracted from cognito.ts for use without AWS dependencies\r\n */\r\n\r\nexport const passwordPolicy = {\r\n  minLength: 8,\r\n  requireUppercase: true,\r\n  requireLowercase: true,\r\n  requireNumbers: true,\r\n  requireSymbols: true,\r\n};\r\n\r\n/**\r\n * Validate password against policy\r\n */\r\nexport function validatePassword(password: string): { isValid: boolean; errors: string[] } {\r\n  const errors: string[] = [];\r\n\r\n  if (password.length < passwordPolicy.minLength) {\r\n    errors.push(`Password must be at least ${passwordPolicy.minLength} characters long`);\r\n  }\r\n\r\n  if (passwordPolicy.requireUppercase && !/[A-Z]/.test(password)) {\r\n    errors.push('Password must contain at least one uppercase letter');\r\n  }\r\n\r\n  if (passwordPolicy.requireLowercase && !/[a-z]/.test(password)) {\r\n    errors.push('Password must contain at least one lowercase letter');\r\n  }\r\n\r\n  if (passwordPolicy.requireNumbers && !/\\d/.test(password)) {\r\n    errors.push('Password must contain at least one number');\r\n  }\r\n\r\n  if (passwordPolicy.requireSymbols && !/[!@#$%^&*(),.?\":{}|<>]/.test(password)) {\r\n    errors.push('Password must contain at least one special character');\r\n  }\r\n\r\n  return {\r\n    isValid: errors.length === 0,\r\n    errors,\r\n  };\r\n}\r\n\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAEM,MAAM,iBAAiB;IAC5B,WAAW;IACX,kBAAkB;IAClB,kBAAkB;IAClB,gBAAgB;IAChB,gBAAgB;AAClB;AAKO,SAAS,iBAAiB,QAAgB;IAC/C,MAAM,SAAmB,EAAE;IAE3B,IAAI,SAAS,MAAM,GAAG,eAAe,SAAS,EAAE;QAC9C,OAAO,IAAI,CAAC,CAAC,0BAA0B,EAAE,eAAe,SAAS,CAAC,gBAAgB,CAAC;IACrF;IAEA,IAAI,eAAe,gBAAgB,IAAI,CAAC,QAAQ,IAAI,CAAC,WAAW;QAC9D,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,eAAe,gBAAgB,IAAI,CAAC,QAAQ,IAAI,CAAC,WAAW;QAC9D,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,eAAe,cAAc,IAAI,CAAC,KAAK,IAAI,CAAC,WAAW;QACzD,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,eAAe,cAAc,IAAI,CAAC,yBAAyB,IAAI,CAAC,WAAW;QAC7E,OAAO,IAAI,CAAC;IACd;IAEA,OAAO;QACL,SAAS,OAAO,MAAM,KAAK;QAC3B;IACF;AACF","debugId":null}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/frude/Documents/startup/Partial/code/client/src/app/onboarding/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport Image from \"next/image\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { validatePassword } from \"@/lib/passwordValidation\";\r\nimport type { Program, Milestone } from \"@/state/api\";\r\nimport type { AuthUser } from \"@/lib/auth\";\r\nimport { showApiError } from \"@/lib/toast\";\r\nimport {\r\n  useGetTeamsQuery,\r\n  useCreateTeamMutation,\r\n  useGetProgramsQuery,\r\n  useCreateProgramMutation,\r\n  useCreateMilestoneMutation,\r\n  useCreatePartMutation,\r\n  useValidateInvitationQuery,\r\n  PartState,\r\n  PartStateLabels,\r\n} from \"@/state/api\";\r\nimport { addDays, formatISO } from \"date-fns\";\r\nimport Footer from \"@/components/Footer\";\r\n\r\n// Helper function to convert role to display name\r\n// Handles both Prisma enum values (e.g., \"ProgramManager\") and display names (e.g., \"Program Manager\")\r\nconst getRoleDisplayName = (role: string): string => {\r\n  // Handle Prisma enum values (no spaces)\r\n  if (role === \"ProgramManager\") return \"Program Manager\";\r\n  if (role === \"Admin\") return \"Admin\";\r\n  if (role === \"Manager\") return \"Manager\";\r\n  if (role === \"Engineer\") return \"Engineer\";\r\n  if (role === \"Viewer\") return \"Viewer\";\r\n  \r\n  // Handle display names (already formatted)\r\n  if (role === \"Program Manager\") return \"Program Manager\";\r\n  \r\n  // Handle lowercase variants\r\n  const roleLower = role.toLowerCase();\r\n  if (roleLower === \"programmanager\" || roleLower === \"program_manager\") return \"Program Manager\";\r\n  if (roleLower === \"admin\") return \"Admin\";\r\n  if (roleLower === \"manager\") return \"Manager\";\r\n  if (roleLower === \"engineer\") return \"Engineer\";\r\n  if (roleLower === \"viewer\") return \"Viewer\";\r\n  \r\n  // Default fallback - return the role as-is (capitalized)\r\n  return role.charAt(0).toUpperCase() + role.slice(1);\r\n};\r\n\r\nconst STEP_STORAGE_KEY = \"onboardingStep\";\r\n\r\n// Onboarding Step Components\r\nconst LandingScreen = ({ onGetStarted, onLogin, onLearnMore }: {\r\n  onGetStarted: () => void;\r\n  onLogin: () => void;\r\n  onLearnMore: () => void;\r\n}) => {\r\n  return (\r\n    <div className=\"min-h-screen bg-white dark:bg-gray-900\">\r\n      {/* Hero Section - Answers \"What is this?\" */}\r\n      <section className=\"relative overflow-hidden bg-gradient-to-br from-blue-50 via-white to-indigo-50 dark:from-gray-900 dark:via-gray-900 dark:to-gray-800\">\r\n        <div className=\"container mx-auto px-4 py-20 lg:py-28\">\r\n          <div className=\"max-w-7xl mx-auto\">\r\n            <div className=\"grid lg:grid-cols-2 gap-12 items-center\">\r\n              {/* Left Column - Text Content */}\r\n              <div className=\"text-center lg:text-left\">\r\n                <div className=\"mb-6 flex justify-center lg:justify-start\">\r\n                  <Image\r\n                    src=\"/logo1.png\"\r\n                    alt=\"Partial Logo\"\r\n                    width={100}\r\n                    height={100}\r\n                    className=\"dark:brightness-0 dark:invert\"\r\n                  />\r\n                </div>\r\n                <h1 className=\"text-5xl md:text-6xl lg:text-7xl font-bold text-gray-900 dark:text-white mb-6 leading-tight\">\r\n                  Work Management\r\n                  <span className=\"block text-blue-600 dark:text-blue-400\">Built for Hardware</span>\r\n                </h1>\r\n                <p className=\"text-xl md:text-2xl text-gray-600 dark:text-gray-300 mb-8 leading-relaxed max-w-2xl mx-auto lg:mx-0\">\r\n                  Track work items directly to physical parts. Monitor program health. \r\n                  Built specifically for hardware engineering teams who need more than software-focused tools.\r\n                </p>\r\n                \r\n                {/* CTA Buttons */}\r\n                <div className=\"flex flex-col sm:flex-row gap-4 justify-center lg:justify-start mb-8\">\r\n                  <button\r\n                    onClick={onGetStarted}\r\n                    className=\"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-4 px-8 rounded-lg text-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5\"\r\n                  >\r\n                    Get Started Free\r\n                  </button>\r\n                  <button\r\n                    onClick={onLogin}\r\n                    className=\"bg-white hover:bg-gray-50 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-900 dark:text-white font-semibold py-4 px-8 rounded-lg text-lg border-2 border-gray-300 dark:border-gray-600 transition-colors duration-200\"\r\n                  >\r\n                    Sign In\r\n                  </button>\r\n                </div>\r\n\r\n                {/* Trust Indicators */}\r\n                <div className=\"flex items-center justify-center lg:justify-start gap-6 text-sm text-gray-500 dark:text-gray-400\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <svg className=\"w-5 h-5 text-green-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                    </svg>\r\n                    <span>Open Source</span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <svg className=\"w-5 h-5 text-green-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                    </svg>\r\n                    <span>Free to Start</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Right Column - Visual Proof */}\r\n              <div className=\"relative\">\r\n                <div className=\"relative rounded-lg shadow-2xl overflow-hidden border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800\">\r\n                  {/* Placeholder for screenshot/demo video/gif */}\r\n                  {/* Replace this div with an <img>, <video>, or <iframe> when you have the visual content */}\r\n                  <div className=\"aspect-video bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center\">\r\n                    <div className=\"text-center p-8\">\r\n                      <svg className=\"w-24 h-24 mx-auto text-blue-400 dark:text-blue-500 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z\" />\r\n                      </svg>\r\n                      <p className=\"text-gray-600 dark:text-gray-400 text-lg font-medium\">\r\n                        Product Demo / Screenshot\r\n                      </p>\r\n                      <p className=\"text-gray-500 dark:text-gray-500 text-sm mt-2\">\r\n                        Add your 30-60s demo video, GIF, or screenshot here\r\n                      </p>\r\n                    </div>\r\n                    {/* When you have the visual content, use something like:\r\n                    <Image src=\"/demo-screenshot.png\" alt=\"Partial Dashboard\" width={1200} height={800} className=\"w-full h-auto\" />\r\n                    OR\r\n                    <video autoPlay loop muted className=\"w-full h-auto\">\r\n                      <source src=\"/demo-video.mp4\" type=\"video/mp4\" />\r\n                    </video>\r\n                    */}\r\n                  </div>\r\n                </div>\r\n                {/* Decorative elements */}\r\n                <div className=\"absolute -z-10 -top-4 -right-4 w-full h-full bg-blue-200 dark:bg-blue-900 rounded-lg opacity-20 blur-2xl\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Section 2 - \"Who is it for?\" */}\r\n      <section className=\"py-20 bg-white dark:bg-gray-900 border-y border-gray-200 dark:border-gray-800\">\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"max-w-4xl mx-auto text-center mb-16\">\r\n            <h2 className=\"text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4\">\r\n              Built for Hardware Teams\r\n            </h2>\r\n            <p className=\"text-xl text-gray-600 dark:text-gray-300\">\r\n              Whether you're an engineer tracking parts or a program manager monitoring deliverables\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"grid md:grid-cols-2 gap-8 max-w-5xl mx-auto\">\r\n            {/* Engineers Card */}\r\n            <div className=\"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-gray-800 dark:to-gray-800 p-8 rounded-xl border border-blue-200 dark:border-gray-700\">\r\n              <div className=\"w-16 h-16 bg-blue-600 rounded-xl flex items-center justify-center mb-6\">\r\n                <svg className=\"w-8 h-8 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\r\n                </svg>\r\n              </div>\r\n              <h3 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">For Engineers</h3>\r\n              <ul className=\"space-y-3 text-gray-700 dark:text-gray-300\">\r\n                <li className=\"flex items-start gap-3\">\r\n                  <svg className=\"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                  <span>Track work items directly linked to parts you own</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-3\">\r\n                  <svg className=\"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                  <span>Manage hardware-specific deliverables (BOMs, drawings, test reports)</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-3\">\r\n                  <svg className=\"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                  <span>View part hierarchy and understand dependencies</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-3\">\r\n                  <svg className=\"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                  <span>Collaborate with discipline teams (Mechanical, Electrical, Structural)</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n\r\n            {/* Program Managers Card */}\r\n            <div className=\"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-gray-800 dark:to-gray-800 p-8 rounded-xl border border-purple-200 dark:border-gray-700\">\r\n              <div className=\"w-16 h-16 bg-purple-600 rounded-xl flex items-center justify-center mb-6\">\r\n                <svg className=\"w-8 h-8 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\r\n                </svg>\r\n              </div>\r\n              <h3 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">For Program Managers</h3>\r\n              <ul className=\"space-y-3 text-gray-700 dark:text-gray-300\">\r\n                <li className=\"flex items-start gap-3\">\r\n                  <svg className=\"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                  <span>Monitor program health across all parts and work items</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-3\">\r\n                  <svg className=\"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                  <span>Track team performance and workload distribution</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-3\">\r\n                  <svg className=\"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                  <span>Identify bottlenecks and dependencies in real-time</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-3\">\r\n                  <svg className=\"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                  <span>Manage milestones with automatic dependency tracing</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Section 3 - \"Why is it better than JIRA?\" */}\r\n      <section className=\"py-20 bg-gray-50 dark:bg-gray-800\">\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"max-w-6xl mx-auto\">\r\n            <div className=\"text-center mb-16\">\r\n              <h2 className=\"text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4\">\r\n                Why Partial Over JIRA?\r\n              </h2>\r\n              <p className=\"text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto\">\r\n                JIRA was built for software. Partial was built for hardware from the ground up.\r\n              </p>\r\n            </div>\r\n\r\n            {/* Comparison Table */}\r\n            <div className=\"bg-white dark:bg-gray-900 rounded-xl shadow-xl overflow-hidden border border-gray-200 dark:border-gray-700\">\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full\">\r\n                  <thead className=\"bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700\">\r\n                    <tr>\r\n                      <th className=\"px-6 py-4 text-left text-sm font-semibold text-gray-900 dark:text-white w-1/3\">\r\n                        Feature\r\n                      </th>\r\n                      <th className=\"px-6 py-4 text-center text-sm font-semibold text-gray-500 dark:text-gray-400 w-1/3\">\r\n                        JIRA\r\n                      </th>\r\n                      <th className=\"px-6 py-4 text-center text-sm font-semibold text-blue-600 dark:text-blue-400 w-1/3\">\r\n                        Partial\r\n                      </th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody className=\"divide-y divide-gray-200 dark:divide-gray-700\">\r\n                    <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors\">\r\n                      <td className=\"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white\">\r\n                        Part Hierarchy & Management\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-gray-600 dark:text-gray-400\">\r\n                        ‚ùå Not built-in\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-green-600 dark:text-green-400 font-semibold\">\r\n                        ‚úÖ Native support\r\n                      </td>\r\n                    </tr>\r\n                    <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors\">\r\n                      <td className=\"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white\">\r\n                        Hardware-Specific Deliverables\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-gray-600 dark:text-gray-400\">\r\n                        ‚ùå Custom fields required\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-green-600 dark:text-green-400 font-semibold\">\r\n                        ‚úÖ Built-in (BOM, drawings, CoC, ATP, etc.)\r\n                      </td>\r\n                    </tr>\r\n                    <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors\">\r\n                      <td className=\"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white\">\r\n                        Part-Centric Work Tracking\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-gray-600 dark:text-gray-400\">\r\n                        ‚ùå Story/epic focused\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-green-600 dark:text-green-400 font-semibold\">\r\n                        ‚úÖ Work linked to physical parts\r\n                      </td>\r\n                    </tr>\r\n                    <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors\">\r\n                      <td className=\"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white\">\r\n                        Revision Control for Parts\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-gray-600 dark:text-gray-400\">\r\n                        ‚ùå Not designed for hardware\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-green-600 dark:text-green-400 font-semibold\">\r\n                        ‚úÖ Part states & revision tracking\r\n                      </td>\r\n                    </tr>\r\n                    <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors\">\r\n                      <td className=\"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white\">\r\n                        Discipline-Based Teams\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-gray-600 dark:text-gray-400\">\r\n                        ‚ùå Feature/product teams\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-green-600 dark:text-green-400 font-semibold\">\r\n                        ‚úÖ Mechanical, Electrical, Structural, etc.\r\n                      </td>\r\n                    </tr>\r\n                    <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors\">\r\n                      <td className=\"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white\">\r\n                        Hardware Issue Types\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-gray-600 dark:text-gray-400\">\r\n                        ‚ùå Generic bug tracking\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-center text-sm text-green-600 dark:text-green-400 font-semibold\">\r\n                        ‚úÖ Manufacturing, supply chain, obsolescence issues\r\n                      </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Section 4 - \"What should I do next?\" */}\r\n      <section className=\"py-20 bg-gradient-to-br from-blue-600 to-indigo-700 dark:from-gray-900 dark:to-gray-800 text-white\">\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"max-w-4xl mx-auto text-center\">\r\n            <h2 className=\"text-4xl md:text-5xl font-bold mb-6\">\r\n              Ready to Get Started?\r\n            </h2>\r\n            <p className=\"text-xl md:text-2xl mb-12 text-blue-100 dark:text-gray-300\">\r\n              Join hardware teams who have moved beyond generic project management tools.\r\n            </p>\r\n            \r\n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center mb-12\">\r\n              <button\r\n                onClick={onGetStarted}\r\n                className=\"bg-white text-blue-600 hover:bg-gray-100 font-semibold py-4 px-8 rounded-lg text-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5\"\r\n              >\r\n                Start Free Trial\r\n              </button>\r\n              <button\r\n                onClick={onLearnMore}\r\n                className=\"bg-transparent border-2 border-white text-white hover:bg-white hover:text-blue-600 font-semibold py-4 px-8 rounded-lg text-lg transition-all duration-200\"\r\n              >\r\n                Learn More\r\n              </button>\r\n            </div>\r\n\r\n            {/* Benefits list */}\r\n            <div className=\"grid md:grid-cols-3 gap-6 mt-16\">\r\n              <div className=\"bg-white/10 backdrop-blur-sm rounded-lg p-6 border border-white/20\">\r\n                <div className=\"text-3xl mb-3\">‚ö°</div>\r\n                <h3 className=\"font-semibold mb-2\">Quick Setup</h3>\r\n                <p className=\"text-sm text-blue-100\">Get started in minutes, not weeks</p>\r\n              </div>\r\n              <div className=\"bg-white/10 backdrop-blur-sm rounded-lg p-6 border border-white/20\">\r\n                <div className=\"text-3xl mb-3\">üîì</div>\r\n                <h3 className=\"font-semibold mb-2\">Open Source</h3>\r\n                <p className=\"text-sm text-blue-100\">Free and transparent. No vendor lock-in.</p>\r\n              </div>\r\n              <div className=\"bg-white/10 backdrop-blur-sm rounded-lg p-6 border border-white/20\">\r\n                <div className=\"text-3xl mb-3\">üéØ</div>\r\n                <h3 className=\"font-semibold mb-2\">Purpose-Built</h3>\r\n                <p className=\"text-sm text-blue-100\">Designed specifically for hardware teams</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst AuthScreen = ({ onBack, onNext, initialMode = \"signup\" }: {\r\n  onBack: () => void;\r\n  onNext: () => void;\r\n  initialMode?: \"signup\" | \"login\";\r\n}) => {\r\n  const router = useRouter();\r\n  const [isLogin, setIsLogin] = useState(initialMode === \"login\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [passwordErrors, setPasswordErrors] = useState<string[]>([]);\r\n  const { signUp, signIn } = useAuth();\r\n  \r\n  const [formData, setFormData] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n    confirmPassword: \"\",\r\n    name: \"\",\r\n    phoneNumber: \"\",\r\n  });\r\n\r\n  const handlePasswordChange = (password: string) => {\r\n    setFormData({ ...formData, password });\r\n    if (!isLogin) {\r\n      const validation = validatePassword(password);\r\n      setPasswordErrors(validation.errors);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      if (isLogin) {\r\n        await signIn({\r\n          email: formData.email,\r\n          password: formData.password,\r\n        });\r\n        // For login, redirect directly to dashboard\r\n        router.push(\"/home\");\r\n        return;\r\n      } else {\r\n        // Validate password for signup\r\n        const validation = validatePassword(formData.password);\r\n        if (!validation.isValid) {\r\n          setPasswordErrors(validation.errors);\r\n          setIsLoading(false);\r\n          return;\r\n        }\r\n\r\n        // Validate password confirmation\r\n        if (formData.password !== formData.confirmPassword) {\r\n          setError(\"Passwords do not match\");\r\n          setIsLoading(false);\r\n          return;\r\n        }\r\n\r\n        await signUp({\r\n          email: formData.email,\r\n          password: formData.password,\r\n          name: formData.name,\r\n          phoneNumber: formData.phoneNumber,\r\n          role: \"Engineer\", // Default role, will be updated in role selection\r\n        });\r\n        setIsLogin(true);\r\n        onNext();\r\n      }\r\n    } catch (error: any) {\r\n      setError(error.message || \"An error occurred. Please try again.\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-md w-full space-y-8\">\r\n        <div>\r\n          <button\r\n            onClick={onBack}\r\n            className=\"flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-6\"\r\n          >\r\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n            Back\r\n          </button>\r\n          \r\n          <div className=\"text-center\">\r\n            <Image\r\n              src=\"/logo1.png\"\r\n              alt=\"Partial Logo\"\r\n              width={80}\r\n              height={80}\r\n              className=\"mx-auto mb-4\"\r\n            />\r\n            <h2 className=\"text-3xl font-bold text-gray-900 dark:text-white\">\r\n              {isLogin ? \"Welcome Back\" : \"Create Account\"}\r\n            </h2>\r\n            <p className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\r\n              {isLogin \r\n                ? \"Sign in to your account to continue\" \r\n                : \"Join the platform to start managing your hardware development work\"\r\n              }\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <form className=\"mt-8 space-y-6\" onSubmit={handleSubmit}>\r\n          <div className=\"space-y-4\">\r\n            {!isLogin && (\r\n              <>\r\n                <div>\r\n                  <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                    Full Name\r\n                  </label>\r\n                  <input\r\n                    id=\"name\"\r\n                    name=\"name\"\r\n                    type=\"text\"\r\n                    required={!isLogin}\r\n                    value={formData.name}\r\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                    className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white\"\r\n                    placeholder=\"Enter your full name\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label htmlFor=\"phoneNumber\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                    Phone Number\r\n                  </label>\r\n                  <input\r\n                    id=\"phoneNumber\"\r\n                    name=\"phoneNumber\"\r\n                    type=\"tel\"\r\n                    required={!isLogin}\r\n                    value={formData.phoneNumber}\r\n                    onChange={(e) => setFormData({ ...formData, phoneNumber: e.target.value })}\r\n                    className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white\"\r\n                    placeholder=\"Enter your phone number\"\r\n                  />\r\n                </div>\r\n              </>\r\n            )}\r\n            \r\n            <div>\r\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                Email Address\r\n              </label>\r\n              <input\r\n                id=\"email\"\r\n                name=\"email\"\r\n                type=\"email\"\r\n                required\r\n                value={formData.email}\r\n                onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white\"\r\n                placeholder=\"Enter your email\"\r\n              />\r\n            </div>\r\n            \r\n            <div>\r\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                Password\r\n              </label>\r\n                  <input\r\n                    id=\"password\"\r\n                    name=\"password\"\r\n                    type=\"password\"\r\n                    required\r\n                    value={formData.password}\r\n                    onChange={(e) => handlePasswordChange(e.target.value)}\r\n                    className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white\"\r\n                    placeholder=\"Enter your password\"\r\n                  />\r\n                  {!isLogin && passwordErrors.length > 0 && (\r\n                    <div className=\"mt-2 text-sm text-red-600 dark:text-red-400\">\r\n                      <ul className=\"list-disc list-inside space-y-1\">\r\n                        {passwordErrors.map((error, index) => (\r\n                          <li key={index}>{error}</li>\r\n                        ))}\r\n                      </ul>\r\n                    </div>\r\n                  )}\r\n            </div>\r\n            \r\n            {!isLogin && (\r\n              <div>\r\n                <label htmlFor=\"confirmPassword\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                  Confirm Password\r\n                </label>\r\n                <input\r\n                  id=\"confirmPassword\"\r\n                  name=\"confirmPassword\"\r\n                  type=\"password\"\r\n                  required={!isLogin}\r\n                  value={formData.confirmPassword}\r\n                  onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}\r\n                  className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white\"\r\n                  placeholder=\"Confirm your password\"\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {error && (\r\n            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4\">\r\n              <div className=\"text-sm text-red-600 dark:text-red-400\">\r\n                {error}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div>\r\n            <button\r\n              type=\"submit\"\r\n              disabled={isLoading}\r\n              className=\"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {isLoading ? (\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                  {isLogin ? \"Signing In...\" : \"Creating Account...\"}\r\n                </div>\r\n              ) : (\r\n                isLogin ? \"Sign In\" : \"Create Account\"\r\n              )}\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"text-center\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setIsLogin(!isLogin)}\r\n              className=\"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 text-sm font-medium\"\r\n            >\r\n              {isLogin \r\n                ? \"Don't have an account? Sign up\" \r\n                : \"Already have an account? Sign in\"\r\n              }\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst RoleSelectionScreen = ({ onBack, onNext, invitationData, isNewOrganization }: {\r\n  onBack: () => void;\r\n  onNext: (role: string) => void;\r\n  invitationData?: {\r\n    organization: { id: number; name: string };\r\n    role: string;\r\n    invitedEmail?: string;\r\n  } | null;\r\n  isNewOrganization?: boolean;\r\n}) => {\r\n  const [selectedRole, setSelectedRole] = useState<string>(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  // Note: For new organization creation, we show a special Admin assignment screen\r\n  // The backend will automatically assign Admin role regardless of what's passed\r\n\r\n  const roles = [\r\n    {\r\n      id: \"engineer\",\r\n      title: \"Engineer\",\r\n      description: \"Track work items for parts you own, manage deliverables, and collaborate with your team.\",\r\n      icon: (\r\n        <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\r\n        </svg>\r\n      ),\r\n      features: [\r\n        \"Track work items for assigned parts\",\r\n        \"Manage deliverables and issues\",\r\n        \"Collaborate with team members\",\r\n        \"Update work item status and progress\"\r\n      ]\r\n    },\r\n    {\r\n      id: \"program-manager\",\r\n      title: \"Program Manager\",\r\n      description: \"Monitor program health, track team performance, and identify bottlenecks across all projects.\",\r\n      icon: (\r\n        <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\r\n        </svg>\r\n      ),\r\n      features: [\r\n        \"Monitor program status and progress\",\r\n        \"Track team performance metrics\",\r\n        \"Identify bottlenecks and risks\",\r\n        \"Manage milestones and deadlines\"\r\n      ]\r\n    }\r\n  ];\r\n\r\n  // For new organization creation, show Admin assignment message\r\n  if (isNewOrganization && !invitationData) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"max-w-4xl mx-auto\">\r\n          <div className=\"text-center mb-12\">\r\n            <h2 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-4\">\r\n              Setting Up Your Organization\r\n            </h2>\r\n            <p className=\"text-lg text-gray-600 dark:text-gray-400 mb-8\">\r\n              As the first user, you'll be automatically assigned the Admin role\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"max-w-2xl mx-auto\">\r\n            <div className=\"p-8 border-2 border-blue-500 dark:border-blue-500 rounded-lg bg-blue-50 dark:bg-blue-900/20\">\r\n              <div className=\"flex items-start space-x-4\">\r\n                <div className=\"p-3 rounded-lg bg-blue-100 dark:bg-blue-800 text-blue-600 dark:text-blue-400\">\r\n                  <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z\" />\r\n                  </svg>\r\n                </div>\r\n                <div className=\"flex-1\">\r\n                  <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-2\">\r\n                    Admin Role\r\n                  </h3>\r\n                  <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\r\n                    As the organization administrator, you'll have full access to manage users, teams, programs, and invite new members.\r\n                  </p>\r\n                  <ul className=\"space-y-2\">\r\n                    <li className=\"flex items-center text-sm text-gray-600 dark:text-gray-400\">\r\n                      <svg className=\"w-4 h-4 text-green-500 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n                      </svg>\r\n                      Manage users and assign roles\r\n                    </li>\r\n                    <li className=\"flex items-center text-sm text-gray-600 dark:text-gray-400\">\r\n                      <svg className=\"w-4 h-4 text-green-500 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n                      </svg>\r\n                      Create and manage teams\r\n                    </li>\r\n                    <li className=\"flex items-center text-sm text-gray-600 dark:text-gray-400\">\r\n                      <svg className=\"w-4 h-4 text-green-500 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n                      </svg>\r\n                      Invite new members to your organization\r\n                    </li>\r\n                    <li className=\"flex items-center text-sm text-gray-600 dark:text-gray-400\">\r\n                      <svg className=\"w-4 h-4 text-green-500 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n                      </svg>\r\n                      Full access to all programs and work items\r\n                    </li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"text-center mt-8\">\r\n            <button\r\n              onClick={() => onNext(\"Admin\")}\r\n              disabled={isLoading}\r\n              className=\"px-8 py-3 rounded-lg font-semibold text-lg transition-colors duration-200 bg-blue-600 hover:bg-blue-700 text-white shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {isLoading ? (\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2\"></div>\r\n                  Setting up...\r\n                </div>\r\n              ) : (\r\n                \"Continue\"\r\n              )}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <div className=\"text-center mb-12\">\r\n          <button\r\n            onClick={onBack}\r\n            className=\"flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-6 mx-auto\"\r\n          >\r\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n            Back\r\n          </button>\r\n          \r\n          <h2 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-4\">\r\n            {invitationData ? 'Join Organization' : 'Choose Your Role'}\r\n          </h2>\r\n          {invitationData && (\r\n            <div className=\"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\r\n              <p className=\"text-sm font-medium text-blue-900 dark:text-blue-200 mb-1\">\r\n                You've been invited to join:\r\n              </p>\r\n              <p className=\"text-lg font-semibold text-blue-900 dark:text-blue-100\">\r\n                {invitationData.organization.name}\r\n              </p>\r\n              {invitationData.invitedEmail && (\r\n                <p className=\"text-sm text-blue-700 dark:text-blue-300 mt-1\">\r\n                  Invited as: {invitationData.invitedEmail}\r\n                </p>\r\n              )}\r\n              <p className=\"text-sm text-blue-700 dark:text-blue-300 mt-2\">\r\n                Role: <span className=\"font-medium\">{invitationData.role}</span>\r\n              </p>\r\n            </div>\r\n          )}\r\n          <p className=\"text-lg text-gray-600 dark:text-gray-400\">\r\n            {invitationData \r\n              ? 'Your role has been pre-selected. Click continue to proceed.'\r\n              : 'Select your primary role to customize your experience'}\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"grid md:grid-cols-2 gap-8 mb-8\">\r\n          {invitationData ? (\r\n            // If invitation exists, show pre-selected role and continue button\r\n            <div className=\"col-span-2 p-6 border-2 border-blue-500 dark:border-blue-500 rounded-lg bg-blue-50 dark:bg-blue-900/20\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <span className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                    {invitationData.role}\r\n                  </span>\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\r\n                    This role was assigned by the organization administrator.\r\n                  </p>\r\n                </div>\r\n                <svg\r\n                  className=\"w-5 h-5 text-blue-500\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M9 5l7 7-7 7\"\r\n                  />\r\n                </svg>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            // Normal role selection\r\n            roles.map((role) => (\r\n            <div\r\n              key={role.id}\r\n              onClick={() => setSelectedRole(role.id)}\r\n              className={`cursor-pointer p-8 rounded-lg border-2 transition-all duration-200 ${\r\n                selectedRole === role.id\r\n                  ? \"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-lg\"\r\n                  : \"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-gray-300 dark:hover:border-gray-600 hover:shadow-md\"\r\n              }`}\r\n            >\r\n              <div className=\"flex items-start space-x-4\">\r\n                <div className={`p-3 rounded-lg ${\r\n                  selectedRole === role.id\r\n                    ? \"bg-blue-100 dark:bg-blue-800 text-blue-600 dark:text-blue-400\"\r\n                    : \"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400\"\r\n                }`}>\r\n                  {role.icon}\r\n                </div>\r\n                <div className=\"flex-1\">\r\n                  <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-2\">\r\n                    {role.title}\r\n                  </h3>\r\n                  <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\r\n                    {role.description}\r\n                  </p>\r\n                  <ul className=\"space-y-2\">\r\n                    {role.features.map((feature, index) => (\r\n                      <li key={index} className=\"flex items-center text-sm text-gray-600 dark:text-gray-400\">\r\n                        <svg className=\"w-4 h-4 text-green-500 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n                        </svg>\r\n                        {feature}\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            ))\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"text-center\">\r\n          <button\r\n            onClick={() => {\r\n              if (invitationData) {\r\n                // If invitation exists, use the role from invitation\r\n                setIsLoading(true);\r\n                onNext(invitationData.role);\r\n                setIsLoading(false);\r\n              } else if (selectedRole) {\r\n                setIsLoading(true);\r\n                // For new organization, role is automatically Admin (handled by backend)\r\n                // But we still need to pass something - backend will override it\r\n                // Map role ID to display name for backend\r\n                // \"engineer\" -> \"Engineer\", \"program-manager\" -> \"Program Manager\"\r\n                const roleDisplayName = selectedRole === \"engineer\" ? \"Engineer\" : \"Program Manager\";\r\n                onNext(roleDisplayName);\r\n                setIsLoading(false);\r\n              }\r\n            }}\r\n            disabled={(!invitationData && !selectedRole) || isLoading}\r\n            className={`px-8 py-3 rounded-lg font-semibold text-lg transition-colors duration-200 ${\r\n              (invitationData || selectedRole) && !isLoading\r\n                ? \"bg-blue-600 hover:bg-blue-700 text-white shadow-lg hover:shadow-xl\"\r\n                : \"bg-gray-300 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed\"\r\n            }`}\r\n          >\r\n            {isLoading ? (\r\n              <div className=\"flex items-center\">\r\n                <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2\"></div>\r\n                Updating...\r\n              </div>\r\n            ) : (\r\n              invitationData ? \"Continue\" : \"Continue\"\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst OrganizationNameScreen = ({ \r\n  onBack, \r\n  onNext, \r\n  invitationData \r\n}: { \r\n  onBack: () => void; \r\n  onNext: (organizationName: string) => void;\r\n  invitationData?: {\r\n    organization: { id: number; name: string };\r\n    role: string;\r\n    invitedEmail?: string;\r\n  } | null;\r\n}) => {\r\n  const [organizationName, setOrganizationName] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  // Skip this screen if joining via invitation (organization already exists)\r\n  useEffect(() => {\r\n    if (invitationData) {\r\n      onNext(\"\"); // Skip organization name for invitations\r\n    }\r\n  }, [invitationData, onNext]);\r\n\r\n  if (invitationData) {\r\n    return null; // Don't render if invitation exists\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!organizationName.trim()) {\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n    onNext(organizationName.trim());\r\n    setIsLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-2xl mx-auto\">\r\n        <div className=\"text-center mb-8\">\r\n          <button\r\n            onClick={onBack}\r\n            className=\"flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-6 mx-auto\"\r\n          >\r\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n            Back\r\n          </button>\r\n          \r\n          <h2 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-4\">\r\n            Name Your Organization\r\n          </h2>\r\n          <p className=\"text-lg text-gray-600 dark:text-gray-400\">\r\n            Give your organization a name. You can change this later in settings.\r\n          </p>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8\">\r\n          <div className=\"space-y-6\">\r\n            <div>\r\n              <label htmlFor=\"organizationName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Organization Name\r\n              </label>\r\n              <input\r\n                id=\"organizationName\"\r\n                type=\"text\"\r\n                value={organizationName}\r\n                onChange={(e) => setOrganizationName(e.target.value)}\r\n                className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                placeholder=\"Enter your organization name\"\r\n                required\r\n                autoFocus\r\n              />\r\n              <p className=\"mt-2 text-xs text-gray-500 dark:text-gray-400\">\r\n                This will be the name of your organization. All users you invite will be part of this organization.\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"flex justify-end space-x-3\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={onBack}\r\n                className=\"px-6 py-3 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n              >\r\n                Back\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={!organizationName.trim() || isLoading}\r\n                className=\"px-6 py-3 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {isLoading ? \"Creating...\" : \"Continue\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ProfileCompletionScreen = ({ onBack, onNext }: {\r\n  onBack: () => void;\r\n  onNext: (result: { requiresSetup: boolean; teamId: number | null }) => void;\r\n}) => {\r\n  const { user, updateProfile } = useAuth();\r\n  const [isRefreshingUser, setIsRefreshingUser] = useState(false);\r\n  const { data: teams, isLoading: teamsLoading } = useGetTeamsQuery();\r\n  const { data: programs } = useGetProgramsQuery();\r\n  const [createTeam, { isLoading: isCreatingTeam }] = useCreateTeamMutation();\r\n  const sanitizeProfilePictureUrl = (value?: string | null) => {\r\n    if (!value) return \"\";\r\n    const trimmed = value.trim();\r\n    if (!trimmed) return \"\";\r\n    const lower = trimmed.toLowerCase();\r\n    if (lower.startsWith(\"http://\") || lower.startsWith(\"https://\")) {\r\n      return \"\";\r\n    }\r\n    return trimmed.startsWith(\"/\") ? trimmed : `/${trimmed}`;\r\n  };\r\n\r\n  const [selectedTeamId, setSelectedTeamId] = useState<number | null>(user?.disciplineTeamId || null);\r\n  const [profilePictureUrl, setProfilePictureUrl] = useState<string>(sanitizeProfilePictureUrl(user?.profilePictureUrl));\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  // Refresh user on mount if not available (user was just created in role selection)\r\n  useEffect(() => {\r\n    const refreshUser = async () => {\r\n      if (!user && !isRefreshingUser) {\r\n        setIsRefreshingUser(true);\r\n        try {\r\n          const { authService } = await import('@/lib/auth');\r\n          const refreshedUser = await authService.getCurrentUser();\r\n          if (refreshedUser) {\r\n            // User found - auth context will update via listeners\r\n            console.log('User refreshed in profile screen:', refreshedUser);\r\n          }\r\n        } catch (error) {\r\n          console.error('Failed to refresh user:', error);\r\n        } finally {\r\n          setIsRefreshingUser(false);\r\n        }\r\n      }\r\n    };\r\n    // Small delay to ensure user creation is complete\r\n    const timer = setTimeout(refreshUser, 300);\r\n    return () => clearTimeout(timer);\r\n  }, [user, isRefreshingUser]);\r\n  const [newTeamName, setNewTeamName] = useState(\"\");\r\n  const [newTeamDescription, setNewTeamDescription] = useState(\"\");\r\n  const [showCreateTeam, setShowCreateTeam] = useState(false);\r\n  const [createTeamError, setCreateTeamError] = useState<string | null>(null);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsSaving(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // Validate that a discipline team is selected\r\n      if (!selectedTeamId) {\r\n        setError(\"Please select a discipline team to continue.\");\r\n        setIsSaving(false);\r\n        return;\r\n      }\r\n\r\n      // If user doesn't exist in context yet, refresh from server\r\n      // (User should have been created in role selection step)\r\n      let currentUser = user;\r\n      if (!currentUser) {\r\n        const { authService } = await import('@/lib/auth');\r\n        currentUser = await authService.getCurrentUser();\r\n        \r\n        if (!currentUser) {\r\n          setError(\"User not found. Please complete role selection first.\");\r\n          setIsSaving(false);\r\n          return;\r\n        }\r\n      }\r\n\r\n      await updateProfile({\r\n        disciplineTeamId: selectedTeamId,\r\n        profilePictureUrl: sanitizeProfilePictureUrl(profilePictureUrl),\r\n      });\r\n\r\n      // Use user from context (should be available after refresh above)\r\n      const teamId = selectedTeamId ?? user?.disciplineTeamId ?? null;\r\n      let requiresSetup = false;\r\n      if (teamId) {\r\n        const teamPrograms = programs?.filter((program) =>\r\n          program.disciplineTeams?.some((dtp) => dtp.disciplineTeamId === teamId),\r\n        ) ?? [];\r\n        requiresSetup = teamPrograms.length === 0;\r\n      }\r\n\r\n      onNext({ requiresSetup, teamId });\r\n    } catch (error: any) {\r\n      setError(error.message || \"Failed to update profile. Please try again.\");\r\n      console.error('Failed to update profile:', error);\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-2xl mx-auto\">\r\n        <div className=\"text-center mb-8\">\r\n          <button\r\n            onClick={onBack}\r\n            className=\"flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-6 mx-auto\"\r\n          >\r\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n            Back\r\n          </button>\r\n          \r\n          <h2 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-4\">\r\n            Complete Your Profile\r\n          </h2>\r\n          <p className=\"text-lg text-gray-600 dark:text-gray-400\">\r\n            Add optional information to personalize your experience\r\n          </p>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8\">\r\n          <div className=\"space-y-6\">\r\n            {/* Profile Picture URL */}\r\n            <div>\r\n              <label htmlFor=\"profilePictureUrl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Profile Picture URL (Optional)\r\n              </label>\r\n              <input\r\n                id=\"profilePictureUrl\"\r\n                name=\"profilePictureUrl\"\r\n                type=\"url\"\r\n                value={profilePictureUrl}\r\n                onChange={(e) => setProfilePictureUrl(sanitizeProfilePictureUrl(e.target.value))}\r\n                className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                placeholder=\"/images/profile.jpg\"\r\n              />\r\n              {profilePictureUrl && (\r\n                <div className=\"mt-4\">\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2\">Preview:</p>\r\n                  <div className=\"w-32 h-32 rounded-full overflow-hidden border-2 border-gray-200 dark:border-gray-600\">\r\n                    <img\r\n                      src={profilePictureUrl}\r\n                      alt=\"Profile preview\"\r\n                      className=\"w-full h-full object-cover\"\r\n                      onError={(e) => {\r\n                        (e.target as HTMLImageElement).style.display = 'none';\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <p className=\"mt-2 text-xs text-gray-500 dark:text-gray-400\">\r\n                Use a local media path (e.g. /images/profile.jpg). You can add a profile picture later in settings.\r\n              </p>\r\n            </div>\r\n\r\n            {/* Discipline Team Selection */}\r\n            <div>\r\n              <label htmlFor=\"disciplineTeam\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Discipline Team <span className=\"text-red-500\">*</span>\r\n              </label>\r\n              {teamsLoading ? (\r\n                <div className=\"flex items-center justify-center py-4\">\r\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\r\n                  <span className=\"ml-2 text-gray-600 dark:text-gray-400\">Loading teams...</span>\r\n                </div>\r\n              ) : (\r\n                <select\r\n                  id=\"disciplineTeam\"\r\n                  name=\"disciplineTeam\"\r\n                  value={selectedTeamId || \"\"}\r\n                  onChange={(e) => setSelectedTeamId(e.target.value ? Number(e.target.value) : null)}\r\n                  className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                >\r\n                  <option value=\"\">No team selected</option>\r\n                  {teams?.map((team) => (\r\n                    <option key={team.id} value={team.id}>\r\n                      {team.name} {team.description ? `- ${team.description}` : \"\"}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              )}\r\n              <p className=\"mt-2 text-xs text-gray-500 dark:text-gray-400\">\r\n                Select your team to connect with colleagues and collaborate on projects. You can create a new team if needed.\r\n              </p>\r\n\r\n              <div className=\"mt-4\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setShowCreateTeam((prev) => !prev);\r\n                    setCreateTeamError(null);\r\n                  }}\r\n                  className=\"text-sm font-medium text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300\"\r\n                >\r\n                  {showCreateTeam ? \"Cancel new team\" : \"Create a new discipline team\"}\r\n                </button>\r\n              </div>\r\n\r\n              {showCreateTeam && (\r\n                <div className=\"mt-4 space-y-4 rounded-md border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800\">\r\n                  <div>\r\n                    <label htmlFor=\"newTeamName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Team Name\r\n                    </label>\r\n                    <input\r\n                      id=\"newTeamName\"\r\n                      type=\"text\"\r\n                      value={newTeamName}\r\n                      onChange={(e) => setNewTeamName(e.target.value)}\r\n                      className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                      placeholder=\"Enter the new team name\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label htmlFor=\"newTeamDescription\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Team Description\r\n                    </label>\r\n                    <textarea\r\n                      id=\"newTeamDescription\"\r\n                      value={newTeamDescription}\r\n                      onChange={(e) => setNewTeamDescription(e.target.value)}\r\n                      className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                      rows={3}\r\n                      placeholder=\"Describe the purpose of this team\"\r\n                    />\r\n                  </div>\r\n\r\n                  {createTeamError && (\r\n                    <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-3 text-sm text-red-600 dark:text-red-400\">\r\n                      {createTeamError}\r\n                    </div>\r\n                  )}\r\n\r\n                  <div className=\"flex justify-end\">\r\n                    <button\r\n                      type=\"button\"\r\n                      disabled={isCreatingTeam}\r\n                      onClick={async () => {\r\n                        setCreateTeamError(null);\r\n                        if (!newTeamName.trim() || !newTeamDescription.trim()) {\r\n                          setCreateTeamError(\"Please provide both a team name and description.\");\r\n                          return;\r\n                        }\r\n\r\n                        try {\r\n                          // During onboarding, automatically assign the current user as team manager\r\n                          const currentUserId = user?.id;\r\n                          if (!currentUserId) {\r\n                            setCreateTeamError(\"User not found. Please refresh the page.\");\r\n                            return;\r\n                          }\r\n\r\n                          const newTeam = await createTeam({\r\n                            name: newTeamName.trim(),\r\n                            description: newTeamDescription.trim(),\r\n                            teamManagerUserId: currentUserId, // Automatically assign creator as team manager\r\n                          }).unwrap();\r\n\r\n                          // Automatically assign user to the newly created team\r\n                          setSelectedTeamId(newTeam.id);\r\n                          \r\n                          // Update user's disciplineTeamId immediately\r\n                          await updateProfile({\r\n                            disciplineTeamId: newTeam.id,\r\n                          });\r\n\r\n                          setShowCreateTeam(false);\r\n                          setNewTeamName(\"\");\r\n                          setNewTeamDescription(\"\");\r\n                        } catch (createErr: any) {\r\n                          console.error(\"Failed to create team:\", createErr);\r\n                          setCreateTeamError(createErr?.data?.message || \"Failed to create team. Please try again.\");\r\n                        }\r\n                      }}\r\n                      className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                    >\r\n                      {isCreatingTeam ? \"Creating...\" : \"Create Team\"}\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {error && (\r\n              <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4\">\r\n                <div className=\"text-sm text-red-600 dark:text-red-400\">\r\n                  {error}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"flex justify-between pt-6\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={onBack}\r\n                className=\"px-6 py-3 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n              >\r\n                Back\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={isSaving || !selectedTeamId}\r\n                className=\"px-6 py-3 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {isSaving ? (\r\n                  <div className=\"flex items-center\">\r\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                    Saving...\r\n                  </div>\r\n                ) : (\r\n                  \"Continue\"\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ProgramSetupScreen = ({\r\n  onBack,\r\n  onComplete,\r\n  onJoinExisting,\r\n  currentUser,\r\n}: {\r\n  onBack: () => void;\r\n  onComplete: (program: Program) => void;\r\n  onJoinExisting: (program: Program) => void;\r\n  currentUser: AuthUser | null;\r\n}) => {\r\n  const { data: programs = [], isLoading: programsLoading } = useGetProgramsQuery();\r\n  const [mode, setMode] = useState<\"create\" | \"join\">(\"create\");\r\n  const [selectedProgramId, setSelectedProgramId] = useState<number | \"\">(\"\");\r\n  const [joinError, setJoinError] = useState<string | null>(null);\r\n  const [createProgram, { isLoading, error }] = useCreateProgramMutation();\r\n  const [name, setName] = useState(\"\");\r\n  const [description, setDescription] = useState(\"\");\r\n  const [startDate, setStartDate] = useState(() => new Date().toISOString().split(\"T\")[0]);\r\n  const [endDate, setEndDate] = useState(() => addDays(new Date(), 30).toISOString().split(\"T\")[0]);\r\n  const [createdProgram, setCreatedProgram] = useState<Program | null>(null);\r\n  const [formError, setFormError] = useState<string | null>(null);\r\n\r\n  const handleCreateProgram = async () => {\r\n    setFormError(null);\r\n    if (!name || !startDate || !endDate) {\r\n      setFormError(\"Please provide a program name and date range.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const payload = {\r\n        name,\r\n        description,\r\n        programManagerUserId: currentUser?.id,\r\n        startDate: formatISO(new Date(startDate), { representation: \"complete\" }),\r\n        endDate: formatISO(new Date(endDate), { representation: \"complete\" }),\r\n      };\r\n\r\n      const newProgram = await createProgram(payload).unwrap();\r\n      setCreatedProgram(newProgram);\r\n      onComplete(newProgram);\r\n    } catch (e) {\r\n      setFormError(\"Failed to create program. Please try again.\");\r\n      console.error(\"Failed to create program:\", e);\r\n    }\r\n  };\r\n\r\n  const handleJoinProgram = () => {\r\n    setJoinError(null);\r\n    if (!selectedProgramId || typeof selectedProgramId !== \"number\") {\r\n      setJoinError(\"Please select a program to join.\");\r\n      return;\r\n    }\r\n\r\n    const programToJoin = programs.find((program) => program.id === selectedProgramId);\r\n    if (!programToJoin) {\r\n      setJoinError(\"Selected program could not be found. Please try again.\");\r\n      return;\r\n    }\r\n\r\n    onJoinExisting(programToJoin);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-2xl mx-auto\">\r\n        <div className=\"text-center mb-8\">\r\n          <button\r\n            onClick={onBack}\r\n            className=\"flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-6 mx-auto\"\r\n          >\r\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n            Back\r\n          </button>\r\n\r\n          <h2 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-4\">\r\n            {mode === \"create\" ? \"Create Your First Program\" : \"Join an Existing Program\"}\r\n          </h2>\r\n          <p className=\"text-lg text-gray-600 dark:text-gray-400\">\r\n            {mode === \"create\"\r\n              ? \"Program Managers use programs to organize milestones, parts, and work items. Let's create your first program to get your team started.\"\r\n              : \"Already have programs running? Choose one below so your team can plug into its milestones, parts, and work items right away.\"}\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8\">\r\n          <div className=\"flex gap-3 mb-6\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setMode(\"create\")}\r\n              className={`flex-1 rounded-md px-4 py-2 text-sm font-semibold transition-colors ${\r\n                mode === \"create\"\r\n                  ? \"bg-blue-600 text-white shadow\"\r\n                  : \"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600\"\r\n              }`}\r\n            >\r\n              Create New Program\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setMode(\"join\")}\r\n              className={`flex-1 rounded-md px-4 py-2 text-sm font-semibold transition-colors ${\r\n                mode === \"join\"\r\n                  ? \"bg-blue-600 text-white shadow\"\r\n                  : \"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600\"\r\n              }`}\r\n            >\r\n              Join Existing Program\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"space-y-6\">\r\n            {mode === \"create\" ? (\r\n              <>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    Program Name\r\n                  </label>\r\n                  <input\r\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                    value={name}\r\n                    onChange={(e) => setName(e.target.value)}\r\n                    placeholder=\"e.g. Alpha Device Launch\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    Description (Optional)\r\n                  </label>\r\n                  <textarea\r\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                    value={description}\r\n                    onChange={(e) => setDescription(e.target.value)}\r\n                    rows={3}\r\n                    placeholder=\"Provide context for this program\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-2\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Start Date\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                      value={startDate}\r\n                      onChange={(e) => setStartDate(e.target.value)}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      Target Completion Date\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                      value={endDate}\r\n                      onChange={(e) => setEndDate(e.target.value)}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                {formError && (\r\n                  <div className=\"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-300\">\r\n                    {formError}\r\n                  </div>\r\n                )}\r\n\r\n                {error && (\r\n                  <div className=\"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-300\">\r\n                    Failed to create program. Please try again.\r\n                  </div>\r\n                )}\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleCreateProgram}\r\n                  disabled={isLoading || !!createdProgram}\r\n                  className=\"flex w-full justify-center rounded-md bg-blue-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-600 disabled:cursor-not-allowed disabled:opacity-50\"\r\n                >\r\n                  {isLoading ? \"Creating Program...\" : createdProgram ? \"Program Created\" : \"Create Program\"}\r\n                </button>\r\n\r\n                {createdProgram && (\r\n                  <div className=\"rounded-md border border-green-200 bg-green-50 p-3 text-sm text-green-700 dark:border-green-800 dark:bg-green-900/20 dark:text-green-300\">\r\n                    Program \"{createdProgram.name}\" created successfully.\r\n                  </div>\r\n                )}\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => createdProgram && onComplete(createdProgram)}\r\n                  disabled={!createdProgram}\r\n                  className=\"mt-4 flex w-full justify-center rounded-md border border-transparent bg-gray-900 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-white dark:text-gray-900 dark:hover:bg-gray-200\"\r\n                >\r\n                  Continue to Milestones\r\n                </button>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    Select a Program to Join\r\n                  </label>\r\n                  {programsLoading ? (\r\n                    <div className=\"text-sm text-gray-500 dark:text-gray-400\">Loading programs...</div>\r\n                  ) : programs.length === 0 ? (\r\n                    <div className=\"rounded-md border border-amber-200 bg-amber-50 p-3 text-sm text-amber-700 dark:border-amber-800 dark:bg-amber-900/20 dark:text-amber-300\">\r\n                      No programs are available yet. Create a new program to get started.\r\n                    </div>\r\n                  ) : (\r\n                    <select\r\n                      value={selectedProgramId === \"\" ? \"\" : selectedProgramId}\r\n                      onChange={(e) => {\r\n                        const value = e.target.value;\r\n                        setSelectedProgramId(value ? Number(value) : \"\");\r\n                      }}\r\n                      className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                    >\r\n                      <option value=\"\">Choose a program</option>\r\n                      {programs.map((program) => (\r\n                        <option key={program.id} value={program.id}>\r\n                          {program.name}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  )}\r\n                </div>\r\n\r\n                {typeof selectedProgramId === \"number\" && (\r\n                  <div className=\"rounded-md border border-gray-200 bg-gray-50 p-4 text-sm text-gray-700 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200\">\r\n                    <p className=\"font-semibold\">\r\n                      {programs.find((program) => program.id === selectedProgramId)?.name}\r\n                    </p>\r\n                    <p className=\"mt-1 text-sm text-gray-600 dark:text-gray-400\">\r\n                      Joining this program will give your team access to its milestones, parts, and work items.\r\n                    </p>\r\n                  </div>\r\n                )}\r\n\r\n                {joinError && (\r\n                  <div className=\"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-300\">\r\n                    {joinError}\r\n                  </div>\r\n                )}\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleJoinProgram}\r\n                  disabled={typeof selectedProgramId !== \"number\" || programsLoading}\r\n                  className=\"flex w-full justify-center rounded-md bg-blue-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-600 disabled:cursor-not-allowed disabled:opacity-50\"\r\n                >\r\n                  Join Program\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst MilestoneSetupScreen = ({\r\n  onBack,\r\n  program,\r\n  onComplete,\r\n}: {\r\n  onBack: () => void;\r\n  program: Program | null;\r\n  onComplete: (milestone: Milestone) => void;\r\n}) => {\r\n  const [createMilestone, { isLoading, error }] = useCreateMilestoneMutation();\r\n  const [name, setName] = useState(\"\");\r\n  const [description, setDescription] = useState(\"\");\r\n  const [date, setDate] = useState(() => addDays(new Date(), 14).toISOString().split(\"T\")[0]);\r\n  const [createdMilestone, setCreatedMilestone] = useState<Milestone | null>(null);\r\n  const [formError, setFormError] = useState<string | null>(null);\r\n\r\n  if (!program) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"max-w-xl mx-auto text-center\">\r\n          <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4\">Program not found</h2>\r\n          <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\r\n            We couldn't find the program you just created. Please go back and create a program first.\r\n          </p>\r\n          <button\r\n            onClick={onBack}\r\n            className=\"rounded-md bg-blue-primary px-4 py-2 text-sm font-medium text-white hover:bg-blue-600\"\r\n          >\r\n            Back to Program Setup\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const handleCreateMilestone = async () => {\r\n    setFormError(null);\r\n    if (!name || !date) {\r\n      setFormError(\"Please provide a milestone name and date.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const payload = {\r\n        name,\r\n        description,\r\n        date: formatISO(new Date(date), { representation: \"complete\" }),\r\n        programId: program.id,\r\n      };\r\n\r\n      const newMilestone = await createMilestone(payload).unwrap();\r\n      setCreatedMilestone(newMilestone);\r\n      onComplete(newMilestone);\r\n    } catch (e) {\r\n      setFormError(\"Failed to create milestone. Please try again.\");\r\n      console.error(\"Failed to create milestone:\", e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-2xl mx-auto\">\r\n        <div className=\"text-center mb-8\">\r\n          <button\r\n            onClick={onBack}\r\n            className=\"flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-6 mx-auto\"\r\n          >\r\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n            Back\r\n          </button>\r\n\r\n          <h2 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-4\">\r\n            Add a Milestone to \"{program.name}\"\r\n          </h2>\r\n          <p className=\"text-lg text-gray-600 dark:text-gray-400\">\r\n            Milestones help track major events or deliverables in your program timeline.\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8\">\r\n          <div className=\"space-y-6\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Milestone Name\r\n              </label>\r\n              <input\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                value={name}\r\n                onChange={(e) => setName(e.target.value)}\r\n                placeholder=\"e.g. Prototype Complete\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Description (Optional)\r\n              </label>\r\n              <textarea\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                value={description}\r\n                onChange={(e) => setDescription(e.target.value)}\r\n                rows={3}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Milestone Date\r\n              </label>\r\n              <input\r\n                type=\"date\"\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                value={date}\r\n                onChange={(e) => setDate(e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            {formError && (\r\n              <div className=\"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-300\">\r\n                {formError}\r\n              </div>\r\n            )}\r\n\r\n            {error && (\r\n              <div className=\"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-300\">\r\n                Failed to create milestone. Please try again.\r\n              </div>\r\n            )}\r\n\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleCreateMilestone}\r\n              disabled={isLoading || !!createdMilestone}\r\n              className=\"flex w-full justify-center rounded-md bg-blue-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-600 disabled:cursor-not-allowed disabled:opacity-50\"\r\n            >\r\n              {isLoading ? \"Creating Milestone...\" : createdMilestone ? \"Milestone Created\" : \"Create Milestone\"}\r\n            </button>\r\n\r\n            {createdMilestone && (\r\n              <div className=\"rounded-md border border-green-200 bg-green-50 p-3 text-sm text-green-700 dark:border-green-800 dark:bg-green-900/20 dark:text-green-300\">\r\n                Milestone \"{createdMilestone.name}\" created successfully.\r\n              </div>\r\n            )}\r\n\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => createdMilestone && onComplete(createdMilestone)}\r\n              disabled={!createdMilestone}\r\n              className=\"mt-4 flex w-full justify-center rounded-md border border-transparent bg-gray-900 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-white dark:text-gray-900 dark:hover:bg-gray-200\"\r\n            >\r\n              Continue to Parts\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst PartSetupScreen = ({\r\n  onBack,\r\n  onComplete,\r\n  program,\r\n  currentUser,\r\n  milestoneCreated,\r\n}: {\r\n  onBack: () => void;\r\n  onComplete: () => void;\r\n  program: Program | null;\r\n  currentUser: AuthUser | null;\r\n  milestoneCreated: boolean;\r\n}) => {\r\n  const [createPart, { isLoading, error }] = useCreatePartMutation();\r\n  const [partCode, setPartCode] = useState(\"\");\r\n  const [partName, setPartName] = useState(\"\");\r\n  const [level, setLevel] = useState(\"0\");\r\n  const [revisionLevel, setRevisionLevel] = useState(\"-\");\r\n  const [state, setState] = useState<PartState>(PartState.InWork);\r\n  const [formError, setFormError] = useState<string | null>(null);\r\n  const [createdPart, setCreatedPart] = useState<boolean>(false);\r\n\r\n  if (!program) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"max-w-xl mx-auto text-center\">\r\n          <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4\">Program not found</h2>\r\n          <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\r\n            We couldn't find the program you just created. Please go back and create a program first.\r\n          </p>\r\n          <button\r\n            onClick={onBack}\r\n            className=\"rounded-md bg-blue-primary px-4 py-2 text-sm font-medium text-white hover:bg-blue-600\"\r\n          >\r\n            Back to Program Setup\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!milestoneCreated) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"max-w-xl mx-auto text-center\">\r\n          <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4\">Milestone required</h2>\r\n          <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\r\n            Please create at least one milestone for \"{program.name}\" before adding parts.\r\n          </p>\r\n          <button\r\n            onClick={onBack}\r\n            className=\"rounded-md bg-blue-primary px-4 py-2 text-sm font-medium text-white hover:bg-blue-600\"\r\n          >\r\n            Back to Milestone Setup\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const handleCreatePart = async () => {\r\n    setFormError(null);\r\n    if (!partCode || !partName) {\r\n      setFormError(\"Please provide a part code and name.\");\r\n      return;\r\n    }\r\n    if (!currentUser?.id) {\r\n      setFormError(\"An assigned user is required to create a part. Please sign in again.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await createPart({\r\n        code: partCode,\r\n        partName,\r\n        level: Number(level || \"0\"),\r\n        state,\r\n        revisionLevel: revisionLevel || \"-\",\r\n        assignedUserId: currentUser.id,\r\n        programId: program.id,\r\n      }).unwrap();\r\n\r\n      setCreatedPart(true);\r\n      onComplete();\r\n    } catch (e) {\r\n      setFormError(\"Failed to create part. Please try again.\");\r\n      console.error(\"Failed to create part:\", e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-2xl mx-auto\">\r\n        <div className=\"text-center mb-8\">\r\n          <button\r\n            onClick={onBack}\r\n            className=\"flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-6 mx-auto\"\r\n          >\r\n            <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n            Back\r\n          </button>\r\n\r\n          <h2 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-4\">\r\n            Create a Part for \"{program.name}\"\r\n          </h2>\r\n          <p className=\"text-lg text-gray-600 dark:text-gray-400\">\r\n            Every program starts with at least one part assigned to an engineer. Create the first part so your team can begin collaborating.\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8\">\r\n          <div className=\"space-y-6\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Part Code\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                value={partCode}\r\n                onChange={(e) => setPartCode(e.target.value)}\r\n                placeholder=\"e.g. 1001\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Part Name\r\n              </label>\r\n              <input\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                value={partName}\r\n                onChange={(e) => setPartName(e.target.value)}\r\n                placeholder=\"e.g. Main Control Board\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-3\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  Level\r\n                </label>\r\n                <input\r\n                  type=\"number\"\r\n                  className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                  value={level}\r\n                  onChange={(e) => setLevel(e.target.value)}\r\n                  min={1}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  Revision\r\n                </label>\r\n                <input\r\n                  className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                  value={revisionLevel}\r\n                  onChange={(e) => setRevisionLevel(e.target.value)}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  State\r\n                </label>\r\n                <select\r\n                  className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white\"\r\n                  value={state}\r\n                  onChange={(e) => setState(e.target.value as PartState)}\r\n                >\r\n                  {Object.values(PartState).map((stateValue) => (\r\n                    <option key={stateValue} value={stateValue}>\r\n                      {PartStateLabels[stateValue]}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            {formError && (\r\n              <div className=\"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-300\">\r\n                {formError}\r\n              </div>\r\n            )}\r\n\r\n            {error && (\r\n              <div className=\"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-300\">\r\n                Failed to create part. Please try again.\r\n              </div>\r\n            )}\r\n\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleCreatePart}\r\n              disabled={isLoading || createdPart}\r\n              className=\"flex w-full justify-center rounded-md bg-blue-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-600 disabled:cursor-not-allowed disabled:opacity-50\"\r\n            >\r\n              {isLoading ? \"Creating Part...\" : createdPart ? \"Part Created\" : \"Create Part\"}\r\n            </button>\r\n\r\n            {createdPart && (\r\n              <div className=\"rounded-md border border-green-200 bg-green-50 p-3 text-sm text-green-700 dark:border-green-800 dark:bg-green-900/20 dark:text-green-300\">\r\n                Part created successfully.\r\n              </div>\r\n            )}\r\n\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => createdPart && onComplete()}\r\n              disabled={!createdPart}\r\n              className=\"mt-4 flex w-full justify-center rounded-md border border-transparent bg-gray-900 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-white dark:text-gray-900 dark:hover:bg-gray-200\"\r\n            >\r\n              Finish Setup\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst SuccessScreen = ({ role, onComplete }: {\r\n  role: string;\r\n  onComplete: () => void;\r\n}) => {\r\n  // Use the centralized role display name function\r\n  // This handles both Prisma enum values (e.g., \"ProgramManager\") and display names (e.g., \"Program Manager\")\r\n  const roleTitle = getRoleDisplayName(role);\r\n  \r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-md w-full text-center\">\r\n        <div className=\"mb-10\">\r\n          <div className=\"w-24 h-24 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-8 shadow-lg\">\r\n            <svg className=\"w-12 h-12 text-green-600 dark:text-green-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n            </svg>\r\n          </div>\r\n          \r\n          <h2 className=\"text-4xl font-bold text-gray-900 dark:text-white mb-4\">\r\n            Welcome to Partial!\r\n          </h2>\r\n          <p className=\"text-xl text-gray-600 dark:text-gray-400 mb-6\">\r\n            Your account has been set up successfully as a <span className=\"font-semibold text-blue-600 dark:text-blue-400\">{roleTitle}</span>.\r\n          </p>\r\n          <p className=\"text-lg text-gray-500 dark:text-gray-400 mb-10\">\r\n            You're all set! Start tracking your work items and managing your hardware development projects.\r\n          </p>\r\n        </div>\r\n\r\n        <button\r\n          onClick={onComplete}\r\n          className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-4 px-8 rounded-lg text-lg transition-all duration-200 shadow-lg hover:shadow-xl\"\r\n        >\r\n          Go to Dashboard\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\ntype OnboardingStep =\r\n  | \"landing\"\r\n  | \"auth\"\r\n  | \"role-selection\"\r\n  | \"organization-name\"\r\n  | \"profile\"\r\n  | \"program-setup\"\r\n  | \"milestone-setup\"\r\n  | \"part-setup\"\r\n  | \"success\";\r\n\r\n// Main Onboarding Component\r\nconst OnboardingPage = () => {\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const { user: authUser, isLoading: authLoading } = useAuth();\r\n  const [step, setStep] = useState<OnboardingStep>(\"landing\");\r\n  const [requiresSetup, setRequiresSetup] = useState(false);\r\n  const [createdProgram, setCreatedProgram] = useState<Program | null>(null);\r\n  const [createdMilestone, setCreatedMilestone] = useState<Milestone | null>(null);\r\n  const [userRole, setUserRole] = useState<string>(\"\");\r\n  const [organizationName, setOrganizationName] = useState<string>(\"\");\r\n  const [showLearnMore, setShowLearnMore] = useState(false);\r\n  const [authMode, setAuthMode] = useState<\"signup\" | \"login\">(\"signup\");\r\n  const [checkingSession, setCheckingSession] = useState(true);\r\n  const [authError, setAuthError] = useState<string | null>(null);\r\n  const [invitationToken, setInvitationToken] = useState<string | null>(null);\r\n  const [invitationData, setInvitationData] = useState<{\r\n    organization: { id: number; name: string };\r\n    role: string;\r\n    invitedEmail?: string;\r\n  } | null>(null);\r\n\r\n  const goToStep = (next: OnboardingStep) => {\r\n    setStep(next);\r\n  };\r\n\r\n  // Check for error and invitation parameters in URL\r\n  useEffect(() => {\r\n    const errorParam = searchParams.get('error');\r\n    const invitationParam = searchParams.get('invitation');\r\n    \r\n    if (errorParam === 'authentication_failed') {\r\n      setAuthError('Authentication failed. Please try again.');\r\n      // Clear the error parameter from URL\r\n      router.replace('/onboarding', { scroll: false });\r\n    }\r\n    \r\n    if (invitationParam) {\r\n      setInvitationToken(invitationParam);\r\n    }\r\n  }, [searchParams, router]);\r\n\r\n  // Validate invitation token if present\r\n  const { data: invitationValidation, isLoading: isValidatingInvitation, error: invitationError } = useValidateInvitationQuery(\r\n    invitationToken || '',\r\n    { skip: !invitationToken }\r\n  );\r\n\r\n  // Store invitation data when validation succeeds\r\n  useEffect(() => {\r\n    if (invitationValidation?.invitation) {\r\n      setInvitationData({\r\n        organization: invitationValidation.invitation.organization,\r\n        role: invitationValidation.invitation.role,\r\n        invitedEmail: invitationValidation.invitation.invitedEmail,\r\n      });\r\n    }\r\n  }, [invitationValidation]);\r\n\r\n  // Check Better Auth session on mount - only on landing step\r\n  // This prevents redirecting users who are actively going through onboarding\r\n  // Note: 401 responses are expected and normal for unauthenticated users\r\n  useEffect(() => {\r\n    // Only check session if we're on the landing step\r\n    // If user is already past landing (role-selection, organization-name, etc.),\r\n    // they're actively onboarding and shouldn't be redirected\r\n    if (step !== \"landing\") {\r\n      return;\r\n    }\r\n\r\n    // Prevent duplicate calls in React strict mode\r\n    let isMounted = true;\r\n\r\n    const checkAuthSession = async () => {\r\n      setCheckingSession(true);\r\n      const apiBaseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:8000';\r\n      \r\n      try {\r\n        // Add timeout to prevent hanging requests\r\n        const controller = new AbortController();\r\n        const timeoutId = setTimeout(() => controller.abort(), 5000); // 5 second timeout\r\n\r\n        const response = await fetch(`${apiBaseUrl}/auth/me`, {\r\n          method: 'GET',\r\n          credentials: 'include', // Include session cookie\r\n          signal: controller.signal,\r\n        }).catch((error) => {\r\n          // Silently handle network errors - expected during onboarding\r\n          if (error.name === 'AbortError') {\r\n            return null; // Request was aborted\r\n          }\r\n          throw error;\r\n        });\r\n\r\n        clearTimeout(timeoutId);\r\n\r\n        // If component unmounted or request was aborted, don't proceed\r\n        if (!isMounted || !response) {\r\n          return;\r\n        }\r\n\r\n        // Double-check step hasn't changed (user might have started onboarding)\r\n        if (step !== \"landing\") {\r\n          return;\r\n        }\r\n\r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          \r\n          // Better Auth /auth/me returns user object directly if authenticated\r\n          // Only redirect to home if user exists AND has completed onboarding\r\n          // IMPORTANT: Never redirect if we're not on the landing step (user is actively onboarding)\r\n          if (data && data.id && data.organizationId) {\r\n            const organizationName = data.organization?.name || '';\r\n            const userCreatedAt = data.createdAt ? new Date(data.createdAt) : null;\r\n            const now = new Date();\r\n            \r\n            // Check if user was just created (within last 5 minutes) - if so, they're likely still onboarding\r\n            const isRecentlyCreated = userCreatedAt && (now.getTime() - userCreatedAt.getTime()) < 5 * 60 * 1000;\r\n            \r\n            // Additional check: if organization data is missing, assume still in onboarding\r\n            // Also check if organization is the default one\r\n            // \"Default Organization\" is assigned during signup, so having it means onboarding isn't complete\r\n            const isDefaultOrganization = !organizationName || organizationName === \"Default Organization\";\r\n            \r\n            // Only redirect if:\r\n            // 1. They have a real organization (not \"Default Organization\")\r\n            // 2. User was NOT just created (not actively signing up)\r\n            // 3. We're still on the landing step (not actively onboarding)\r\n            // 4. Component is still mounted\r\n            if (!isDefaultOrganization && !isRecentlyCreated && step === \"landing\" && isMounted) {\r\n              // User is authenticated, exists in database, has a real organization, and wasn't just created\r\n              // This means they've completed onboarding - redirect to home\r\n              router.push('/home');\r\n              return;\r\n            }\r\n            // If organization is \"Default Organization\", missing, or user was just created, they're still in onboarding\r\n            // Continue with onboarding flow\r\n          }\r\n          // If user exists but doesn't have organizationId, they're still in onboarding\r\n          // Continue with onboarding flow\r\n        } else if (response.status === 401) {\r\n          // Not authenticated - this is expected during onboarding, continue normally\r\n          // 401 is normal for unauthenticated users on the onboarding page\r\n          // The browser console will show this as an error, but it's expected behavior\r\n        }\r\n        \r\n        // No session or not authenticated - if invitation exists, user needs to login first\r\n        if (invitationToken) {\r\n          // Show landing page but indicate invitation is pending\r\n          setStep(\"landing\");\r\n        } else {\r\n          setStep(\"landing\");\r\n        }\r\n      } catch (error) {\r\n        // Only log if it's not a network error (backend might not be running)\r\n        if (error instanceof Error) {\r\n          if (error.name === 'AbortError') {\r\n            // Request timed out - backend might be slow or unavailable\r\n            console.debug('Auth check request timed out - backend may be unavailable');\r\n          } else if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {\r\n            // Network error - backend is likely not running\r\n            console.debug('Backend server appears to be unavailable');\r\n          } else {\r\n            // Other error - log it\r\n            console.error('Failed to check auth session:', error);\r\n          }\r\n        } else {\r\n          console.error('Failed to check auth session:', error);\r\n        }\r\n        // On error, show landing page\r\n        setStep(\"landing\");\r\n      } finally {\r\n        if (isMounted) {\r\n          setCheckingSession(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    // Only check session if not validating invitation\r\n    if (!isValidatingInvitation) {\r\n      checkAuthSession();\r\n    }\r\n\r\n    return () => {\r\n      isMounted = false;\r\n    };\r\n  }, [router, invitationToken, isValidatingInvitation, invitationError, invitationValidation, step]);\r\n\r\n  // If user is authenticated (from local storage), skip to role selection\r\n  useEffect(() => {\r\n    if (!checkingSession && authUser && step === \"landing\") {\r\n      setStep(\"role-selection\");\r\n    }\r\n  }, [authUser, step, checkingSession]);\r\n\r\n  const redirectToAuth = (mode: \"signup\" | \"login\" = \"signup\") => {\r\n    // Clear any auth error when user tries to login again\r\n    setAuthError(null);\r\n    // Set the auth mode before going to auth step\r\n    setAuthMode(mode);\r\n    // Go to auth step instead of redirecting to login page\r\n    goToStep(\"auth\");\r\n  };\r\n\r\n  const handleGetStarted = () => redirectToAuth(\"signup\");\r\n  const handleLogin = () => redirectToAuth(\"login\");\r\n\r\n  const handleLearnMore = () => {\r\n    setShowLearnMore(true);\r\n  };\r\n\r\n  const handleAuthNext = () => {\r\n    goToStep(\"role-selection\");\r\n  };\r\n\r\n  const handleRoleNext = async (role: string) => {\r\n    setUserRole(role);\r\n    \r\n    // For invitations, create user immediately and go to profile\r\n    // For new organization creation, go to organization name step first\r\n    if (invitationToken) {\r\n      // Create user immediately for invitations\r\n      await createUserInDatabase(role);\r\n      goToStep(\"profile\");\r\n    } else {\r\n      // For new organization, go to organization name step\r\n      goToStep(\"organization-name\");\r\n    }\r\n  };\r\n\r\n  const handleOrganizationNameNext = async (orgName: string) => {\r\n    setOrganizationName(orgName);\r\n    try {\r\n      // Create user with organization name\r\n      await createUserInDatabase(userRole, orgName);\r\n      goToStep(\"profile\");\r\n    } catch (error) {\r\n      console.error('Error creating user with organization:', error);\r\n      // Error is already shown via alert in createUserInDatabase\r\n      // Don't proceed to profile if user creation failed\r\n    }\r\n  };\r\n\r\n  const createUserInDatabase = async (role: string, orgName?: string) => {\r\n    const apiBaseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:8000';\r\n    try {\r\n      // Add timeout to prevent hanging requests\r\n      const controller = new AbortController();\r\n      const timeoutId = setTimeout(() => controller.abort(), 5000); // 5 second timeout\r\n\r\n      // Check if user is authenticated via Better Auth\r\n      // Note: Better Auth uses cookies for session, so we check /auth/me\r\n      // If it returns 401, the user needs to sign in first (shouldn't happen during onboarding)\r\n      let userEmail = '';\r\n      let userName = '';\r\n      let userPhoneNumber = '';\r\n      \r\n      try {\r\n        const sessionCheck = await fetch(`${apiBaseUrl}/auth/me`, {\r\n          method: 'GET',\r\n          credentials: 'include',\r\n          signal: controller.signal,\r\n        });\r\n\r\n        clearTimeout(timeoutId);\r\n\r\n        if (sessionCheck.ok) {\r\n          const sessionData = await sessionCheck.json();\r\n          \r\n          // Better Auth /auth/me returns user object directly if authenticated\r\n          if (sessionData && sessionData.id) {\r\n            userEmail = sessionData.email || '';\r\n            userName = sessionData.name || sessionData.username || '';\r\n            userPhoneNumber = sessionData.phoneNumber || '';\r\n          }\r\n        } else if (sessionCheck.status === 401) {\r\n          // Not authenticated - this may be expected during onboarding before signup\r\n          // Silently continue - the onboarding endpoint will handle user creation\r\n        }\r\n      } catch (error) {\r\n        // Silently handle errors - user might not be authenticated yet\r\n        // This is expected during onboarding before signup\r\n        if (error instanceof Error && error.name !== 'AbortError') {\r\n          // Only log non-abort errors in development\r\n          if (process.env.NODE_ENV === 'development') {\r\n            console.debug('Session check during onboarding:', error.message);\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Proceed with creating/updating user in database\r\n      // Extract username from email (before @) if not provided\r\n      const username = userEmail?.split('@')[0] || 'user';\r\n      \r\n      // Call signup endpoint to update/create user in database\r\n      // Include invitationToken if present\r\n      // For new organization creation, backend will automatically assign Admin role\r\n      // For invitations, use the role from the invitation\r\n      let roleToSend = role;\r\n      if (!invitationData) {\r\n        // For new organization creation, backend will override role to Admin\r\n        // But we still need to pass a valid role format\r\n        if (role === \"engineer\") {\r\n          roleToSend = \"Engineer\";\r\n        } else if (role === \"program-manager\") {\r\n          roleToSend = \"Program Manager\";\r\n        } else if (role === \"Admin\") {\r\n          roleToSend = \"Admin\"; // Already correct - backend will accept and override\r\n        }\r\n        // If role is already in display format, keep it as is\r\n      } else {\r\n        // Use role from invitation (already in display format)\r\n        roleToSend = invitationData.role;\r\n      }\r\n      \r\n      // Use phone number from session data (set during Better Auth signup)\r\n      // If not available in session, use empty string (backend will handle validation)\r\n      const phoneNumber = userPhoneNumber || '';\r\n      \r\n      const signupBody: any = {\r\n        username: username,\r\n        name: userName,\r\n        email: userEmail,\r\n        phoneNumber: phoneNumber,\r\n        role: roleToSend, // Backend will override to Admin for new orgs (no invitation token)\r\n      };\r\n      \r\n      // Include organization name for new organization creation\r\n      if (orgName && !invitationToken) {\r\n        signupBody.organizationName = orgName;\r\n      }\r\n      \r\n      if (invitationToken) {\r\n        signupBody.invitationToken = invitationToken;\r\n      }\r\n      \r\n      const signupResponse = await fetch(`${apiBaseUrl}/onboarding/signup`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include', // Include session cookie\r\n        body: JSON.stringify(signupBody),\r\n      });\r\n\r\n      if (signupResponse.ok) {\r\n        const result = await signupResponse.json();\r\n        console.log('User created/updated in database:', result);\r\n        \r\n        // User is now created - the profile screen will refresh user on mount\r\n        // Small delay to ensure database is ready\r\n        await new Promise(resolve => setTimeout(resolve, 500));\r\n      } else {\r\n        let errorData;\r\n        try {\r\n          errorData = await signupResponse.json();\r\n        } catch (e) {\r\n          errorData = { message: `HTTP ${signupResponse.status}: ${signupResponse.statusText}` };\r\n        }\r\n        console.error('Failed to create user:', errorData);\r\n        console.error('Response status:', signupResponse.status);\r\n        console.error('Response headers:', Object.fromEntries(signupResponse.headers.entries()));\r\n        \r\n        // Show error to user\r\n        showApiError({ data: { message: errorData.message }, message: errorData.message }, `Failed to create user: ${signupResponse.status}`);\r\n        // Don't continue - show error instead\r\n        throw new Error(errorData.message || 'Failed to create user');\r\n      }\r\n    } catch (error) {\r\n      // Improve error logging with specific handling\r\n      if (error instanceof Error) {\r\n        if (error.name === 'AbortError') {\r\n          // Request timed out - backend might be slow or unavailable\r\n          console.error('Request timed out - backend may be unavailable');\r\n          throw new Error('Backend server is not responding. Please check if the server is running.');\r\n        } else if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {\r\n          // Network error - backend is likely not running\r\n          console.error('Backend server appears to be unavailable');\r\n          throw new Error('Cannot connect to backend server. Please check if the server is running.');\r\n        } else {\r\n          // Other error - log and re-throw\r\n          console.error('Error creating user:', error);\r\n        }\r\n      } else {\r\n        console.error('Error creating user:', error);\r\n      }\r\n      throw error; // Re-throw so caller can handle it\r\n    }\r\n  };\r\n\r\n  const handleProfileNext = ({ requiresSetup }: { requiresSetup: boolean; teamId: number | null }) => {\r\n    setRequiresSetup(requiresSetup);\r\n    setCreatedMilestone(null);\r\n\r\n    if (requiresSetup) {\r\n      setCreatedProgram(null);\r\n      goToStep(\"program-setup\");\r\n    } else {\r\n      goToStep(\"success\");\r\n    }\r\n  };\r\n\r\n  const handleProgramComplete = (program: Program) => {\r\n    setCreatedProgram(program);\r\n    goToStep(\"milestone-setup\");\r\n  };\r\n\r\n  const handleProgramJoin = (program: Program) => {\r\n    setCreatedProgram(program);\r\n    setRequiresSetup(false);\r\n    goToStep(\"success\");\r\n  };\r\n\r\n  const handleMilestoneComplete = (milestone: Milestone) => {\r\n    setCreatedMilestone(milestone);\r\n    goToStep(\"part-setup\");\r\n  };\r\n\r\n  const handlePartComplete = () => {\r\n    goToStep(\"success\");\r\n  };\r\n\r\n  const handleComplete = async () => {\r\n    try {\r\n      router.push(\"/home\");\r\n    } catch (error) {\r\n      console.error(\"Failed to complete onboarding:\", error);\r\n      router.push(\"/home\");\r\n    }\r\n  };\r\n\r\n  const handleBack = () => {\r\n    let previous: OnboardingStep | null = null;\r\n    switch (step) {\r\n      case \"landing\":\r\n        previous = null;\r\n        break;\r\n      case \"auth\":\r\n        previous = \"landing\";\r\n        break;\r\n      case \"role-selection\":\r\n        // If user came from external auth (no auth step), go back to landing\r\n        // Otherwise go back to auth\r\n        previous = \"landing\"; // Skip auth step for externally authenticated users\r\n        break;\r\n      case \"organization-name\":\r\n        previous = \"role-selection\";\r\n        break;\r\n      case \"profile\":\r\n        // If invitation exists, go back to role-selection (skip organization-name)\r\n        // Otherwise go back to organization-name\r\n        previous = invitationToken ? \"role-selection\" : \"organization-name\";\r\n        break;\r\n      case \"program-setup\":\r\n        previous = \"profile\";\r\n        break;\r\n      case \"milestone-setup\":\r\n        previous = \"program-setup\";\r\n        break;\r\n      case \"part-setup\":\r\n        previous = \"milestone-setup\";\r\n        break;\r\n      case \"success\":\r\n        previous = requiresSetup ? \"part-setup\" : \"profile\";\r\n        break;\r\n    }\r\n\r\n    if (previous) {\r\n      goToStep(previous);\r\n    }\r\n  };\r\n\r\n      // Show loading while checking auth session or validating invitation\r\n      if (checkingSession || isValidatingInvitation) {\r\n        return (\r\n          <div className=\"min-h-screen flex items-center justify-center\">\r\n            <div className=\"text-center\">\r\n              <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n              <p className=\"text-gray-600 dark:text-gray-400\">\r\n                {isValidatingInvitation ? 'Validating invitation...' : 'Checking authentication...'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        );\r\n      }\r\n      \r\n      // Show error if invitation validation failed\r\n      if (invitationToken && invitationError) {\r\n        return (\r\n          <div className=\"min-h-screen flex items-center justify-center\">\r\n            <div className=\"max-w-md mx-auto text-center p-8\">\r\n              <div className=\"mb-4\">\r\n                <svg className=\"mx-auto h-12 w-12 text-red-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                </svg>\r\n              </div>\r\n              <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">Invalid Invitation</h2>\r\n              <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\r\n                This invitation link is invalid, expired, or has already been used. Please contact the organization administrator for a new invitation.\r\n              </p>\r\n              <button\r\n                onClick={() => {\r\n                  setInvitationToken(null);\r\n                  router.replace('/onboarding');\r\n                }}\r\n                className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n              >\r\n                Go to Home\r\n              </button>\r\n            </div>\r\n          </div>\r\n        );\r\n      }\r\n\r\n  const renderCurrentStep = () => {\r\n    switch (step) {\r\n      case \"landing\":\r\n        return (\r\n          <>\r\n            {authError && (\r\n              <div className=\"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 max-w-md w-full mx-4\">\r\n                <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 shadow-lg\">\r\n                  <div className=\"flex items-start\">\r\n                    <div className=\"flex-shrink-0\">\r\n                      <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                        <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\r\n                      </svg>\r\n                    </div>\r\n                    <div className=\"ml-3 flex-1\">\r\n                      <p className=\"text-sm font-medium text-red-800 dark:text-red-200\">{authError}</p>\r\n                    </div>\r\n                    <div className=\"ml-4 flex-shrink-0\">\r\n                      <button\r\n                        onClick={() => setAuthError(null)}\r\n                        className=\"inline-flex text-red-400 hover:text-red-600 dark:hover:text-red-300\"\r\n                      >\r\n                        <svg className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                          <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\r\n                        </svg>\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            <LandingScreen\r\n              onGetStarted={handleGetStarted}\r\n              onLogin={handleLogin}\r\n              onLearnMore={handleLearnMore}\r\n            />\r\n          </>\r\n        );\r\n      case \"auth\":\r\n        return (\r\n          <AuthScreen\r\n            onBack={handleBack}\r\n            onNext={handleAuthNext}\r\n            initialMode={authMode}\r\n          />\r\n        );\r\n          case \"role-selection\":\r\n            return (\r\n              <RoleSelectionScreen\r\n                onBack={handleBack}\r\n                onNext={handleRoleNext}\r\n                invitationData={invitationData}\r\n                isNewOrganization={!invitationToken}\r\n              />\r\n            );\r\n          case \"organization-name\":\r\n            return (\r\n              <OrganizationNameScreen\r\n                onBack={handleBack}\r\n                onNext={handleOrganizationNameNext}\r\n                invitationData={invitationData}\r\n              />\r\n            );\r\n      case \"profile\":\r\n        return (\r\n          <ProfileCompletionScreen\r\n            onBack={handleBack}\r\n            onNext={handleProfileNext}\r\n          />\r\n        );\r\n      case \"program-setup\":\r\n        return (\r\n          <ProgramSetupScreen\r\n            onBack={handleBack}\r\n            currentUser={authUser || null}\r\n            onComplete={handleProgramComplete}\r\n            onJoinExisting={handleProgramJoin}\r\n          />\r\n        );\r\n      case \"milestone-setup\":\r\n        return (\r\n          <MilestoneSetupScreen\r\n            onBack={handleBack}\r\n            program={createdProgram}\r\n            onComplete={handleMilestoneComplete}\r\n          />\r\n        );\r\n      case \"part-setup\":\r\n        return (\r\n          <PartSetupScreen\r\n            onBack={handleBack}\r\n            program={createdProgram}\r\n            currentUser={authUser || null}\r\n            milestoneCreated={!!createdMilestone}\r\n            onComplete={handlePartComplete}\r\n          />\r\n        );\r\n      case \"success\":\r\n        // Use actual user role from auth context if available, otherwise fall back to userRole state\r\n        const displayRole = authUser?.role || userRole || \"Admin\";\r\n        return (\r\n          <SuccessScreen\r\n            role={displayRole}\r\n            onComplete={handleComplete}\r\n          />\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen\">\r\n      {renderCurrentStep()}\r\n      \r\n      {/* Learn More Modal */}\r\n      {showLearnMore && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"p-6\">\r\n              <div className=\"flex justify-between items-center mb-6\">\r\n                <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                  About Partial\r\n                </h2>\r\n                <button\r\n                  onClick={() => setShowLearnMore(false)}\r\n                  className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\r\n                >\r\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n              \r\n              <div className=\"space-y-6\">\r\n                <div>\r\n                  <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-3\">\r\n                    What is Partial?\r\n                  </h3>\r\n                  <p className=\"text-gray-600 dark:text-gray-400\">\r\n                    Partial is a comprehensive work management platform designed specifically for hardware development teams. \r\n                    It helps engineers track their work items, manage parts, and enables program managers to monitor \r\n                    program health and team performance.\r\n                  </p>\r\n                </div>\r\n\r\n                <div>\r\n                  <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-3\">\r\n                    Key Features\r\n                  </h3>\r\n                  <div className=\"grid md:grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <h4 className=\"font-medium text-gray-900 dark:text-white\">For Engineers:</h4>\r\n                      <ul className=\"text-sm text-gray-600 dark:text-gray-400 space-y-1\">\r\n                        <li>‚Ä¢ Track work items for parts they own</li>\r\n                        <li>‚Ä¢ Manage tasks, deliverables, and issues</li>\r\n                        <li>‚Ä¢ Collaborate with team members</li>\r\n                        <li>‚Ä¢ Update progress and status against program milestones</li>\r\n                      </ul>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <h4 className=\"font-medium text-gray-900 dark:text-white\">For Program Managers:</h4>\r\n                      <ul className=\"text-sm text-gray-600 dark:text-gray-400 space-y-1\">\r\n                        <li>‚Ä¢ Monitor program status</li>\r\n                        <li>‚Ä¢ Track team performance and workload</li>\r\n                        <li>‚Ä¢ Identify bottlenecks and blockers</li>\r\n                        <li>‚Ä¢ Manage milestones and trace their dependencies</li>\r\n                      </ul>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-3\">\r\n                    Hardware-Specific Features\r\n                  </h3>\r\n                  <ul className=\"text-gray-600 dark:text-gray-400 space-y-2\">\r\n                    <li>‚Ä¢ Hierarchical part management to reflect the actual hardware assembly (component ‚Üí subsystem ‚Üí system)</li>\r\n                    <li>‚Ä¢ Work items (tasks, deliverables, issues) link to specific parts, enabling part-centric views rather than people-centric stories/epics</li>\r\n                    <li>‚Ä¢ Hardware-specific deliverable types (drawing, BOM, CoC, ATP, etc.)</li>\r\n                    <li>‚Ä¢ Hardware-specific issue types (defect, failure, requirement waiver, etc.)</li>\r\n                    <li>‚Ä¢ Cradle to grave ownership of parts and work items through required user assignments</li>\r\n                    <li>‚Ä¢ Program analytics, team workload visualizations, and dynamic burndown charts</li>\r\n                    <li>‚Ä¢ Engineering discipline-based team organization (mechanical, electrical, structural, etc.) rather than feature/product-based</li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"mt-8 flex justify-end\">\r\n                <button\r\n                  onClick={() => setShowLearnMore(false)}\r\n                  className=\"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition-colors duration-200\"\r\n                >\r\n                  Got it!\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OnboardingPage;\r\n"],"names":[],"mappings":"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","debugId":null}}]
}